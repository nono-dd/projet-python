
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="FAQ de programmation" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/faq/programming.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="Sommaire: FAQ de programmation- Questions générales- Existe-t-il un débogueur de code source avec points d'arrêts, exécution pas-à-pas, etc. ?, Existe-t-il des outils pour aider à trouver des bogue..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="Sommaire: FAQ de programmation- Questions générales- Existe-t-il un débogueur de code source avec points d'arrêts, exécution pas-à-pas, etc. ?, Existe-t-il des outils pour aider à trouver des bogue..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>FAQ de programmation &#8212; Documentation Python 3.12.0</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?digest=b37c26da2f7529d09fe70b41c4b2133fe4931a90" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Documentation Python 3.12.0"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="FAQ sur l&#39;histoire et la conception" href="design.html" />
    <link rel="prev" title="FAQ générale sur Python" href="general.html" />
    <link rel="canonical" href="https://docs.python.org/3/faq/programming.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#">FAQ de programmation</a><ul>
<li><a class="reference internal" href="#general-questions">Questions générales</a></li>
<li><a class="reference internal" href="#core-language">Fondamentaux</a></li>
<li><a class="reference internal" href="#numbers-and-strings">Nombres et chaînes de caractères</a></li>
<li><a class="reference internal" href="#performance">Performances</a></li>
<li><a class="reference internal" href="#sequences-tuples-lists">Séquences (<em>n</em>-uplets / listes)</a></li>
<li><a class="reference internal" href="#objects">Objets</a></li>
<li><a class="reference internal" href="#modules">Modules</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="general.html"
                          title="Chapitre précédent">FAQ générale sur Python</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="design.html"
                          title="Chapitre suivant">FAQ sur l'histoire et la conception</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/faq/programming.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="design.html" title="FAQ sur l&#39;histoire et la conception"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="general.html" title="FAQ générale sur Python"
             accesskey="P">précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Questions fréquemment posées sur Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FAQ de programmation</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="programming-faq">
<h1><a class="toc-backref" href="#id2">FAQ de programmation</a><a class="headerlink" href="#programming-faq" title="Lien permanent vers ce titre">¶</a></h1>
<div class="contents topic" id="sommaire">
<p class="topic-title">Sommaire</p>
<ul class="simple">
<li><p><a class="reference internal" href="#programming-faq" id="id2">FAQ de programmation</a></p>
<ul>
<li><p><a class="reference internal" href="#general-questions" id="id3">Questions générales</a></p>
<ul>
<li><p><a class="reference internal" href="#is-there-a-source-code-level-debugger-with-breakpoints-single-stepping-etc" id="id4">Existe-t-il un débogueur de code source avec points d'arrêts, exécution pas-à-pas, etc. ?</a></p></li>
<li><p><a class="reference internal" href="#are-there-tools-to-help-find-bugs-or-perform-static-analysis" id="id5">Existe-t-il des outils pour aider à trouver des bogues ou faire de l'analyse statique de code ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-create-a-stand-alone-binary-from-a-python-script" id="id6">Comment créer un binaire autonome à partir d'un script Python ?</a></p></li>
<li><p><a class="reference internal" href="#are-there-coding-standards-or-a-style-guide-for-python-programs" id="id7">Existe-t-il des normes de développement ou un guide de style pour écrire des programmes Python ?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#core-language" id="id8">Fondamentaux</a></p>
<ul>
<li><p><a class="reference internal" href="#why-am-i-getting-an-unboundlocalerror-when-the-variable-has-a-value" id="id9">Pourquoi une UnboundLocalError est levée alors qu'une variable a une valeur ?</a></p></li>
<li><p><a class="reference internal" href="#what-are-the-rules-for-local-and-global-variables-in-python" id="id10">Quelles sont les règles pour les variables locales et globales en Python ?</a></p></li>
<li><p><a class="reference internal" href="#why-do-lambdas-defined-in-a-loop-with-different-values-all-return-the-same-result" id="id11">Pourquoi des expressions lambda définies dans une boucle avec des valeurs différentes retournent-elles le même résultat ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-share-global-variables-across-modules" id="id12">Comment partager des variables globales entre modules ?</a></p></li>
<li><p><a class="reference internal" href="#what-are-the-best-practices-for-using-import-in-a-module" id="id13">Quelles sont les « bonnes pratiques » pour utiliser import dans un module ?</a></p></li>
<li><p><a class="reference internal" href="#why-are-default-values-shared-between-objects" id="id14">Pourquoi les arguments par défaut sont-ils partagés entre les objets ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-pass-optional-or-keyword-parameters-from-one-function-to-another" id="id15">Comment passer des paramètres optionnels ou nommés d'une fonction à l'autre ?</a></p></li>
<li><p><a class="reference internal" href="#what-is-the-difference-between-arguments-and-parameters" id="id16">Quelle est la différence entre les arguments et les paramètres ?</a></p></li>
<li><p><a class="reference internal" href="#why-did-changing-list-y-also-change-list-x" id="id17">Pourquoi modifier la liste 'y' modifie aussi la liste 'x' ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-write-a-function-with-output-parameters-call-by-reference" id="id18">Comment écrire une fonction qui modifie ses paramètres ? (passage par référence)</a></p></li>
<li><p><a class="reference internal" href="#how-do-you-make-a-higher-order-function-in-python" id="id19">Comment construire une fonction d'ordre supérieur en Python ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-copy-an-object-in-python" id="id20">Comment copier un objet en Python ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-find-the-methods-or-attributes-of-an-object" id="id21">Comment récupérer les méthodes ou les attributs d'un objet ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-my-code-discover-the-name-of-an-object" id="id22">Comment un code peut-il obtenir le nom d'un objet ?</a></p></li>
<li><p><a class="reference internal" href="#what-s-up-with-the-comma-operator-s-precedence" id="id23">Qu'en est-il de la précédence de l'opérateur virgule ?</a></p></li>
<li><p><a class="reference internal" href="#is-there-an-equivalent-of-c-s-ternary-operator" id="id24">Existe-t-il un équivalent à l'opérateur ternaire « ?: » du C ?</a></p></li>
<li><p><a class="reference internal" href="#is-it-possible-to-write-obfuscated-one-liners-in-python" id="id25">Est-il possible d'écrire des programmes obscurcis (<em>obfuscated</em>) d'une ligne en Python ?</a></p></li>
<li><p><a class="reference internal" href="#what-does-the-slash-in-the-parameter-list-of-a-function-mean" id="id26">Que signifie la barre oblique (/) dans la liste des paramètres d'une fonction ?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#numbers-and-strings" id="id27">Nombres et chaînes de caractères</a></p>
<ul>
<li><p><a class="reference internal" href="#how-do-i-specify-hexadecimal-and-octal-integers" id="id28">Comment écrire des entiers hexadécimaux ou octaux ?</a></p></li>
<li><p><a class="reference internal" href="#why-does-22-10-return-3" id="id29">Pourquoi <code class="docutils literal notranslate"><span class="pre">-22</span> <span class="pre">//</span> <span class="pre">10</span></code> donne-t-il <code class="docutils literal notranslate"><span class="pre">-3</span></code> ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-get-int-literal-attribute-instead-of-syntaxerror" id="id30">Pourquoi ai-je une erreur de syntaxe en essayant de lire un attribut d'un entier littéral ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-convert-a-string-to-a-number" id="id31">Comment convertir une chaîne de caractères en nombre ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-convert-a-number-to-a-string" id="id32">Comment convertir un nombre en chaîne de caractères ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-modify-a-string-in-place" id="id33">Comment modifier une chaîne de caractères « sur place » ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-use-strings-to-call-functions-methods" id="id34">Comment utiliser des chaînes de caractères pour appeler des fonctions/méthodes ?</a></p></li>
<li><p><a class="reference internal" href="#is-there-an-equivalent-to-perl-s-chomp-for-removing-trailing-newlines-from-strings" id="id35">Existe-t-il un équivalent à la fonction <code class="docutils literal notranslate"><span class="pre">chomp()</span></code> de Perl, pour retirer les caractères de fin de ligne d'une chaîne de caractères ?</a></p></li>
<li><p><a class="reference internal" href="#is-there-a-scanf-or-sscanf-equivalent" id="id36">Existe-t-il un équivalent à <code class="docutils literal notranslate"><span class="pre">scanf()</span></code> ou <code class="docutils literal notranslate"><span class="pre">sscanf()</span></code> ?</a></p></li>
<li><p><a class="reference internal" href="#what-does-unicodedecodeerror-or-unicodeencodeerror-error-mean" id="id37">Que signifient les erreurs <code class="docutils literal notranslate"><span class="pre">UnicodeDecodeError</span></code> ou <code class="docutils literal notranslate"><span class="pre">UnicodeEncodeError</span></code> ?</a></p></li>
<li><p><a class="reference internal" href="#can-i-end-a-raw-string-with-an-odd-number-of-backslashes" id="id38">Can I end a raw string with an odd number of backslashes?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#performance" id="id39">Performances</a></p>
<ul>
<li><p><a class="reference internal" href="#my-program-is-too-slow-how-do-i-speed-it-up" id="id40">Mon programme est trop lent. Comment l'accélérer ?</a></p></li>
<li><p><a class="reference internal" href="#what-is-the-most-efficient-way-to-concatenate-many-strings-together" id="id41">Quelle est la manière la plus efficace de concaténer un grand nombre de chaînes de caractères ?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sequences-tuples-lists" id="id42">Séquences (<em>n</em>-uplets / listes)</a></p>
<ul>
<li><p><a class="reference internal" href="#how-do-i-convert-between-tuples-and-lists" id="id43">Comment convertir les listes en <em>n</em>-uplets et inversement ?</a></p></li>
<li><p><a class="reference internal" href="#what-s-a-negative-index" id="id44">Qu'est-ce qu'un indice négatif ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-iterate-over-a-sequence-in-reverse-order" id="id45">Comment itérer à rebours sur une séquence ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-you-remove-duplicates-from-a-list" id="id46">Comment retirer les doublons d'une liste ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-you-remove-multiple-items-from-a-list" id="id47">Comment retirer les doublons d'une liste</a></p></li>
<li><p><a class="reference internal" href="#how-do-you-make-an-array-in-python" id="id48">Comment construire un tableau en Python ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-create-a-multidimensional-list" id="id49">Comment créer une liste à plusieurs dimensions ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-apply-a-method-or-function-to-a-sequence-of-objects" id="id50">Comment appliquer une méthode ou une fonction à une séquence d'objets ?</a></p></li>
<li><p><a class="reference internal" href="#why-does-a-tuple-i-item-raise-an-exception-when-the-addition-works" id="id51">Pourquoi <code class="docutils literal notranslate"><span class="pre">a_tuple[i]</span> <span class="pre">+=</span> <span class="pre">['item']</span></code> lève-t-il une exception alors que l'addition fonctionne ?</a></p></li>
<li><p><a class="reference internal" href="#i-want-to-do-a-complicated-sort-can-you-do-a-schwartzian-transform-in-python" id="id52">Je souhaite faire un classement compliqué : peut-on faire une transformation de Schwartz en Python ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-sort-one-list-by-values-from-another-list" id="id53">Comment ordonner une liste en fonction des valeurs d'une autre liste ?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#objects" id="id54">Objets</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-a-class" id="id55">Qu'est-ce qu'une classe ?</a></p></li>
<li><p><a class="reference internal" href="#what-is-a-method" id="id56">Qu'est-ce qu'une méthode ?</a></p></li>
<li><p><a class="reference internal" href="#what-is-self" id="id57">Qu'est-ce que self ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-check-if-an-object-is-an-instance-of-a-given-class-or-of-a-subclass-of-it" id="id58">Comment vérifier si un objet est une instance d'une classe donnée ou d'une sous-classe de celle-ci ?</a></p></li>
<li><p><a class="reference internal" href="#what-is-delegation" id="id59">Qu'est-ce que la délégation ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-call-a-method-defined-in-a-base-class-from-a-derived-class-that-extends-it" id="id60">Comment appeler une méthode définie dans une classe mère depuis une classe dérivée qui la surcharge ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-organize-my-code-to-make-it-easier-to-change-the-base-class" id="id61">Comment organiser un code pour permettre de changer la classe mère plus facilement ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-create-static-class-data-and-static-class-methods" id="id62">Comment créer des données statiques de classe et des méthodes statiques de classe ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-overload-constructors-or-methods-in-python" id="id63">Comment surcharger les constructeurs (ou méthodes) en Python ?</a></p></li>
<li><p><a class="reference internal" href="#i-try-to-use-spam-and-i-get-an-error-about-someclassname-spam" id="id64">J'essaie d'utiliser <code class="docutils literal notranslate"><span class="pre">__spam</span></code> et j'obtiens une erreur à propos de <code class="docutils literal notranslate"><span class="pre">_SomeClassName__spam</span></code>.</a></p></li>
<li><p><a class="reference internal" href="#my-class-defines-del-but-it-is-not-called-when-i-delete-the-object" id="id65">Ma classe définit <code class="docutils literal notranslate"><span class="pre">__del__</span></code> mais elle n'est pas appelée lorsque je supprime l'objet.</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-get-a-list-of-all-instances-of-a-given-class" id="id66">Comment obtenir toutes les instances d'une classe ?</a></p></li>
<li><p><a class="reference internal" href="#why-does-the-result-of-id-appear-to-be-not-unique" id="id67">Pourquoi le résultat de <code class="docutils literal notranslate"><span class="pre">id()</span></code> peut-il être le même pour deux objets différents ?</a></p></li>
<li><p><a class="reference internal" href="#when-can-i-rely-on-identity-tests-with-the-is-operator" id="id68">Quand puis-je raisonnablement utiliser le test d'identité <em>is</em> ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-a-subclass-control-what-data-is-stored-in-an-immutable-instance" id="id69">Comment définir dans une classe fille les attributs d'une instance immuable ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-cache-method-calls" id="id70">Comment mettre en cache le résultat d'une méthode ?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#modules" id="id71">Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#how-do-i-create-a-pyc-file" id="id72">Comment créer des fichiers <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-find-the-current-module-name" id="id73">Comment obtenir le nom du module actuel ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-have-modules-that-mutually-import-each-other" id="id74">Comment avoir des modules qui s'importent mutuellement ?</a></p></li>
<li><p><a class="reference internal" href="#import-x-y-z-returns-module-x-how-do-i-get-z" id="id75"><code class="docutils literal notranslate"><span class="pre">__import__('x.y.z')</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">&lt;module</span> <span class="pre">'x'&gt;</span></code> ; comment accéder à <code class="docutils literal notranslate"><span class="pre">z</span></code> ?</a></p></li>
<li><p><a class="reference internal" href="#when-i-edit-an-imported-module-and-reimport-it-the-changes-don-t-show-up-why-does-this-happen" id="id76">Quand j'édite un module et que je le réimporte, je ne vois pas les changements. Pourquoi ?</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="general-questions">
<h2><a class="toc-backref" href="#id3">Questions générales</a><a class="headerlink" href="#general-questions" title="Lien permanent vers ce titre">¶</a></h2>
<section id="is-there-a-source-code-level-debugger-with-breakpoints-single-stepping-etc">
<h3><a class="toc-backref" href="#id4">Existe-t-il un débogueur de code source avec points d'arrêts, exécution pas-à-pas, etc. ?</a><a class="headerlink" href="#is-there-a-source-code-level-debugger-with-breakpoints-single-stepping-etc" title="Lien permanent vers ce titre">¶</a></h3>
<p>Oui.</p>
<p>Plusieurs débogueurs sont décrits ci-dessous et la fonction native <a class="reference internal" href="../library/functions.html#breakpoint" title="breakpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">breakpoint()</span></code></a> permet d'utiliser n'importe lequel d'entre eux.</p>
<p>Le module <code class="docutils literal notranslate"><span class="pre">pdb</span></code> est un débogueur console simple, mais parfaitement adapté à Python. Il fait partie de la bibliothèque standard de Python, sa documentation se trouve dans le <a class="reference internal" href="../library/pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">manuel</span> <span class="pre">de</span> <span class="pre">référence</span></code></a>. Vous pouvez vous inspirer du code de <code class="docutils literal notranslate"><span class="pre">pdb</span></code> pour écrire votre propre débogueur.</p>
<p>L'environnement de développement interactif IDLE, qui est fourni avec la distribution standard de Python (normalement disponible dans <a class="reference external" href="https://github.com/python/cpython/blob/main/Tools/scripts/idle3">Tools/scripts/idle3</a>) contient un débogueur graphique.</p>
<p><em>PythonWin</em> est un environnement de développement intégré (EDI) Python qui embarque un débogueur graphique basé sur <code class="docutils literal notranslate"><span class="pre">pdb</span></code>. Le débogueur <em>PythonWin</em> colore les points d'arrêts et possède quelques fonctionnalités sympathiques, comme la possibilité de déboguer des programmes développés sans <em>PythonWin</em>.  <em>PythonWin</em> est disponible dans le projet <a class="reference external" href="https://github.com/mhammond/pywin32">pywin32</a> et fait partie de la distribution <a class="reference external" href="https://www.activestate.com/products/python/">ActivePython</a>.</p>
<p><a class="reference external" href="https://eric-ide.python-projects.org/">Eric</a> est un EDI basé sur PyQt et l'outil d'édition Scintilla.</p>
<p><a class="reference external" href="https://github.com/rocky/python3-trepan/">trepan3k</a> est un débogueur semblable à GDB.</p>
<p><a class="reference external" href="https://code.visualstudio.com/">Visual Studio Code</a> est un EDI qui contient des outils de débogage. Il sait interagir avec les outils de gestion de versions.</p>
<p>Il existe de nombreux EDI Python propriétaires qui embarquent un débogueur graphique, notamment :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://wingware.com/">Wing IDE</a> ;</p></li>
<li><p><a class="reference external" href="https://www.activestate.com/products/komodo-ide/">Komodo IDE</a> ;</p></li>
<li><p><a class="reference external" href="https://www.jetbrains.com/pycharm/">PyCharm</a> ;</p></li>
</ul>
</section>
<section id="are-there-tools-to-help-find-bugs-or-perform-static-analysis">
<h3><a class="toc-backref" href="#id5">Existe-t-il des outils pour aider à trouver des bogues ou faire de l'analyse statique de code ?</a><a class="headerlink" href="#are-there-tools-to-help-find-bugs-or-perform-static-analysis" title="Lien permanent vers ce titre">¶</a></h3>
<p>Oui.</p>
<p><a class="reference external" href="https://pylint.pycqa.org/en/latest/index.html">Pylint</a> et <a class="reference external" href="https://github.com/PyCQA/pyflakes">Pyflakes</a> font des vérifications de base et vous aideront à trouver des bogues plus tôt.</p>
<p>Static type checkers such as <a class="reference external" href="https://mypy-lang.org/">Mypy</a>,
<a class="reference external" href="https://pyre-check.org/">Pyre</a>, and
<a class="reference external" href="https://github.com/google/pytype">Pytype</a> can check type hints in Python
source code.</p>
</section>
<section id="how-can-i-create-a-stand-alone-binary-from-a-python-script">
<span id="faq-create-standalone-binary"></span><h3><a class="toc-backref" href="#id6">Comment créer un binaire autonome à partir d'un script Python ?</a><a class="headerlink" href="#how-can-i-create-a-stand-alone-binary-from-a-python-script" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour créer un programme autonome, c'est-à-dire un programme que n'importe qui peut télécharger et exécuter sans avoir à installer une distribution Python au préalable, il n'est pas nécessaire de compiler du code Python en code C. Il existe en effet plusieurs outils qui déterminent les modules requis par un programme et lient ces modules avec un binaire Python pour produire un seul exécutable.</p>
<p>Un de ces outils est <em>freeze</em>, qui se trouve dans <a class="reference external" href="https://github.com/python/cpython/tree/main/Tools/freeze">Tools/freeze</a> de l'arborescence des sources de Python. Il convertit le code intermédiaire (<em>bytecode</em>) Python en tableaux C ; avec un compilateur C, vous pouvez intégrer tous vos modules dans un nouveau programme, qui est ensuite lié aux modules standards Python.</p>
<p>Il fonctionne en cherchant de manière récursive les instructions d'importation (sous les deux formes) dans le code source et en recherchant ces modules dans le chemin Python standard ainsi que dans le répertoire source (pour les modules natifs). Il transforme ensuite le code intermédiaire des modules écrits en Python en code C (des tableaux pré-remplis qui peuvent être transformés en objets code à l'aide du module <em>marshal</em>) et crée un fichier de configuration personnalisé qui contient uniquement les modules natifs qui sont réellement utilisés dans le programme. Il compile ensuite le code C généré et le lie au reste de l'interpréteur Python pour former un binaire autonome qui fait exactement la même chose que le script.</p>
<p>Voici quelques paquets qui permettent de créer des exécutables en ligne de commande comme graphiques :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nuitka.net/">Nuitka</a> (multiplateformes) ;</p></li>
<li><p><a class="reference external" href="https://pyinstaller.org/">PyInstaller</a> (Cross-platform)</p></li>
<li><p><a class="reference external" href="https://pyoxidizer.readthedocs.io/en/stable/">PyOxidizer</a> (multi-plateforme) ;</p></li>
<li><p><a class="reference external" href="https://marcelotduarte.github.io/cx_Freeze/">cx_Freeze</a> (multi-plateforme) ;</p></li>
<li><p><a class="reference external" href="https://github.com/ronaldoussoren/py2app">py2app</a> (uniquement pour macOS) ;</p></li>
<li><p><a class="reference external" href="https://www.py2exe.org/">py2exe</a> (uniquement pour Windows).</p></li>
</ul>
</section>
<section id="are-there-coding-standards-or-a-style-guide-for-python-programs">
<h3><a class="toc-backref" href="#id7">Existe-t-il des normes de développement ou un guide de style pour écrire des programmes Python ?</a><a class="headerlink" href="#are-there-coding-standards-or-a-style-guide-for-python-programs" title="Lien permanent vers ce titre">¶</a></h3>
<p>Oui. Le style de développement que les modules de la bibliothèque standard doivent obligatoirement respecter est documenté dans la <span class="target" id="index-9"></span><a class="pep reference external" href="https://peps.python.org/pep-0008/"><strong>PEP 8</strong></a>.</p>
</section>
</section>
<section id="core-language">
<h2><a class="toc-backref" href="#id8">Fondamentaux</a><a class="headerlink" href="#core-language" title="Lien permanent vers ce titre">¶</a></h2>
<section id="why-am-i-getting-an-unboundlocalerror-when-the-variable-has-a-value">
<span id="faq-unboundlocalerror"></span><h3><a class="toc-backref" href="#id9">Pourquoi une UnboundLocalError est levée alors qu'une variable a une valeur ?</a><a class="headerlink" href="#why-am-i-getting-an-unboundlocalerror-when-the-variable-has-a-value" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est parfois surprenant d'obtenir une <a class="reference internal" href="../library/exceptions.html#UnboundLocalError" title="UnboundLocalError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">UnboundLocalError</span></code></a> dans du code jusqu'à présent correct, quand celui-ci est modifié en ajoutant une instruction d'affectation quelque part dans le corps d'une fonction.</p>
<p>Le code suivant :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bar</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>fonctionne, mais le suivant :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>results in an <code class="xref py py-exc docutils literal notranslate"><span class="pre">UnboundLocalError</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">UnboundLocalError</span>: <span class="n">local variable &#39;x&#39; referenced before assignment</span>
</pre></div>
</div>
<p>Cela est dû au fait que, quand une variable est affectée dans un contexte, cette variable devient locale à ce contexte et remplace toute variable du même nom du contexte appelant. Vu que la dernière instruction dans <em>foo</em> affecte une nouvelle valeur à <code class="docutils literal notranslate"><span class="pre">x</span></code>, le compilateur la traite comme une nouvelle variable. Par conséquent, quand le <code class="docutils literal notranslate"><span class="pre">print(x)</span></code> essaye d'afficher la variable non initialisée, une erreur se produit.</p>
<p>Dans l'exemple ci-dessus, la variable du contexte appelant reste accessible en la déclarant globale :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foobar</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">global</span> <span class="n">x</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foobar</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Cette déclaration explicite est obligatoire pour se rappeler que (contrairement au cas à peu près similaire avec des variables de classe et d'instance), c'est la valeur de la variable du contexte appelant qui est modifiée :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
<p>Une alternative dans un contexte imbriqué consiste à utiliser le mot-clé <a class="reference internal" href="../reference/simple_stmts.html#nonlocal"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">nonlocal</span></code></a> :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
<span class="gp">... </span>       <span class="k">nonlocal</span> <span class="n">x</span>
<span class="gp">... </span>       <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">... </span>   <span class="n">bar</span><span class="p">()</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">()</span>
<span class="go">10</span>
<span class="go">11</span>
</pre></div>
</div>
</section>
<section id="what-are-the-rules-for-local-and-global-variables-in-python">
<h3><a class="toc-backref" href="#id10">Quelles sont les règles pour les variables locales et globales en Python ?</a><a class="headerlink" href="#what-are-the-rules-for-local-and-global-variables-in-python" title="Lien permanent vers ce titre">¶</a></h3>
<p>En Python, si une variable n'est pas modifiée dans une fonction mais seulement lue, elle est implicitement considérée comme globale. Si une valeur lui est affectée, elle est considérée locale (sauf si elle est explicitement déclarée globale).</p>
<p>Bien que surprenant au premier abord, ce choix s'explique facilement. D'une part, exiger <a class="reference internal" href="../reference/simple_stmts.html#global"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">global</span></code></a> pour des variables affectées est une protection contre des effets de bord inattendus. D'autre part, si <code class="docutils literal notranslate"><span class="pre">global</span></code> était obligatoire pour toutes les références à des objets globaux, il faudrait mettre <code class="docutils literal notranslate"><span class="pre">global</span></code> partout, car il faudrait dans ce cas déclarer globale chaque référence à une fonction native ou à un composant d'un module importé. Le codé serait alors truffé de déclarations <code class="docutils literal notranslate"><span class="pre">global</span></code>, ce qui nuirait à leur raison d'être : identifier les effets de bords.</p>
</section>
<section id="why-do-lambdas-defined-in-a-loop-with-different-values-all-return-the-same-result">
<h3><a class="toc-backref" href="#id11">Pourquoi des expressions lambda définies dans une boucle avec des valeurs différentes retournent-elles le même résultat ?</a><a class="headerlink" href="#why-do-lambdas-defined-in-a-loop-with-different-values-all-return-the-same-result" title="Lien permanent vers ce titre">¶</a></h3>
<p>Supposons que l'on utilise une boucle itérative pour définir des expressions lambda (voire des fonctions) différentes, par exemple :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">squares</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">squares</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Le code précédent crée une liste de 5 expressions lambda qui calculent chacune <code class="docutils literal notranslate"><span class="pre">x**2</span></code>. En les exécutant, on pourrait s'attendre à obtenir  <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code>, <code class="docutils literal notranslate"><span class="pre">9</span></code> et <code class="docutils literal notranslate"><span class="pre">16</span></code>. Elles renvoient en réalité toutes <code class="docutils literal notranslate"><span class="pre">16</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">squares</span><span class="p">[</span><span class="mi">2</span><span class="p">]()</span>
<span class="go">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">squares</span><span class="p">[</span><span class="mi">4</span><span class="p">]()</span>
<span class="go">16</span>
</pre></div>
</div>
<p>Ceci s'explique par le fait que <code class="docutils literal notranslate"><span class="pre">x</span></code> n'est pas une variable locale aux expressions, mais est définie dans le contexte appelant. Elle est lue à l'appel de l'expression lambda – et non au moment où cette expression est définie. À la fin de la boucle, <code class="docutils literal notranslate"><span class="pre">x</span></code> vaut <code class="docutils literal notranslate"><span class="pre">4</span></code>, donc toutes les fonctions renvoient <code class="docutils literal notranslate"><span class="pre">4*2</span></code>, c.-à-d. <code class="docutils literal notranslate"><span class="pre">16</span></code>. Ceci se vérifie également en changeant la valeur de <code class="docutils literal notranslate"><span class="pre">x</span></code> et en constatant que les résultats sont modifiés :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">squares</span><span class="p">[</span><span class="mi">2</span><span class="p">]()</span>
<span class="go">64</span>
</pre></div>
</div>
<p>Pour éviter ce phénomène, les valeurs doivent être stockées dans des variables locales aux expressions lambda pour que celles-ci ne se basent plus sur la variable globale <code class="docutils literal notranslate"><span class="pre">x</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">squares</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">squares</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="o">=</span><span class="n">x</span><span class="p">:</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Dans ce code, <code class="docutils literal notranslate"><span class="pre">n=x</span></code> crée une nouvelle variable <code class="docutils literal notranslate"><span class="pre">n</span></code>, locale à l'expression. Cette variable est évaluée quand l'expression est définie donc <code class="docutils literal notranslate"><span class="pre">n</span></code> a la même valeur que <code class="docutils literal notranslate"><span class="pre">x</span></code> à ce moment. La valeur de <code class="docutils literal notranslate"><span class="pre">n</span></code> est donc <code class="docutils literal notranslate"><span class="pre">0</span></code> dans la première lambda, <code class="docutils literal notranslate"><span class="pre">1</span></code> dans la deuxième, <code class="docutils literal notranslate"><span class="pre">2</span></code> dans la troisième et ainsi de suite. Chaque expression lambda renvoie donc le résultat correct :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">squares</span><span class="p">[</span><span class="mi">2</span><span class="p">]()</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">squares</span><span class="p">[</span><span class="mi">4</span><span class="p">]()</span>
<span class="go">16</span>
</pre></div>
</div>
<p>Ce comportement n'est pas propre aux expressions lambda, mais s'applique aussi aux fonctions normales.</p>
</section>
<section id="how-do-i-share-global-variables-across-modules">
<h3><a class="toc-backref" href="#id12">Comment partager des variables globales entre modules ?</a><a class="headerlink" href="#how-do-i-share-global-variables-across-modules" title="Lien permanent vers ce titre">¶</a></h3>
<p>La manière standard de partager des informations entre modules d'un même programme est de créer un module spécial (souvent appelé <em>config</em> ou <em>cfg</em>) et de l'importer dans tous les modules de l'application ; le module devient accessible depuis l'espace de nommage global. Vu qu'il n'y a qu'une instance de chaque module, tout changement dans l'instance est propagé partout. Par exemple :</p>
<p><em>config.py</em> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># Default value of the &#39;x&#39; configuration setting</span>
</pre></div>
</div>
<p><em>mod.py</em> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">config</span>
<span class="n">config</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p><em>main.py</em> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">config</span>
<span class="kn">import</span> <span class="nn">mod</span>
<span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour les mêmes raisons, l'utilisation d'un module est aussi à la base de l'implémentation du patron de conception singleton.</p>
</section>
<section id="what-are-the-best-practices-for-using-import-in-a-module">
<h3><a class="toc-backref" href="#id13">Quelles sont les « bonnes pratiques » pour utiliser import dans un module ?</a><a class="headerlink" href="#what-are-the-best-practices-for-using-import-in-a-module" title="Lien permanent vers ce titre">¶</a></h3>
<p>De manière générale, il ne faut pas faire <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">modulename</span> <span class="pre">import</span> <span class="pre">*</span></code>. Ceci encombre l'espace de nommage de l'importateur et rend la détection de noms non-définis beaucoup plus ardue pour les analyseurs de code.</p>
<p>Les modules doivent être importés au début d'un fichier. Ceci permet d'afficher clairement de quels modules le code à besoin et évite de se demander si le module est dans le contexte. Faire un seul <code class="docutils literal notranslate"><span class="pre">import</span></code> par ligne rend l'ajout et la suppression d'une importation de module plus aisé, mais importer plusieurs modules sur une même ligne prend moins d'espace.</p>
<p>Il est recommandé d'importer les modules dans l'ordre suivant :</p>
<ol class="arabic simple">
<li><p>les modules de la bibliothèque standard — p. ex. <a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a>, <a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a>, <a class="reference internal" href="../library/getopt.html#module-getopt" title="getopt: Portable parser for command line options; support both short and long option names."><code class="xref py py-mod docutils literal notranslate"><span class="pre">getopt</span></code></a>, <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a></p></li>
<li><p>les modules externes (tout ce qui est installé dans le dossier <em>site-packages</em> de Python) — par exemple <code class="xref py py-mod docutils literal notranslate"><span class="pre">dateutil</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">requests</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">PIL.Image</span></code></p></li>
<li><p>les modules développés en local</p></li>
</ol>
<p>Il est parfois nécessaire de déplacer des importations dans une fonction ou une classe pour éviter les problèmes d'importations circulaires. Comme le souligne Gordon McMillan :</p>
<blockquote>
<div><p>Il n'y a aucun souci à faire des importations circulaires tant que les deux modules utilisent la forme <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">&lt;module&gt;</span></code>. Ça ne pose problème que si le second module cherche à récupérer un nom du premier module (<em>&quot;from module import name&quot;</em>) et que l'importation est dans l'espace de nommage du fichier. Les noms du premier module ne sont en effet pas encore disponibles car le premier module est occupé à importer le second.</p>
</div></blockquote>
<p>Dans ce cas, si le second module n'est utilisé que dans une fonction, l'importation peut facilement être déplacée dans cette fonction. Au moment où l'importation sera appelée, le premier module aura fini de s'initialiser et le second pourra faire son importation.</p>
<p>Il peut parfois être nécessaire de déplacer des importations de modules hors de l'espace de plus haut niveau du code si certains de ces modules dépendent de la machine utilisée. Dans ce cas de figure, il est parfois impossible d'importer tous les modules au début du fichier. Dans ce cas, il est recommandé d'importer les modules adéquats dans le code spécifique à la machine.</p>
<p>Les importations ne devraient être déplacées dans un espace de nommage local, comme dans la définition d'une fonction, que si cela est nécessaire pour résoudre un problème comme éviter des dépendances circulaires ou réduire le temps d'initialisation d'un module. Cette technique est particulièrement utile si la majorité des importations est superflue selon le flux d'exécution du programme. Il est également pertinent de déplacer des importations dans une fonction si le module n'est utilisé qu'au sein de cette fonction. Le premier chargement d'un module peut être coûteux à cause du coût fixe d'initialisation d'un module, mais charger un module plusieurs fois est quasiment gratuit, cela ne coûte que quelques indirections dans un dictionnaire. Même si le nom du module est sorti du contexte courant, le module est probablement disponible dans <a class="reference internal" href="../library/sys.html#sys.modules" title="sys.modules"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>.</p>
</section>
<section id="why-are-default-values-shared-between-objects">
<h3><a class="toc-backref" href="#id14">Pourquoi les arguments par défaut sont-ils partagés entre les objets ?</a><a class="headerlink" href="#why-are-default-values-shared-between-objects" title="Lien permanent vers ce titre">¶</a></h3>
<p>C'est un problème que rencontrent souvent les programmeurs débutants. Examinons la fonction suivante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">mydict</span><span class="o">=</span><span class="p">{}):</span>  <span class="c1"># Danger: shared reference to one dict for all calls</span>
    <span class="o">...</span> <span class="n">compute</span> <span class="n">something</span> <span class="o">...</span>
    <span class="n">mydict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">mydict</span>
</pre></div>
</div>
<p>Au premier appel de cette fonction, <code class="docutils literal notranslate"><span class="pre">mydict</span></code> ne contient qu'un seul élément. Au second appel, <code class="docutils literal notranslate"><span class="pre">mydict</span></code> contient deux éléments car quand <code class="docutils literal notranslate"><span class="pre">foo()</span></code> commence son exécution, <code class="docutils literal notranslate"><span class="pre">mydict</span></code> contient déjà un élément.</p>
<p>On est souvent amené à croire qu'un appel de fonction créé des nouveaux objets pour les valeurs par défaut. Ce n'est pas le cas. Les valeurs par défaut ne sont créées qu'une et une seule fois, au moment où la fonction est définie. Si l'objet est modifié, comme le dictionnaire dans cet exemple, les appels suivants à cette fonction font référence à l'objet ainsi modifié.</p>
<p>Par définition, les objets immuables comme les nombres, les chaînes de caractères, les <em>n</em>-uplets et <code class="docutils literal notranslate"><span class="pre">None</span></code> ne sont pas modifiés. Les changements sur des objets modifiables comme les dictionnaires, les listes et les instances de classe peuvent porter à confusion.</p>
<p>En raison de cette fonctionnalité, il vaut mieux ne pas utiliser d'objets modifiables comme valeurs par défaut. Il vaut mieux utiliser <code class="docutils literal notranslate"><span class="pre">None</span></code> comme valeur par défaut et, à l'intérieur de la fonction, vérifier si le paramètre est à <code class="docutils literal notranslate"><span class="pre">None</span></code> et créer une nouvelle liste, dictionnaire ou autre, le cas échéant. Par exemple, il ne faut pas écrire :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">mydict</span><span class="o">=</span><span class="p">{}):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>mais plutôt :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">mydict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mydict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mydict</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># create a new dict for local namespace</span>
</pre></div>
</div>
<p>Cette fonctionnalité a une utilité. Il est courant de mettre en cache les paramètres et la valeur de retour de chacun des appels d'une fonction coûteuse à exécuter, et de renvoyer la valeur stockée en cache si le même appel est ré-effectué. C'est la technique dite de « mémoïsation », qui s'implémente de la manière suivante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Callers can only provide two parameters and optionally pass _cache by keyword</span>
<span class="k">def</span> <span class="nf">expensive</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">_cache</span><span class="o">=</span><span class="p">{}):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">_cache</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_cache</span><span class="p">[(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)]</span>

    <span class="c1"># Calculate the value</span>
    <span class="n">result</span> <span class="o">=</span> <span class="o">...</span> <span class="n">expensive</span> <span class="n">computation</span> <span class="o">...</span>
    <span class="n">_cache</span><span class="p">[(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span>           <span class="c1"># Store result in the cache</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Il est possible d'utiliser une variable globale contenant un dictionnaire à la place de la valeur par défaut ; ce n'est qu'une question de goût.</p>
</section>
<section id="how-can-i-pass-optional-or-keyword-parameters-from-one-function-to-another">
<h3><a class="toc-backref" href="#id15">Comment passer des paramètres optionnels ou nommés d'une fonction à l'autre ?</a><a class="headerlink" href="#how-can-i-pass-optional-or-keyword-parameters-from-one-function-to-another" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il faut récupérer les arguments en utilisant les sélecteurs <code class="docutils literal notranslate"><span class="pre">*</span></code> et <code class="docutils literal notranslate"><span class="pre">**</span></code> dans la liste des paramètres de la fonction ; ceci donne les arguments positionnels sous la forme d'un <em>n</em>-uplet et les arguments nommés sous forme de dictionnaire. Ces arguments peuvent être passés à une autre fonction en utilisant <code class="docutils literal notranslate"><span class="pre">*</span></code> et <code class="docutils literal notranslate"><span class="pre">**</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;14.3c&#39;</span>
    <span class="o">...</span>
    <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="what-is-the-difference-between-arguments-and-parameters">
<span id="faq-argument-vs-parameter"></span><span id="index-1"></span><h3><a class="toc-backref" href="#id16">Quelle est la différence entre les arguments et les paramètres ?</a><a class="headerlink" href="#what-is-the-difference-between-arguments-and-parameters" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les <a class="reference internal" href="../glossary.html#term-parameter"><span class="xref std std-term">paramètres</span></a> sont les noms qui apparaissent dans une définition de fonction, alors que les <a class="reference internal" href="../glossary.html#term-argument"><span class="xref std std-term">arguments</span></a> sont les valeurs qui sont réellement passées à une fonction lors de l'appel de celle-ci. Les paramètres définissent les <a class="reference internal" href="../glossary.html#term-parameter"><span class="xref std std-term">types d'arguments</span></a> qu'une fonction accepte. Ainsi, avec la définition de fonction suivante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p><em>foo</em>, <em>bar</em> et <em>kwargs</em> sont des paramètres de <code class="docutils literal notranslate"><span class="pre">func</span></code>. Mais à l'appel de <code class="docutils literal notranslate"><span class="pre">func</span></code> avec, par exemple :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="mi">314</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="n">somevar</span><span class="p">)</span>
</pre></div>
</div>
<p>les valeurs <code class="docutils literal notranslate"><span class="pre">42</span></code>, <code class="docutils literal notranslate"><span class="pre">314</span></code>, et <code class="docutils literal notranslate"><span class="pre">somevar</span></code> sont des arguments.</p>
</section>
<section id="why-did-changing-list-y-also-change-list-x">
<h3><a class="toc-backref" href="#id17">Pourquoi modifier la liste 'y' modifie aussi la liste 'x' ?</a><a class="headerlink" href="#why-did-changing-list-y-also-change-list-x" title="Lien permanent vers ce titre">¶</a></h3>
<p>Si vous avez écrit du code comme :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">[10]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[10]</span>
</pre></div>
</div>
<p>vous vous demandez peut-être pourquoi l'ajout d'un élément à <code class="docutils literal notranslate"><span class="pre">y</span></code> a aussi changé <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>Il y a deux raisons qui conduisent à ce comportement :</p>
<ol class="arabic simple">
<li><p>Les variables ne sont que des noms qui font référence à des objets. La ligne <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">x</span></code> ne crée pas une copie de la liste — elle crée une nouvelle variable <code class="docutils literal notranslate"><span class="pre">y</span></code> qui pointe sur le même objet que <code class="docutils literal notranslate"><span class="pre">x</span></code>. Ceci signifie qu'il n'existe qu'un seul objet (la liste) auquel <code class="docutils literal notranslate"><span class="pre">x</span></code> et <code class="docutils literal notranslate"><span class="pre">y</span></code> font référence.</p></li>
<li><p>Les listes sont des <a class="reference internal" href="../glossary.html#term-mutable"><span class="xref std std-term">muable</span></a>, ce qui signifie que leur contenu peut être modifié.</p></li>
</ol>
<p>After the call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">append()</span></code>, the content of the mutable object has
changed from <code class="docutils literal notranslate"><span class="pre">[]</span></code> to <code class="docutils literal notranslate"><span class="pre">[10]</span></code>.  Since both the variables refer to the same
object, using either name accesses the modified value <code class="docutils literal notranslate"><span class="pre">[10]</span></code>.</p>
<p>Si au contraire, on affecte un objet immuable à <code class="docutils literal notranslate"><span class="pre">x</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># ints are immutable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># 5 can&#39;t be mutated, we are creating a new object here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">5</span>
</pre></div>
</div>
<p>on observe que <code class="docutils literal notranslate"><span class="pre">x</span></code> et <code class="docutils literal notranslate"><span class="pre">y</span></code> ne sont ici plus égales. Les entiers sont des immuables (<a class="reference internal" href="../glossary.html#term-immutable"><span class="xref std std-term">immutable</span></a>), et <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">1</span></code> ne change pas l'entier <code class="docutils literal notranslate"><span class="pre">5</span></code> en incrémentant sa valeur. Au contraire, un nouvel objet est créé (l'entier <code class="docutils literal notranslate"><span class="pre">6</span></code>) et affecté à <code class="docutils literal notranslate"><span class="pre">x</span></code> (c'est-à-dire qu'on change l'objet auquel fait référence <code class="docutils literal notranslate"><span class="pre">x</span></code>). Après cette affectation on a deux objets (les entiers <code class="docutils literal notranslate"><span class="pre">6</span></code> et <code class="docutils literal notranslate"><span class="pre">5</span></code>) et deux variables qui font référence à ces deux objets (<code class="docutils literal notranslate"><span class="pre">x</span></code> fait désormais référence à <code class="docutils literal notranslate"><span class="pre">6</span></code> mais <code class="docutils literal notranslate"><span class="pre">y</span></code> fait toujours référence à <code class="docutils literal notranslate"><span class="pre">5</span></code>).</p>
<p>Certaines opérations (par exemple, <code class="docutils literal notranslate"><span class="pre">y.append(10)</span></code> et <code class="docutils literal notranslate"><span class="pre">y.sort()</span></code>) modifient l'objet, alors que des opérations identiques en apparence (par exemple <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">+</span> <span class="pre">[10]</span></code> et <code class="xref py py-func docutils literal notranslate"><span class="pre">sorted(y)()</span></code>) créent un nouvel objet. En général, en Python, une méthode qui modifie un objet renvoie <code class="docutils literal notranslate"><span class="pre">None</span></code> (c'est même systématique dans la bibliothèque standard) pour éviter la confusion entre les deux opérations. Donc écrire par erreur <code class="docutils literal notranslate"><span class="pre">y.sort()</span></code> en pensant obtenir une copie triée de <code class="docutils literal notranslate"><span class="pre">y</span></code> donne <code class="docutils literal notranslate"><span class="pre">None</span></code>, ce qui conduit très souvent le programme à générer une erreur facile à diagnostiquer.</p>
<p>Il existe cependant une classe d'opérations qui se comporte différemment selon le type : les opérateurs d'affectation incrémentaux. Par exemple, <code class="docutils literal notranslate"><span class="pre">+=</span></code> modifie les listes mais pas les <em>n</em>-uplets ni les entiers (<code class="docutils literal notranslate"><span class="pre">a_list</span> <span class="pre">+=</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code> équivaut à <code class="docutils literal notranslate"><span class="pre">a_list.extend([1,</span> <span class="pre">2,</span> <span class="pre">3])</span></code> et modifie <code class="docutils literal notranslate"><span class="pre">a_list</span></code>, alors que <code class="docutils literal notranslate"><span class="pre">some_tuple</span> <span class="pre">+=</span> <span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">3)</span></code> et <code class="docutils literal notranslate"><span class="pre">some_int</span> <span class="pre">+=</span> <span class="pre">1</span></code> créent de nouveaux objets).</p>
<p>En d'autres termes :</p>
<ul class="simple">
<li><p>Il est possible d'appliquer des opérations qui modifient un objet muable (<a class="reference internal" href="../library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <a class="reference internal" href="../library/stdtypes.html#set" title="set"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a>, etc.) et toutes les variables qui y font référence verront le changement.</p></li>
<li><p>Toutes les variables qui font référence à un objet immuable (<a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference internal" href="../library/stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>, etc.) renvoient la même valeur, mais les opérations qui transforment cette valeur en une nouvelle valeur renvoient toujours un nouvel objet.</p></li>
</ul>
<p>L'opérateur <a class="reference internal" href="../reference/expressions.html#is"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">is</span></code></a> ou la fonction native <a class="reference internal" href="../library/functions.html#id" title="id"><code class="xref py py-func docutils literal notranslate"><span class="pre">id()</span></code></a> permettent de savoir si deux variables font référence au même objet.</p>
</section>
<section id="how-do-i-write-a-function-with-output-parameters-call-by-reference">
<h3><a class="toc-backref" href="#id18">Comment écrire une fonction qui modifie ses paramètres ? (passage par référence)</a><a class="headerlink" href="#how-do-i-write-a-function-with-output-parameters-call-by-reference" title="Lien permanent vers ce titre">¶</a></h3>
<p>En Python, les arguments sont passés comme des affectations de variables. Vu qu'une affectation crée des références à des objets, il n'y a pas de lien entre un argument dans l'appel de la fonction et sa définition, et donc pas de passage par référence en soi. Il y a cependant plusieurs façons d'en émuler un.</p>
<ol class="arabic">
<li><p>En renvoyant un <em>n</em>-uplet de résultats :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;new-value&#39;</span>        <span class="c1"># a and b are local names</span>
<span class="gp">... </span>    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span>              <span class="c1"># assigned to new objects</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>            <span class="c1"># return new values</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;old-value&#39;</span><span class="p">,</span> <span class="mi">99</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">(&#39;new-value&#39;, 100)</span>
</pre></div>
</div>
<p>C'est presque toujours la meilleure solution.</p>
</li>
<li><p>En utilisant des variables globales. Cette approche ne fonctionne pas dans des contextes à plusieurs fils d'exécution (elle n'est pas <em>thread-safe</em>), et n'est donc pas recommandée.</p></li>
<li><p>En passant un objet muable (modifiable sur place) :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;new-value&#39;</span>     <span class="c1"># &#39;a&#39; references a mutable list</span>
<span class="gp">... </span>    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>        <span class="c1"># changes a shared object</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;old-value&#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func2</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span>
<span class="go">[&#39;new-value&#39;, 100]</span>
</pre></div>
</div>
</li>
<li><p>En passant un dictionnaire, qui sera modifié :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func3</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;new-value&#39;</span>     <span class="c1"># args is a mutable dictionary</span>
<span class="gp">... </span>    <span class="n">args</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>   <span class="c1"># change it in-place</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;old-value&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">99</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func3</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span>
<span class="go">{&#39;a&#39;: &#39;new-value&#39;, &#39;b&#39;: 100}</span>
</pre></div>
</div>
</li>
<li><p>Ou regrouper les valeurs dans une instance de classe :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Namespace</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func4</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">args</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;new-value&#39;</span>        <span class="c1"># args is a mutable Namespace</span>
<span class="gp">... </span>    <span class="n">args</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span>         <span class="c1"># change object in-place</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s1">&#39;old-value&#39;</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func4</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="go">{&#39;a&#39;: &#39;new-value&#39;, &#39;b&#39;: 100}</span>
</pre></div>
</div>
<p>Faire quelque chose d'aussi compliqué est rarement une bonne idée.</p>
</li>
</ol>
<p>La meilleure option reste de renvoyer un <em>n</em>-uplet contenant les différents résultats.</p>
</section>
<section id="how-do-you-make-a-higher-order-function-in-python">
<h3><a class="toc-backref" href="#id19">Comment construire une fonction d'ordre supérieur en Python ?</a><a class="headerlink" href="#how-do-you-make-a-higher-order-function-in-python" title="Lien permanent vers ce titre">¶</a></h3>
<p>Deux possibilités : on peut utiliser des portées imbriquées ou bien des objets appelables. Par exemple, supposons que l'on souhaite définir <code class="docutils literal notranslate"><span class="pre">linear(a,</span> <span class="pre">b)</span></code> qui renvoie une fonction <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> qui calcule la valeur <code class="docutils literal notranslate"><span class="pre">a*x+b</span></code>. En utilisant les portées imbriquées :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p>Ou en utilisant un objet appelable :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">linear</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
</pre></div>
</div>
<p>Dans les deux cas</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxes</span> <span class="o">=</span> <span class="n">linear</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>donne un objet appelable où <code class="docutils literal notranslate"><span class="pre">taxes(10e6)</span> <span class="pre">==</span> <span class="pre">0.3</span> <span class="pre">*</span> <span class="pre">10e6</span> <span class="pre">+</span> <span class="pre">2</span></code>.</p>
<p>L'approche par objet appelable a le désavantage d'être légèrement plus lente et de produire un code légèrement plus long. Cependant, il faut noter qu'une collection d'objet appelables peuvent partager leurs signatures par héritage :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">exponential</span><span class="p">(</span><span class="n">linear</span><span class="p">):</span>
    <span class="c1"># __init__ inherited</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>Les objets peuvent encapsuler un état pour plusieurs méthodes :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">counter</span><span class="p">:</span>

    <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">up</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
<span class="n">inc</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">reset</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">up</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">down</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">set</span>
</pre></div>
</div>
<p>Ici <code class="docutils literal notranslate"><span class="pre">inc()</span></code>, <code class="docutils literal notranslate"><span class="pre">dec()</span></code> et <code class="docutils literal notranslate"><span class="pre">reset()</span></code> agissent comme des fonctions partageant une même variable compteur.</p>
</section>
<section id="how-do-i-copy-an-object-in-python">
<h3><a class="toc-backref" href="#id20">Comment copier un objet en Python ?</a><a class="headerlink" href="#how-do-i-copy-an-object-in-python" title="Lien permanent vers ce titre">¶</a></h3>
<p>En général, essayez <a class="reference internal" href="../library/copy.html#copy.copy" title="copy.copy"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy.copy()</span></code></a> ou <a class="reference internal" href="../library/copy.html#copy.deepcopy" title="copy.deepcopy"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy.deepcopy()</span></code></a>. Tous les objets ne peuvent pas être copiés, mais la plupart le peuvent.</p>
<p>Certains objets peuvent être copiés plus facilement que d'autres. Les dictionnaires ont une méthode <a class="reference internal" href="../library/stdtypes.html#dict.copy" title="dict.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">newdict</span> <span class="o">=</span> <span class="n">olddict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Les séquences peuvent être copiées via la syntaxe des tranches :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_l</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:]</span>
</pre></div>
</div>
</section>
<section id="how-can-i-find-the-methods-or-attributes-of-an-object">
<h3><a class="toc-backref" href="#id21">Comment récupérer les méthodes ou les attributs d'un objet ?</a><a class="headerlink" href="#how-can-i-find-the-methods-or-attributes-of-an-object" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour une instance <code class="docutils literal notranslate"><span class="pre">x</span></code> d'une classe définie par un utilisateur, <a class="reference internal" href="../library/functions.html#dir" title="dir"><code class="xref py py-func docutils literal notranslate"><span class="pre">dir(x)</span></code></a> renvoie une liste alphabétique des noms contenants les attributs de l'instance, et les attributs et méthodes définies par sa classe.</p>
</section>
<section id="how-can-my-code-discover-the-name-of-an-object">
<h3><a class="toc-backref" href="#id22">Comment un code peut-il obtenir le nom d'un objet ?</a><a class="headerlink" href="#how-can-my-code-discover-the-name-of-an-object" title="Lien permanent vers ce titre">¶</a></h3>
<p>C'est impossible en général, parce qu'un objet n'a pas de nom à proprement parler. Schématiquement, l'affectation fait correspondre un nom à une valeur ; c'est vrai aussi pour les instructions <code class="docutils literal notranslate"><span class="pre">def</span></code> et <code class="docutils literal notranslate"><span class="pre">class</span></code>, à la différence près que, dans ce cas, la valeur est un appelable. Par exemple, dans le code suivant :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">&lt;__main__.A object at 0x16D07CC&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;__main__.A object at 0x16D07CC&gt;</span>
</pre></div>
</div>
<p>Affirmer que la classe a un nom est discutable. Bien qu'elle soit liée à deux noms, et qu'elle soit appelée via le nom <code class="docutils literal notranslate"><span class="pre">B</span></code>, l'instance créée déclare tout de même être une instance de la classe <code class="docutils literal notranslate"><span class="pre">A</span></code>. De même, il est impossible de dire si le nom de l'instance est <code class="docutils literal notranslate"><span class="pre">a</span></code> ou <code class="docutils literal notranslate"><span class="pre">b</span></code>, les deux noms étant attachés à la même valeur.</p>
<p>De façon générale, une application ne devrait pas avoir besoin de « connaître le nom » d'une valeur particulière. À moins d'être délibérément en train d'écrire un programme introspectif, c'est souvent l'indication qu'un changement d'approche serait bénéfique.</p>
<p>Sur <em>comp.lang.python</em>, Fredrik Lundh a donné un jour une excellente analogie pour répondre à cette question :</p>
<blockquote>
<div><p>C'est pareil que trouver le nom du chat qui traîne devant votre porte : le chat (objet) ne peut pas vous dire lui-même son nom, et il s'en moque un peu ­– alors le meilleur moyen de savoir comment il s'appelle est de demander à tous vos voisins (espaces de nommage) si c'est leur chat (objet)…</p>
<p>…et ne soyez pas surpris si vous découvrez qu'il est connu sous plusieurs noms, ou s'il n'a pas de nom du tout !</p>
</div></blockquote>
</section>
<section id="what-s-up-with-the-comma-operator-s-precedence">
<h3><a class="toc-backref" href="#id23">Qu'en est-il de la précédence de l'opérateur virgule ?</a><a class="headerlink" href="#what-s-up-with-the-comma-operator-s-precedence" title="Lien permanent vers ce titre">¶</a></h3>
<p>La virgule n'est pas un opérateur en Python. Observez le code suivant :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;a&quot;</span> <span class="ow">in</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span>
<span class="go">(False, &#39;a&#39;)</span>
</pre></div>
</div>
<p>Comme la virgule n'est pas un opérateur, mais un séparateur entre deux expressions, l'expression ci-dessus est évaluée de la même façon que si vous aviez écrit :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s2">&quot;a&quot;</span> <span class="ow">in</span> <span class="s2">&quot;b&quot;</span><span class="p">),</span> <span class="s2">&quot;a&quot;</span>
</pre></div>
</div>
<p>et non :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;a&quot;</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ceci est vrai pour tous les opérateurs d'affectation (<code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">+=</span></code> etc). Ce ne sont pas vraiment des opérateurs mais plutôt des délimiteurs syntaxiques dans les instructions d'affectation.</p>
</section>
<section id="is-there-an-equivalent-of-c-s-ternary-operator">
<h3><a class="toc-backref" href="#id24">Existe-t-il un équivalent à l'opérateur ternaire « ?: » du C ?</a><a class="headerlink" href="#is-there-an-equivalent-of-c-s-ternary-operator" title="Lien permanent vers ce titre">¶</a></h3>
<p>Oui. Sa syntaxe est la suivante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">on_true</span><span class="p">]</span> <span class="k">if</span> <span class="p">[</span><span class="n">expression</span><span class="p">]</span> <span class="k">else</span> <span class="p">[</span><span class="n">on_false</span><span class="p">]</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span>
<span class="n">small</span> <span class="o">=</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="k">else</span> <span class="n">y</span>
</pre></div>
</div>
<p>Avant l'introduction de cette syntaxe dans Python 2.5, il était courant d'utiliser les opérateurs de logique :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">expression</span><span class="p">]</span> <span class="ow">and</span> <span class="p">[</span><span class="n">on_true</span><span class="p">]</span> <span class="ow">or</span> <span class="p">[</span><span class="n">on_false</span><span class="p">]</span>
</pre></div>
</div>
<p>Cet idiome est dangereux, car il donne un résultat erroné quand <em>on_true</em> a la valeur booléenne fausse. Il faut donc toujours utiliser la forme <code class="docutils literal notranslate"><span class="pre">...</span> <span class="pre">if</span> <span class="pre">...</span> <span class="pre">else</span> <span class="pre">...</span></code>.</p>
</section>
<section id="is-it-possible-to-write-obfuscated-one-liners-in-python">
<h3><a class="toc-backref" href="#id25">Est-il possible d'écrire des programmes obscurcis (<em>obfuscated</em>) d'une ligne en Python ?</a><a class="headerlink" href="#is-it-possible-to-write-obfuscated-one-liners-in-python" title="Lien permanent vers ce titre">¶</a></h3>
<p>Oui. C'est souvent le cas en imbriquant des <a class="reference internal" href="../reference/expressions.html#lambda"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">lambda</span></code></a> dans des <code class="xref std std-keyword docutils literal notranslate"><span class="pre">lambda</span></code>. Par exemple les trois morceaux de code suivants, légèrement adaptés par Ulf Bartelt :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="c1"># Primes &lt; 1000</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">*</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span>
<span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">%</span><span class="n">x</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))),</span><span class="mi">1</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)))))</span>

<span class="c1"># First 10 Fibonacci numbers</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">:(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">f</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">f</span><span class="p">))</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span><span class="p">:</span>
<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))))</span>

<span class="c1"># Mandelbrot set</span>
<span class="nb">print</span><span class="p">((</span><span class="k">lambda</span> <span class="n">Ru</span><span class="p">,</span><span class="n">Ro</span><span class="p">,</span><span class="n">Iu</span><span class="p">,</span><span class="n">Io</span><span class="p">,</span><span class="n">IM</span><span class="p">,</span><span class="n">Sx</span><span class="p">,</span><span class="n">Sy</span><span class="p">:</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">y</span><span class="p">,</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span>
<span class="n">Iu</span><span class="o">=</span><span class="n">Iu</span><span class="p">,</span><span class="n">Io</span><span class="o">=</span><span class="n">Io</span><span class="p">,</span><span class="n">Ru</span><span class="o">=</span><span class="n">Ru</span><span class="p">,</span><span class="n">Ro</span><span class="o">=</span><span class="n">Ro</span><span class="p">,</span><span class="n">Sy</span><span class="o">=</span><span class="n">Sy</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="k">lambda</span> <span class="n">yc</span><span class="p">,</span><span class="n">Iu</span><span class="o">=</span><span class="n">Iu</span><span class="p">,</span><span class="n">Io</span><span class="o">=</span><span class="n">Io</span><span class="p">,</span><span class="n">Ru</span><span class="o">=</span><span class="n">Ru</span><span class="p">,</span><span class="n">Ro</span><span class="o">=</span><span class="n">Ro</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="n">IM</span><span class="p">,</span>
<span class="n">Sx</span><span class="o">=</span><span class="n">Sx</span><span class="p">,</span><span class="n">Sy</span><span class="o">=</span><span class="n">Sy</span><span class="p">:</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">xc</span><span class="o">=</span><span class="n">Ru</span><span class="p">,</span><span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span><span class="n">Ru</span><span class="o">=</span><span class="n">Ru</span><span class="p">,</span><span class="n">Ro</span><span class="o">=</span><span class="n">Ro</span><span class="p">,</span>
<span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">Sx</span><span class="o">=</span><span class="n">Sx</span><span class="p">,</span><span class="n">F</span><span class="o">=</span><span class="k">lambda</span> <span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">f</span><span class="p">:(</span><span class="n">k</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="ow">or</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">y</span>
<span class="o">&gt;=</span><span class="mf">4.0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">1</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">xc</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">yc</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">f</span><span class="p">):</span><span class="n">f</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">f</span><span class="p">):</span><span class="nb">chr</span><span class="p">(</span>
<span class="mi">64</span><span class="o">+</span><span class="n">F</span><span class="p">(</span><span class="n">Ru</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">Ro</span><span class="o">-</span><span class="n">Ru</span><span class="p">)</span><span class="o">/</span><span class="n">Sx</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)),</span><span class="nb">range</span><span class="p">(</span><span class="n">Sx</span><span class="p">))):</span><span class="n">L</span><span class="p">(</span><span class="n">Iu</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">Io</span><span class="o">-</span><span class="n">Iu</span><span class="p">)</span><span class="o">/</span><span class="n">Sy</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="n">Sy</span>
<span class="p">))))(</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
<span class="c1">#    \___ ___/  \___ ___/  |   |   |__ lines on screen</span>
<span class="c1">#        V          V      |   |______ columns on screen</span>
<span class="c1">#        |          |      |__________ maximum of &quot;iterations&quot;</span>
<span class="c1">#        |          |_________________ range on y axis</span>
<span class="c1">#        |____________________________ range on x axis</span>
</pre></div>
</div>
<p>Les enfants, ne faites pas ça chez vous !</p>
</section>
<section id="what-does-the-slash-in-the-parameter-list-of-a-function-mean">
<span id="faq-positional-only-arguments"></span><h3><a class="toc-backref" href="#id26">Que signifie la barre oblique (/) dans la liste des paramètres d'une fonction ?</a><a class="headerlink" href="#what-does-the-slash-in-the-parameter-list-of-a-function-mean" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une barre oblique dans la liste des arguments d'une fonction indique que les paramètres la précédant sont uniquement positionnels. Les paramètres uniquement positionnels ne peuvent pas être référencés par leur nom depuis l'extérieur. Lors de l'appel d'une fonction qui accepte des paramètres uniquement positionnels, les arguments sont affectés aux paramètres en fonction de leur position. Par exemple, la fonction <a class="reference internal" href="../library/functions.html#divmod" title="divmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">divmod()</span></code></a> n'accepte que des paramètres uniquement positionnels. Sa documentation est la suivante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="nb">divmod</span><span class="p">)</span>
<span class="go">Help on built-in function divmod in module builtins:</span>

<span class="go">divmod(x, y, /)</span>
<span class="go">    Return the tuple (x//y, x%y).  Invariant: div*y + mod == x.</span>
</pre></div>
</div>
<p>La barre oblique à la fin de la liste des paramètres signifie que les trois paramètres sont uniquement positionnels. Et donc, appeler <a class="reference internal" href="../library/functions.html#divmod" title="divmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">divmod()</span></code></a> avec des arguments nommés provoque une erreur :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">divmod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">TypeError</span>: <span class="n">divmod() takes no keyword arguments</span>
</pre></div>
</div>
</section>
</section>
<section id="numbers-and-strings">
<h2><a class="toc-backref" href="#id27">Nombres et chaînes de caractères</a><a class="headerlink" href="#numbers-and-strings" title="Lien permanent vers ce titre">¶</a></h2>
<section id="how-do-i-specify-hexadecimal-and-octal-integers">
<h3><a class="toc-backref" href="#id28">Comment écrire des entiers hexadécimaux ou octaux ?</a><a class="headerlink" href="#how-do-i-specify-hexadecimal-and-octal-integers" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour écrire un entier octal, faites précéder la valeur octale par un zéro, puis un &quot;o&quot; majuscule ou minuscule. Par exemple pour affecter la valeur octale &quot;10&quot; (8 en décimal) à la variable &quot;a&quot;, tapez :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mo">0o10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">8</span>
</pre></div>
</div>
<p>L'hexadécimal est tout aussi simple, faites précéder le nombre hexadécimal par un zéro, puis un &quot;x&quot; majuscule ou minuscule. Les nombres hexadécimaux peuvent être écrits en majuscules ou en minuscules. Par exemple, dans l'interpréteur Python :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mh">0xa5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">165</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mh">0XB2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">178</span>
</pre></div>
</div>
</section>
<section id="why-does-22-10-return-3">
<h3><a class="toc-backref" href="#id29">Pourquoi <code class="docutils literal notranslate"><span class="pre">-22</span> <span class="pre">//</span> <span class="pre">10</span></code> donne-t-il <code class="docutils literal notranslate"><span class="pre">-3</span></code> ?</a><a class="headerlink" href="#why-does-22-10-return-3" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cela est principalement dû à la volonté que <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">%</span> <span class="pre">j</span></code> ait le même signe que j. Si vous voulez en plus que :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
</pre></div>
</div>
<p>alors la division entière doit renvoyer l'entier inférieur. Le C impose également que cette égalité soit vérifiée, et donc les compilateurs qui tronquent <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">//</span> <span class="pre">j</span></code> ont besoin que <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">%</span> <span class="pre">j</span></code> ait le même signe que <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
<p>Il y a peu de cas d'utilisation réels pour <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">%</span> <span class="pre">j</span></code> quand <code class="docutils literal notranslate"><span class="pre">j</span></code> est négatif. Quand <code class="docutils literal notranslate"><span class="pre">j</span></code> est positif, il y en a beaucoup, et dans pratiquement tous, il est plus utile que <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">%</span> <span class="pre">j</span></code> soit <code class="docutils literal notranslate"><span class="pre">&gt;=0</span></code>.  Si l'horloge affiche 10 h maintenant, qu'affichait-elle il y a 200 heures ? <code class="docutils literal notranslate"><span class="pre">-190</span> <span class="pre">%</span> <span class="pre">12</span> <span class="pre">==</span> <span class="pre">2</span></code> est utile ; <code class="docutils literal notranslate"><span class="pre">-190</span> <span class="pre">%</span> <span class="pre">12</span> <span class="pre">==</span> <span class="pre">-10</span></code> est un bogue en puissance.</p>
</section>
<section id="how-do-i-get-int-literal-attribute-instead-of-syntaxerror">
<h3><a class="toc-backref" href="#id30">Pourquoi ai-je une erreur de syntaxe en essayant de lire un attribut d'un entier littéral ?</a><a class="headerlink" href="#how-do-i-get-int-literal-attribute-instead-of-syntaxerror" title="Lien permanent vers ce titre">¶</a></h3>
<p>Essayer d'utiliser l'opérateur d'accès à un attribut sur un entier littéral lève une <a class="reference internal" href="../library/exceptions.html#SyntaxError" title="SyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxError</span></code></a> car le point est compris comme un séparateur décimal en notation anglo-saxonne :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">1.</span><span class="vm">__class__</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>
<span class="gr">  1.__class__</span>
<span class="gr">   ^</span>
<span class="gr">SyntaxError</span>: <span class="n">invalid decimal literal</span>
</pre></div>
</div>
<p>Il faut séparer l'entier du point, soit avec une espace, soit avec des parenthèses.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span> <span class="o">.</span><span class="vm">__class__</span>
<span class="go">&lt;class &#39;int&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="vm">__class__</span>
<span class="go">&lt;class &#39;int&#39;&gt;</span>
</pre></div>
</div>
</section>
<section id="how-do-i-convert-a-string-to-a-number">
<h3><a class="toc-backref" href="#id31">Comment convertir une chaîne de caractères en nombre ?</a><a class="headerlink" href="#how-do-i-convert-a-string-to-a-number" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour les entiers, utilisez le constructeur natif de <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a>, par exemple <code class="docutils literal notranslate"><span class="pre">int('144')</span> <span class="pre">==</span> <span class="pre">144</span></code>. De façon similaire, <a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-func docutils literal notranslate"><span class="pre">float()</span></code></a> donne la valeur flottante, par exemple <code class="docutils literal notranslate"><span class="pre">float('144')</span> <span class="pre">==</span> <span class="pre">144.0</span></code>.</p>
<p>Par défaut, ces fonctions interprètent les nombres comme des décimaux, de telle façon que <code class="docutils literal notranslate"><span class="pre">int('0144')</span> <span class="pre">==</span> <span class="pre">144</span></code> et <code class="docutils literal notranslate"><span class="pre">int('0x144')</span></code> lève une <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>. Le second argument (optionnel) de <code class="docutils literal notranslate"><span class="pre">int(string,</span> <span class="pre">base)</span></code> est la base dans laquelle convertir, donc <code class="docutils literal notranslate"><span class="pre">int('0x144',</span> <span class="pre">16)</span> <span class="pre">==</span> <span class="pre">324</span></code>. Si la base donnée est 0, le nombre est interprété selon les règles Python : un préfixe <code class="docutils literal notranslate"><span class="pre">0o</span></code> indique de l'octal et <code class="docutils literal notranslate"><span class="pre">0x</span></code> indique de l'hexadécimal.</p>
<p>N'utilisez pas la fonction native <a class="reference internal" href="../library/functions.html#eval" title="eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> pour convertir des chaînes de caractères en nombres. <a class="reference internal" href="../library/functions.html#eval" title="eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> est beaucoup plus lente et pose des problèmes de sécurité : quelqu'un pourrait vous envoyer une expression Python pouvant avoir des effets de bord indésirables. Par exemple, quelqu'un pourrait passer <code class="docutils literal notranslate"><span class="pre">__import__('os').system(&quot;rm</span> <span class="pre">-rf</span> <span class="pre">$HOME&quot;)</span></code> ce qui effacerait votre répertoire personnel.</p>
<p><a class="reference internal" href="../library/functions.html#eval" title="eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> a aussi pour effet d'interpréter les nombres comme des expressions Python. Ainsi <code class="docutils literal notranslate"><span class="pre">eval('09')</span></code> produit une erreur de syntaxe, parce que Python ne permet pas les '0' en tête d'un nombre décimal (à l'exception du nombre '0').</p>
</section>
<section id="how-do-i-convert-a-number-to-a-string">
<h3><a class="toc-backref" href="#id32">Comment convertir un nombre en chaîne de caractères ?</a><a class="headerlink" href="#how-do-i-convert-a-number-to-a-string" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour transformer, par exemple, le nombre <code class="docutils literal notranslate"><span class="pre">144</span></code> en la chaîne de caractères <code class="docutils literal notranslate"><span class="pre">'144'</span></code>, il faut utiliser la fonction native <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-func docutils literal notranslate"><span class="pre">str()</span></code></a>. Pour obtenir la représentation hexadécimale ou octale, il faut utiliser les fonctions natives <a class="reference internal" href="../library/functions.html#hex" title="hex"><code class="xref py py-func docutils literal notranslate"><span class="pre">hex()</span></code></a> ou <a class="reference internal" href="../library/functions.html#oct" title="oct"><code class="xref py py-func docutils literal notranslate"><span class="pre">oct()</span></code></a>. Pour des représentations non-conventionnelles, se référer aux sections <a class="reference internal" href="../reference/lexical_analysis.html#f-strings"><span class="std std-ref">Chaînes de caractères littérales formatées</span></a> et <a class="reference internal" href="../library/string.html#formatstrings"><span class="std std-ref">Syntaxe de formatage de chaîne</span></a>, par exemple <code class="docutils literal notranslate"><span class="pre">&quot;{:04d}&quot;.format(144)</span></code> produit <code class="docutils literal notranslate"><span class="pre">'0144'</span></code> et <code class="docutils literal notranslate"><span class="pre">&quot;{:.3f}&quot;.format(1.0/3.0)</span></code> produit <code class="docutils literal notranslate"><span class="pre">'0.333'</span></code>.</p>
</section>
<section id="how-do-i-modify-a-string-in-place">
<h3><a class="toc-backref" href="#id33">Comment modifier une chaîne de caractères « sur place » ?</a><a class="headerlink" href="#how-do-i-modify-a-string-in-place" title="Lien permanent vers ce titre">¶</a></h3>
<p>C'est impossible car les chaînes de caractères sont immuables. Dans la plupart des cas, il faut tout simplement construire une nouvelle chaîne à partir des morceaux de l'ancienne. Si toutefois vous avez besoin d'un objet capable de modifier de la donnée Unicode « sur place », essayez d'utiliser un objet <a class="reference internal" href="../library/io.html#io.StringIO" title="io.StringIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.StringIO</span></code></a> ou le module <a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal notranslate"><span class="pre">array</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">io</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;Hello, world&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="go">&#39;Hello, world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;there!&quot;</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="go">&#39;Hello, there!&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">array(&#39;u&#39;, &#39;Hello, world&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">array(&#39;u&#39;, &#39;yello, world&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">tounicode</span><span class="p">()</span>
<span class="go">&#39;yello, world&#39;</span>
</pre></div>
</div>
</section>
<section id="how-do-i-use-strings-to-call-functions-methods">
<h3><a class="toc-backref" href="#id34">Comment utiliser des chaînes de caractères pour appeler des fonctions/méthodes ?</a><a class="headerlink" href="#how-do-i-use-strings-to-call-functions-methods" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il y a plusieurs façons de faire.</p>
<ul>
<li><p>La meilleure est d'utiliser un dictionnaire qui fait correspondre les chaînes de caractères à des fonctions. Le principal avantage de cette technique est que les chaînes n'ont pas besoin d'être égales aux noms de fonctions. C'est aussi la façon principale d'imiter la construction &quot;case&quot; :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">a</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">b</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="n">dispatch</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;go&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span>  <span class="c1"># Note lack of parens for funcs</span>

<span class="n">dispatch</span><span class="p">[</span><span class="n">get_input</span><span class="p">()]()</span>  <span class="c1"># Note trailing parens to call function</span>
</pre></div>
</div>
</li>
<li><p>Utiliser la fonction <a class="reference internal" href="../library/functions.html#getattr" title="getattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">foo</span>
<span class="nb">getattr</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)()</span>
</pre></div>
</div>
<p>Notez que <a class="reference internal" href="../library/functions.html#getattr" title="getattr"><code class="xref py py-func docutils literal notranslate"><span class="pre">getattr()</span></code></a> marche sur n'importe quel objet, ceci inclut les classes, les instances de classes, les modules et ainsi de suite.</p>
<p>Ceci est utilisé à plusieurs reprises dans la bibliothèque standard, de cette façon :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">do_foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">do_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">foo_instance</span><span class="p">,</span> <span class="s1">&#39;do_&#39;</span> <span class="o">+</span> <span class="n">opname</span><span class="p">)</span>
<span class="n">f</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Utilisez <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> pour résoudre le nom de la fonction :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">myFunc</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;myFunc&quot;</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()[</span><span class="n">fname</span><span class="p">]</span>
<span class="n">f</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="is-there-an-equivalent-to-perl-s-chomp-for-removing-trailing-newlines-from-strings">
<h3><a class="toc-backref" href="#id35">Existe-t-il un équivalent à la fonction <code class="docutils literal notranslate"><span class="pre">chomp()</span></code> de Perl, pour retirer les caractères de fin de ligne d'une chaîne de caractères ?</a><a class="headerlink" href="#is-there-an-equivalent-to-perl-s-chomp-for-removing-trailing-newlines-from-strings" title="Lien permanent vers ce titre">¶</a></h3>
<p>Vous pouvez utiliser <code class="docutils literal notranslate"><span class="pre">S.rstrip(&quot;\r\n&quot;)</span></code> pour retirer toutes les occurrences de tout marqueur de fin de ligne à la fin d'une chaîne de caractère <code class="docutils literal notranslate"><span class="pre">S</span></code>, sans en enlever aucune espace. Si la chaîne <code class="docutils literal notranslate"><span class="pre">S</span></code> représente plus d'une ligne, avec plusieurs lignes vides, les marqueurs de fin de ligne de chaque ligne vide seront retirés :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lines</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;line 1 </span><span class="se">\r\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>         <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>         <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lines</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\r</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&#39;line 1 &#39;</span>
</pre></div>
</div>
<p>Vu que cela ne sert presque qu'à lire un texte ligne à ligne, utiliser <code class="docutils literal notranslate"><span class="pre">S.rstrip()</span></code> de cette manière fonctionne correctement.</p>
</section>
<section id="is-there-a-scanf-or-sscanf-equivalent">
<h3><a class="toc-backref" href="#id36">Existe-t-il un équivalent à <code class="docutils literal notranslate"><span class="pre">scanf()</span></code> ou <code class="docutils literal notranslate"><span class="pre">sscanf()</span></code> ?</a><a class="headerlink" href="#is-there-a-scanf-or-sscanf-equivalent" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pas exactement.</p>
<p>Pour une simple analyse de chaîne, l'approche la plus simple est généralement de découper la ligne en mots délimités par des espaces, en utilisant la méthode <a class="reference internal" href="../library/stdtypes.html#str.split" title="str.split"><code class="xref py py-meth docutils literal notranslate"><span class="pre">split()</span></code></a> des objets chaîne de caractères, et ensuite de convertir les chaînes de décimaux en valeurs numériques en utilisant la fonction <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a> ou <a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-func docutils literal notranslate"><span class="pre">float()</span></code></a>. <code class="xref py py-meth docutils literal notranslate"><span class="pre">split()</span></code> possède un paramètre optionnel &quot;sep&quot; qui est utile si la ligne utilise autre chose que des espaces comme séparateurs.</p>
<p>Pour des analyses plus compliquées, les expressions rationnelles sont plus puissantes que la fonction <code class="docutils literal notranslate"><span class="pre">sscanf</span></code> de C et mieux adaptées à la tâche.</p>
</section>
<section id="what-does-unicodedecodeerror-or-unicodeencodeerror-error-mean">
<h3><a class="toc-backref" href="#id37">Que signifient les erreurs <code class="docutils literal notranslate"><span class="pre">UnicodeDecodeError</span></code> ou <code class="docutils literal notranslate"><span class="pre">UnicodeEncodeError</span></code> ?</a><a class="headerlink" href="#what-does-unicodedecodeerror-or-unicodeencodeerror-error-mean" title="Lien permanent vers ce titre">¶</a></h3>
<p>Voir <a class="reference internal" href="../howto/unicode.html#unicode-howto"><span class="std std-ref">Guide Unicode</span></a>.</p>
</section>
<section id="can-i-end-a-raw-string-with-an-odd-number-of-backslashes">
<span id="faq-programming-raw-string-backslash"></span><h3><a class="toc-backref" href="#id38">Can I end a raw string with an odd number of backslashes?</a><a class="headerlink" href="#can-i-end-a-raw-string-with-an-odd-number-of-backslashes" title="Lien permanent vers ce titre">¶</a></h3>
<p>A raw string ending with an odd number of backslashes will escape the string's quote:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="sa">r</span><span class="s1">&#39;C:\this\will\not\work</span><span class="se">\&#39;</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>
<span class="w">    </span><span class="sa">r</span><span class="s1">&#39;C:\this\will\not\work</span><span class="se">\&#39;</span>
<span class="w">         </span><span class="pm">^</span>
<span class="gr">SyntaxError</span>: <span class="n">unterminated string literal (detected at line 1)</span>
</pre></div>
</div>
<p>There are several workarounds for this. One is to use regular strings and double
the backslashes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">this</span><span class="se">\\</span><span class="s1">will</span><span class="se">\\</span><span class="s1">work</span><span class="se">\\</span><span class="s1">&#39;</span>
<span class="go">&#39;C:\\this\\will\\work\\&#39;</span>
</pre></div>
</div>
<p>Another is to concatenate a regular string containing an escaped backslash to the
raw string:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="sa">r</span><span class="s1">&#39;C:\this\will\work&#39;</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span>
<span class="go">&#39;C:\\this\\will\\work\\&#39;</span>
</pre></div>
</div>
<p>It is also possible to use <a class="reference internal" href="../library/os.path.html#os.path.join" title="os.path.join"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.path.join()</span></code></a> to append a backslash on Windows:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\this\will\work&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">&#39;C:\\this\\will\\work\\&#39;</span>
</pre></div>
</div>
<p>Note that while a backslash will &quot;escape&quot; a quote for the purposes of
determining where the raw string ends, no escaping occurs when interpreting the
value of the raw string. That is, the backslash remains present in the value of
the raw string:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="sa">r</span><span class="s1">&#39;backslash</span><span class="se">\&#39;</span><span class="s1">preserved&#39;</span>
<span class="go">&quot;backslash\\&#39;preserved&quot;</span>
</pre></div>
</div>
<p>Also see the specification in the <a class="reference internal" href="../reference/lexical_analysis.html#strings"><span class="std std-ref">language reference</span></a>.</p>
</section>
</section>
<section id="performance">
<h2><a class="toc-backref" href="#id39">Performances</a><a class="headerlink" href="#performance" title="Lien permanent vers ce titre">¶</a></h2>
<section id="my-program-is-too-slow-how-do-i-speed-it-up">
<h3><a class="toc-backref" href="#id40">Mon programme est trop lent. Comment l'accélérer ?</a><a class="headerlink" href="#my-program-is-too-slow-how-do-i-speed-it-up" title="Lien permanent vers ce titre">¶</a></h3>
<p>Question difficile en général. Il faut garder en tête les points suivants avant d'aller plus loin :</p>
<ul class="simple">
<li><p>Les performances varient en fonction des implémentations de Python. Cette FAQ ne traite que de <a class="reference internal" href="../glossary.html#term-CPython"><span class="xref std std-term">CPython</span></a>.</p></li>
<li><p>Les comportements peuvent différer d'un système d'exploitation à l'autre, tout particulièrement quand il s'agit d'entrée/sortie ou de fils d'exécution multiples.</p></li>
<li><p>Il faut toujours essayer de trouver où sont les points de contention d'un programme <em>avant</em> d'essayer d'optimiser du code (voir le module <a class="reference internal" href="../library/profile.html#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a>).</p></li>
<li><p>Écrire des scripts d'évaluation de performances permet de progresser rapidement dans la recherche d'améliorations (voir le module <a class="reference internal" href="../library/timeit.html#module-timeit" title="timeit: Measure the execution time of small code snippets."><code class="xref py py-mod docutils literal notranslate"><span class="pre">timeit</span></code></a>).</p></li>
<li><p>Il est très fortement recommandé d'avoir une bonne couverture de code (avec des tests unitaires ou autre) avant d'ajouter des erreurs dans des optimisations sophistiquées.</p></li>
</ul>
<p>Ceci étant dit, il y a beaucoup d'astuces pour accélérer du code Python. Voici quelques principes généraux qui peuvent aider à atteindre des niveaux de performance satisfaisants :</p>
<ul class="simple">
<li><p>Améliorer les algorithmes (ou en changer pour des plus performants) peut produire de bien meilleurs résultats que d'optimiser çà et là de petites portions du code.</p></li>
<li><p>Utiliser les structures de données adaptées. Se référer à la documentation des <a class="reference internal" href="../library/stdtypes.html#bltin-types"><span class="std std-ref">Types natifs</span></a> et du module <a class="reference internal" href="../library/collections.html#module-collections" title="collections: Container datatypes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">collections</span></code></a>.</p></li>
<li><p>Quand la bibliothèque standard fournit une implémentation pour quelque chose, il y a de fortes chances (même si ce n'est pas systématique) que cette implémentation soit plus rapide que la vôtre. C'est d'autant plus vrai pour les routines écrites en C, comme les routines natives et certaines extensions de types. Par exemple, il faut utiliser la méthode native <a class="reference internal" href="../library/stdtypes.html#list.sort" title="list.sort"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list.sort()</span></code></a> ou la fonction <a class="reference internal" href="../library/functions.html#sorted" title="sorted"><code class="xref py py-func docutils literal notranslate"><span class="pre">sorted()</span></code></a> similaire pour classer (et se référer à la section <a class="reference internal" href="../howto/sorting.html#sortinghowto"><span class="std std-ref">Guide pour le tri</span></a> pour des exemples d'utilisation courante).</p></li>
<li><p>Les abstractions ont tendance à créer des indirections et obligent l'interpréteur à faire plus d'efforts. Si le niveau d'indirection dépasse la quantité de travail effectif, le programme sera ralenti. Il faut toujours éviter trop d'indirections, en particulier sous la forme de fonctions ou méthodes trop petites (qui nuisent aussi souvent à la clarté du code).</p></li>
</ul>
<p>Si vous atteignez les limites de ce que du Python « pur » permet de faire, il y a des outils qui permettent d'aller plus loin. Par exemple, <a class="reference external" href="https://cython.org">Cython</a> peut compiler une version légèrement modifiée de code Python en une extension C et est disponible sur de nombreuses plate-formes. Cython peut bénéficier de la compilation (et de l'annotation, optionnelle, des types) pour rendre votre code beaucoup plus rapide que s'il était interprété. Si vous avez confiance en vos capacités de programmation en C, vous pouvez aussi <a class="reference internal" href="../extending/index.html#extending-index"><span class="std std-ref">écrire un module d'extension en C</span></a> vous-même.</p>
<div class="admonition seealso">
<p class="admonition-title">Voir aussi</p>
<p>La page wiki dédiée aux <a class="reference external" href="https://wiki.python.org/moin/PythonSpeed/PerformanceTips">astuces de performance</a>.</p>
</div>
</section>
<section id="what-is-the-most-efficient-way-to-concatenate-many-strings-together">
<span id="efficient-string-concatenation"></span><h3><a class="toc-backref" href="#id41">Quelle est la manière la plus efficace de concaténer un grand nombre de chaînes de caractères ?</a><a class="headerlink" href="#what-is-the-most-efficient-way-to-concatenate-many-strings-together" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les objets <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> et <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> sont immuables, par conséquent concaténer un grand nombre de chaînes de caractères entre elles n'est pas très efficace car chaque concaténation crée un nouvel objet. Dans le cas général, la complexité est quadratique par rapport à la taille totale de la chaîne.</p>
<p>Pour mettre bout à bout un grand nombre d'objets <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, la technique recommandée consiste à toutes les mettre dans une liste et appeler la méthode <a class="reference internal" href="../library/stdtypes.html#str.join" title="str.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">str.join()</span></code></a> à la fin :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">my_strings</span><span class="p">:</span>
    <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
</pre></div>
</div>
<p>(une autre technique relativement efficace consiste à utiliser <a class="reference internal" href="../library/io.html#io.StringIO" title="io.StringIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.StringIO</span></code></a>)</p>
<p>Pour concaténer un grand nombre d'objets <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a>, la technique recommandée consiste à étendre un objet <a class="reference internal" href="../library/stdtypes.html#bytearray" title="bytearray"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytearray</span></code></a> en utilisant la concaténation en-place (l'opérateur <code class="docutils literal notranslate"><span class="pre">+=</span></code>) :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">my_bytes_objects</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">+=</span> <span class="n">b</span>
</pre></div>
</div>
</section>
</section>
<section id="sequences-tuples-lists">
<h2><a class="toc-backref" href="#id42">Séquences (<em>n</em>-uplets / listes)</a><a class="headerlink" href="#sequences-tuples-lists" title="Lien permanent vers ce titre">¶</a></h2>
<section id="how-do-i-convert-between-tuples-and-lists">
<h3><a class="toc-backref" href="#id43">Comment convertir les listes en <em>n</em>-uplets et inversement ?</a><a class="headerlink" href="#how-do-i-convert-between-tuples-and-lists" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le constructeur de type <code class="docutils literal notranslate"><span class="pre">tuple(seq)</span></code> convertit toute séquence (plus précisément, tout itérable) en un <em>n</em>-uplet avec les mêmes éléments dans le même ordre.</p>
<p>Par exemple <code class="docutils literal notranslate"><span class="pre">tuple([1,</span> <span class="pre">2,</span> <span class="pre">3])</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">3)</span></code> et <code class="docutils literal notranslate"><span class="pre">tuple('abc')</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">('a',</span> <span class="pre">'b',</span> <span class="pre">'c')</span></code>. Si l'argument est un <em>n</em>-uplet, cela ne crée pas de copie, mais renvoie le même objet, ce qui fait de <a class="reference internal" href="../library/stdtypes.html#tuple" title="tuple"><code class="xref py py-func docutils literal notranslate"><span class="pre">tuple()</span></code></a> une fonction économique à appeler quand vous ne savez pas si votre objet est déjà un <em>n</em>-uplet.</p>
<p>Le constructeur de type <code class="docutils literal notranslate"><span class="pre">list(seq)</span></code> convertit toute séquence ou itérable en liste contenant les mêmes éléments dans le même ordre. Par exemple, <code class="docutils literal notranslate"><span class="pre">list((1,2,3))</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">[1,2,3]</span></code> et <code class="docutils literal notranslate"><span class="pre">list('abc')</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">['a','b','c']</span></code>. Si l'argument est une liste, il renvoie une copie, de la même façon que <code class="docutils literal notranslate"><span class="pre">seq[:]</span></code>.</p>
</section>
<section id="what-s-a-negative-index">
<h3><a class="toc-backref" href="#id44">Qu'est-ce qu'un indice négatif ?</a><a class="headerlink" href="#what-s-a-negative-index" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les séquences Python sont indicées avec des nombres positifs aussi bien que négatifs. Pour les nombres positifs, 0 est le premier indice, 1 est le deuxième, et ainsi de suite. Pour les indices négatifs, <code class="docutils literal notranslate"><span class="pre">-1</span></code> est le dernier indice, <code class="docutils literal notranslate"><span class="pre">-2</span></code> est le pénultième (avant-dernier), et ainsi de suite. On peut aussi dire que <code class="docutils literal notranslate"><span class="pre">seq[-n]</span></code> est équivalent à <code class="docutils literal notranslate"><span class="pre">seq[len(seq)-n]</span></code>.</p>
<p>Utiliser des indices négatifs peut être très pratique. Par exemple <code class="docutils literal notranslate"><span class="pre">S[:-1]</span></code> représente la chaîne tout entière à l'exception du dernier caractère, ce qui est pratique pour retirer un caractère de fin de ligne à la fin d'une chaîne.</p>
</section>
<section id="how-do-i-iterate-over-a-sequence-in-reverse-order">
<h3><a class="toc-backref" href="#id45">Comment itérer à rebours sur une séquence ?</a><a class="headerlink" href="#how-do-i-iterate-over-a-sequence-in-reverse-order" title="Lien permanent vers ce titre">¶</a></h3>
<p>Utilisez la fonction native <a class="reference internal" href="../library/functions.html#reversed" title="reversed"><code class="xref py py-func docutils literal notranslate"><span class="pre">reversed()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="o">...</span>  <span class="c1"># do something with x ...</span>
</pre></div>
</div>
<p>Cela ne modifie pas la séquence initiale, mais construit à la place une copie en ordre inverse pour itérer dessus.</p>
</section>
<section id="how-do-you-remove-duplicates-from-a-list">
<h3><a class="toc-backref" href="#id46">Comment retirer les doublons d'une liste ?</a><a class="headerlink" href="#how-do-you-remove-duplicates-from-a-list" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lisez le « livre de recettes » Python pour trouver une longue discussion sur les nombreuses approches possibles :</p>
<blockquote>
<div><p><a class="reference external" href="https://code.activestate.com/recipes/52560/">https://code.activestate.com/recipes/52560/</a></p>
</div></blockquote>
<p>Si changer l'ordre de la liste ne vous dérange pas, commencez par ordonner celle-ci, puis parcourez-la d'un bout à l'autre, en supprimant les doublons trouvés en chemin :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">mylist</span><span class="p">:</span>
    <span class="n">mylist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">last</span> <span class="o">==</span> <span class="n">mylist</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">del</span> <span class="n">mylist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p>Si tous les éléments de la liste peuvent être utilisés comme des clés de dictionnaire (c'est-à-dire, qu'elles sont toutes <a class="reference internal" href="../glossary.html#term-hashable"><span class="xref std std-term">hachables</span></a>) ceci est souvent plus rapide</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mylist</span><span class="p">))</span>
</pre></div>
</div>
<p>Ceci convertit la liste en un ensemble, ce qui supprime automatiquement les doublons, puis la transforme à nouveau en liste.</p>
</section>
<section id="how-do-you-remove-multiple-items-from-a-list">
<h3><a class="toc-backref" href="#id47">Comment retirer les doublons d'une liste</a><a class="headerlink" href="#how-do-you-remove-multiple-items-from-a-list" title="Lien permanent vers ce titre">¶</a></h3>
<p>Comme pour supprimer les doublons, il est possible d’itérer explicitement à l’envers avec une condition de suppression. Cependant, il est plus facile et plus rapide d’utiliser le remplacement des tranches par une itération avant, implicite ou explicite. Voici trois variantes :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">keep_function</span><span class="p">,</span> <span class="n">mylist</span><span class="p">)</span>
<span class="n">mylist</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mylist</span> <span class="k">if</span> <span class="n">keep_condition</span><span class="p">)</span>
<span class="n">mylist</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mylist</span> <span class="k">if</span> <span class="n">keep_condition</span><span class="p">]</span>
</pre></div>
</div>
<p>La liste en compréhension est peut-être la plus rapide :</p>
</section>
<section id="how-do-you-make-an-array-in-python">
<h3><a class="toc-backref" href="#id48">Comment construire un tableau en Python ?</a><a class="headerlink" href="#how-do-you-make-an-array-in-python" title="Lien permanent vers ce titre">¶</a></h3>
<p>Utilisez une liste :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s2">&quot;this&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;is&quot;</span><span class="p">,</span> <span class="s2">&quot;an&quot;</span><span class="p">,</span> <span class="s2">&quot;array&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Les listes ont un coût équivalent à celui des tableaux C ou Pascal ; la principale différence est qu'une liste Python peut contenir des objets de différents types.</p>
<p>Le module <code class="docutils literal notranslate"><span class="pre">array</span></code> fournit des méthodes pour créer des tableaux de types fixes dans une représentation compacte, mais ils sont plus lents à indexer que les listes. Notez aussi que <a class="reference external" href="https://numpy.org/">NumPy</a> (et d'autres) fournissent différentes structures de type tableaux, avec des caractéristiques différentes.</p>
<p>Pour obtenir des listes chaînées à la sauce Lisp, vous pouvez émuler les <em>cons cells</em> en utilisant des <em>n</em>-uplets :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">lisp_list</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;like&quot;</span><span class="p">,</span>  <span class="p">(</span><span class="s2">&quot;this&quot;</span><span class="p">,</span>  <span class="p">(</span><span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>Si vous voulez pouvoir modifier les éléments, utilisez une liste plutôt qu'un <em>n</em>-uplet. Ici la version équivalente du <em>car</em> de Lisp est <code class="docutils literal notranslate"><span class="pre">lisp_list[0]</span></code> et l'équivalent de <em>cdr</em> est <code class="docutils literal notranslate"><span class="pre">lisp_list[1]</span></code>. Ne faites ceci que si vous êtes réellement sûr d'en avoir besoin, cette méthode est en général bien plus lente que les listes Python.</p>
</section>
<section id="how-do-i-create-a-multidimensional-list">
<span id="faq-multidimensional-list"></span><h3><a class="toc-backref" href="#id49">Comment créer une liste à plusieurs dimensions ?</a><a class="headerlink" href="#how-do-i-create-a-multidimensional-list" title="Lien permanent vers ce titre">¶</a></h3>
<p>Vous avez probablement essayé de créer une liste à plusieurs dimensions de cette façon :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Elle semble correcte si on l'affiche :</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">[[None, None], [None, None], [None, None]]</span>
</pre></div>
</div>
<p>Mais quand vous affectez une valeur, celle-ci apparaît à plusieurs endroits :</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">[[5, None], [5, None], [5, None]]</span>
</pre></div>
</div>
<p>Dupliquer une liste en utilisant <code class="docutils literal notranslate"><span class="pre">*</span></code> ne crée en réalité pas de copie mais seulement des références aux objets existants. Le <code class="docutils literal notranslate"><span class="pre">*3</span></code> crée une liste contenant trois références à la même liste de longueur deux. Un changement dans une colonne apparaîtra donc dans toutes les colonnes, ce qui n'est très probablement pas ce que vous souhaitiez.</p>
<p>L'approche suggérée est d'abord de créer une liste de la longueur désirée, puis de remplir tous les éléments avec une nouvelle chaîne :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Cela génère une liste contenant elle-même trois listes distinctes, de longueur deux. Vous pouvez aussi utiliser la syntaxe des listes en compréhension :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="p">)]</span>
</pre></div>
</div>
<p>Vous pouvez aussi utiliser une extension qui fournit un type matriciel natif ; <a class="reference external" href="https://www.numpy.org/">NumPy</a> est la plus répandue.</p>
</section>
<section id="how-do-i-apply-a-method-or-function-to-a-sequence-of-objects">
<h3><a class="toc-backref" href="#id50">Comment appliquer une méthode ou une fonction à une séquence d'objets ?</a><a class="headerlink" href="#how-do-i-apply-a-method-or-function-to-a-sequence-of-objects" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour appeler une méthode ou une fonction et accumuler les valeurs renvoyées dans une liste, une <a class="reference internal" href="../glossary.html#term-list-comprehension"><span class="xref std std-term">compréhension de liste</span></a> est une solution élégante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">()</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">function</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">]</span>
</pre></div>
</div>
<p>To just run the method or function without saving the return values,
a plain <a class="reference internal" href="../reference/compound_stmts.html#for"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">for</span></code></a> loop will suffice:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">:</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>

<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">:</span>
    <span class="n">function</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="why-does-a-tuple-i-item-raise-an-exception-when-the-addition-works">
<span id="faq-augmented-assignment-tuple-error"></span><h3><a class="toc-backref" href="#id51">Pourquoi <code class="docutils literal notranslate"><span class="pre">a_tuple[i]</span> <span class="pre">+=</span> <span class="pre">['item']</span></code> lève-t-il une exception alors que l'addition fonctionne ?</a><a class="headerlink" href="#why-does-a-tuple-i-item-raise-an-exception-when-the-addition-works" title="Lien permanent vers ce titre">¶</a></h3>
<p>Ceci est dû à la combinaison de deux facteurs : le fait que les opérateurs d'affectation incrémentaux sont des opérateurs d'<em>affectation</em> et à la différence entre les objets muables et immuables en Python.</p>
<p>Cette discussion est valable, en général, quand des opérateurs d'affectation incrémentale sont appliqués aux éléments d'un <em>n</em>-uplet qui pointe sur des objets muables, mais on prendra <code class="docutils literal notranslate"><span class="pre">list</span></code> et <code class="docutils literal notranslate"><span class="pre">+=</span></code> comme exemple.</p>
<p>Si vous écrivez :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">   </span><span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">&#39;tuple&#39; object does not support item assignment</span>
</pre></div>
</div>
<p>La cause de l'exception est claire : <code class="docutils literal notranslate"><span class="pre">1</span></code> est ajouté à l'objet <code class="docutils literal notranslate"><span class="pre">a_tuple[0]</span></code> qui pointe sur (<code class="docutils literal notranslate"><span class="pre">1</span></code>), ce qui produit l'objet résultant <code class="docutils literal notranslate"><span class="pre">2</span></code>, mais, lorsque l'on tente d'affecter le résultat du calcul, <code class="docutils literal notranslate"><span class="pre">2</span></code>, à l'élément <code class="docutils literal notranslate"><span class="pre">0</span></code> du <em>n</em>-uplet, on obtient une erreur car il est impossible de modifier la cible sur laquelle pointe un élément d'un <em>n</em>-uplet.</p>
<p>Sous le capot, une instruction d'affectation incrémentale fait à peu près ceci :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">a_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">&#39;tuple&#39; object does not support item assignment</span>
</pre></div>
</div>
<p>C'est la partie de l'affectation de l'opération qui génère l'erreur, vu qu'un <em>n</em>-uplet est immuable.</p>
<p>Quand vous écrivez un code du style :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a_tuple</span> <span class="o">=</span> <span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">],</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;item&#39;</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">&#39;tuple&#39; object does not support item assignment</span>
</pre></div>
</div>
<p>L'exception est un peu plus surprenante et, chose encore plus étrange, malgré l'erreur, l'ajout a fonctionné :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[&#39;foo&#39;, &#39;item&#39;]</span>
</pre></div>
</div>
<p>To see why this happens, you need to know that (a) if an object implements an
<a class="reference internal" href="../reference/datamodel.html#object.__iadd__" title="object.__iadd__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iadd__()</span></code></a> magic method, it gets called when the <code class="docutils literal notranslate"><span class="pre">+=</span></code> augmented
assignment
is executed, and its return value is what gets used in the assignment statement;
and (b) for lists, <code class="xref py py-meth docutils literal notranslate"><span class="pre">__iadd__()</span></code> is equivalent to calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">extend()</span></code> on the list
and returning the list.  That's why we say that for lists, <code class="docutils literal notranslate"><span class="pre">+=</span></code> is a
&quot;shorthand&quot; for <code class="xref py py-meth docutils literal notranslate"><span class="pre">list.extend()</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span>
<span class="go">[1]</span>
</pre></div>
</div>
<p>C’est équivalent à :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">a_list</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_list</span> <span class="o">=</span> <span class="n">result</span>
</pre></div>
</div>
<p>L'objet sur lequel pointe <code class="docutils literal notranslate"><span class="pre">a_list</span></code> a été modifié et le pointeur vers l'objet modifié est réaffecté à <code class="docutils literal notranslate"><span class="pre">a_list</span></code>. <em>In fine</em>, l'affectation ne change rien, puisque c'est un pointeur vers le même objet que sur lequel pointait <code class="docutils literal notranslate"><span class="pre">a_list</span></code>, mais l'affectation a tout de même lieu.</p>
<p>Donc, dans notre exemple avec un <em>n</em>-uplet, il se passe quelque chose équivalent à :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">a_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">([</span><span class="s1">&#39;item&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">&#39;tuple&#39; object does not support item assignment</span>
</pre></div>
</div>
<p>L'appel à <code class="xref py py-meth docutils literal notranslate"><span class="pre">__iadd__()</span></code> réussit et la liste est étendue, mais bien que <code class="docutils literal notranslate"><span class="pre">result</span></code> pointe sur le même objet que <code class="docutils literal notranslate"><span class="pre">a_tuple[0]</span></code>, l'affectation finale échoue car les <em>n</em>-uplets ne sont pas muables.</p>
</section>
<section id="i-want-to-do-a-complicated-sort-can-you-do-a-schwartzian-transform-in-python">
<h3><a class="toc-backref" href="#id52">Je souhaite faire un classement compliqué : peut-on faire une transformation de Schwartz en Python ?</a><a class="headerlink" href="#i-want-to-do-a-complicated-sort-can-you-do-a-schwartzian-transform-in-python" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette technique, attribuée à Randal Schwartz de la communauté Perl, ordonne les éléments d'une liste à l'aide une transformation qui fait correspondre chaque élément à sa &quot;valeur de tri&quot;. En Python, ceci est géré par l'argument <code class="docutils literal notranslate"><span class="pre">key</span></code> de la méthode <a class="reference internal" href="../library/stdtypes.html#list.sort" title="list.sort"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list.sort()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Isorted</span> <span class="o">=</span> <span class="n">L</span><span class="p">[:]</span>
<span class="n">Isorted</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">]))</span>
</pre></div>
</div>
</section>
<section id="how-can-i-sort-one-list-by-values-from-another-list">
<h3><a class="toc-backref" href="#id53">Comment ordonner une liste en fonction des valeurs d'une autre liste ?</a><a class="headerlink" href="#how-can-i-sort-one-list-by-values-from-another-list" title="Lien permanent vers ce titre">¶</a></h3>
<p>Fusionnez-les dans un itérateur de <em>n</em>-uplets, ordonnez la liste obtenue, puis choisissez l'élément que vous voulez</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">list1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;what&quot;</span><span class="p">,</span> <span class="s2">&quot;I&#39;m&quot;</span><span class="p">,</span> <span class="s2">&quot;sorting&quot;</span><span class="p">,</span> <span class="s2">&quot;by&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;something&quot;</span><span class="p">,</span> <span class="s2">&quot;else&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairs</span>
<span class="go">[(&quot;I&#39;m&quot;, &#39;else&#39;), (&#39;by&#39;, &#39;sort&#39;), (&#39;sorting&#39;, &#39;to&#39;), (&#39;what&#39;, &#39;something&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">[&#39;else&#39;, &#39;sort&#39;, &#39;to&#39;, &#39;something&#39;]</span>
</pre></div>
</div>
</section>
</section>
<section id="objects">
<h2><a class="toc-backref" href="#id54">Objets</a><a class="headerlink" href="#objects" title="Lien permanent vers ce titre">¶</a></h2>
<section id="what-is-a-class">
<h3><a class="toc-backref" href="#id55">Qu'est-ce qu'une classe ?</a><a class="headerlink" href="#what-is-a-class" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une classe est le type d'objet particulier créé par l'exécution d'une déclaration de classe. Les objets de classe sont utilisés comme modèles pour créer des objets, qui incarnent à la fois les données (attributs) et le code (méthodes) spécifiques à un type de données.</p>
<p>Une classe peut être fondée sur une ou plusieurs autres classes, appelée sa (ou ses) classe(s) de base. Elle hérite alors des attributs et des méthodes de ses classes mères. Cela permet à un modèle d'objet d'être successivement raffiné par héritage. Vous pourriez avoir une classe générique <code class="docutils literal notranslate"><span class="pre">Mailbox</span></code>, qui fournit des méthodes d'accès de base pour une boîte aux lettres, et des sous-classes telles que <code class="docutils literal notranslate"><span class="pre">MboxMailbox</span></code>, <code class="docutils literal notranslate"><span class="pre">MaildirMailbox</span></code>, <code class="docutils literal notranslate"><span class="pre">OutlookMailbox</span></code> qui gèrent les plusieurs formats spécifiques de boîtes aux lettres.</p>
</section>
<section id="what-is-a-method">
<h3><a class="toc-backref" href="#id56">Qu'est-ce qu'une méthode ?</a><a class="headerlink" href="#what-is-a-method" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une méthode est une fonction sur un  objet <code class="docutils literal notranslate"><span class="pre">x</span></code> qu'on appelle de manière générale sous la forme <code class="docutils literal notranslate"><span class="pre">x.name(arguments…)</span></code>. Les méthodes sont définies comme des fonctions à l'intérieur de la définition de classe :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">arg</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span>
</pre></div>
</div>
</section>
<section id="what-is-self">
<h3><a class="toc-backref" href="#id57">Qu'est-ce que self ?</a><a class="headerlink" href="#what-is-self" title="Lien permanent vers ce titre">¶</a></h3>
<p>Par convention, le premier argument d'une méthode est appelé self. Une méthode <code class="docutils literal notranslate"><span class="pre">meth(self,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c)</span></code> doit être appelée sous la forme <code class="docutils literal notranslate"><span class="pre">x.meth(a,</span> <span class="pre">b,</span> <span class="pre">c)</span></code> où <code class="docutils literal notranslate"><span class="pre">x</span></code> est une instance de la classe dans laquelle cette méthode est définie ; tout se passe comme si la méthode était appelée comme <code class="docutils literal notranslate"><span class="pre">meth(x,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c)</span></code>.</p>
<p>Voir aussi <a class="reference internal" href="design.html#why-self"><span class="std std-ref">Pourquoi self doit-il être explicitement utilisé dans les définitions et les appels de méthodes ?</span></a>.</p>
</section>
<section id="how-do-i-check-if-an-object-is-an-instance-of-a-given-class-or-of-a-subclass-of-it">
<h3><a class="toc-backref" href="#id58">Comment vérifier si un objet est une instance d'une classe donnée ou d'une sous-classe de celle-ci ?</a><a class="headerlink" href="#how-do-i-check-if-an-object-is-an-instance-of-a-given-class-or-of-a-subclass-of-it" title="Lien permanent vers ce titre">¶</a></h3>
<p>Utilisez la fonction native <a class="reference internal" href="../library/functions.html#isinstance" title="isinstance"><code class="xref py py-func docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">cls)</span></code></a>. Vous pouvez vérifier qu'un objet est une instance de plusieurs classes à la fois en fournissant un <em>n</em>-uplet à la place d'une seule classe, par exemple, <code class="docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">(class1,</span> <span class="pre">class2,</span> <span class="pre">...))</span></code>. Vous pouvez également vérifier qu'un objet est l'un des types natifs de Python, par exemple <code class="docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">str)</span></code> ou <code class="docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">(int,</span> <span class="pre">float,</span> <span class="pre">complex))</span></code>.</p>
<p>Notez que <a class="reference internal" href="../library/functions.html#isinstance" title="isinstance"><code class="xref py py-func docutils literal notranslate"><span class="pre">isinstance()</span></code></a> prend aussi en compte l'héritage virtuel d'une <a class="reference internal" href="../glossary.html#term-abstract-base-class"><span class="xref std std-term">classe mère abstraite</span></a>, c'est à dire qu'elle renvoie <code class="docutils literal notranslate"><span class="pre">True</span></code> pour une classe A enregistrée auprès d'une classe mère abstraite B même si A n'est pas directement ou indirectement une classe fille de B. Pour vérifier l'héritage dans le sens plus restreint, parcourez l'<a class="reference internal" href="../glossary.html#term-MRO"><span class="xref std std-term">ordre de résolution des méthodes</span></a> de la classe :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Mapping</span>

<span class="k">class</span> <span class="nc">P</span><span class="p">:</span>
     <span class="k">pass</span>

<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">Mapping</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>        <span class="c1"># direct</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>        <span class="c1"># indirect</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">)</span>  <span class="c1"># virtual</span>
<span class="go">True</span>

<span class="go"># Actual inheritance chain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="vm">__mro__</span>
<span class="go">(&lt;class &#39;C&#39;&gt;, &lt;class &#39;P&#39;&gt;, &lt;class &#39;object&#39;&gt;)</span>

<span class="go"># Test for &quot;true inheritance&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mapping</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="vm">__mro__</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Notez que la plupart des programmes n'utilisent que rarement <code class="xref py py-func docutils literal notranslate"><span class="pre">isInstance()</span></code> sur les classes définies par l'utilisateur. Si vous développez vous-même des classes, une approche plus orientée-objet consiste définir des méthodes sur les classes qui sont porteuses d'un comportement particulier, plutôt que de vérifier la classe de l'objet et de faire un traitement ad-hoc. Par exemple, si vous avez une fonction qui fait quelque chose :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Mailbox</span><span class="p">):</span>
        <span class="o">...</span>  <span class="c1"># code to search a mailbox</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Document</span><span class="p">):</span>
        <span class="o">...</span>  <span class="c1"># code to search a document</span>
    <span class="k">elif</span> <span class="o">...</span>
</pre></div>
</div>
<p>Une meilleure approche est de définir une méthode <code class="docutils literal notranslate"><span class="pre">search()</span></code> dans toutes les classes et qu'il suffit d'appeler de la manière suivante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Mailbox</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>  <span class="c1"># code to search a mailbox</span>

<span class="k">class</span> <span class="nc">Document</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>  <span class="c1"># code to search a document</span>

<span class="n">obj</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="what-is-delegation">
<h3><a class="toc-backref" href="#id59">Qu'est-ce que la délégation ?</a><a class="headerlink" href="#what-is-delegation" title="Lien permanent vers ce titre">¶</a></h3>
<p>La délégation est une technique orientée objet (aussi appelée « patron de conception). Prenons un objet <code class="docutils literal notranslate"><span class="pre">x</span></code> dont on souhaite modifier le comportement d'une seule de ses méthodes. On peut créer une nouvelle classe qui fournit une nouvelle implémentation de la méthode qui nous intéresse dans l'évolution et qui délègue toute autre méthode à la méthode correspondante de <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>Les programmeurs Python peuvent facilement mettre en œuvre la délégation. Par exemple, la classe suivante implémente une classe qui se comporte comme un fichier, mais convertit toutes les données écrites en majuscules :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">UpperOut</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outfile</span> <span class="o">=</span> <span class="n">outfile</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_outfile</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">UpperOut</span></code> class redefines the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method to convert the
argument string to uppercase before calling the underlying
<code class="docutils literal notranslate"><span class="pre">self._outfile.write()</span></code> method.  All other methods are delegated to the
underlying <code class="docutils literal notranslate"><span class="pre">self._outfile</span></code> object.  The delegation is accomplished via the
<a class="reference internal" href="../reference/datamodel.html#object.__getattr__" title="object.__getattr__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getattr__()</span></code></a> method; consult <a class="reference internal" href="../reference/datamodel.html#attribute-access"><span class="std std-ref">the language reference</span></a>
for more information about controlling attribute access.</p>
<p>Note that for more general cases delegation can get trickier. When attributes
must be set as well as retrieved, the class must define a <a class="reference internal" href="../reference/datamodel.html#object.__setattr__" title="object.__setattr__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__setattr__()</span></code></a>
method too, and it must do so carefully.  The basic implementation of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__setattr__()</span></code> is roughly equivalent to the following:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">X</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Most <code class="xref py py-meth docutils literal notranslate"><span class="pre">__setattr__()</span></code> implementations must modify
<a class="reference internal" href="../library/stdtypes.html#object.__dict__" title="object.__dict__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">self.__dict__</span></code></a> to store
local state for self without causing an infinite recursion.</p>
</section>
<section id="how-do-i-call-a-method-defined-in-a-base-class-from-a-derived-class-that-extends-it">
<h3><a class="toc-backref" href="#id60">Comment appeler une méthode définie dans une classe mère depuis une classe dérivée qui la surcharge ?</a><a class="headerlink" href="#how-do-i-call-a-method-defined-in-a-base-class-from-a-derived-class-that-extends-it" title="Lien permanent vers ce titre">¶</a></h3>
<p>Utilisez la fonction native <a class="reference internal" href="../library/functions.html#super" title="super"><code class="xref py py-func docutils literal notranslate"><span class="pre">super()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Derived</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">meth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">meth</span><span class="p">()</span>  <span class="c1"># calls Base.meth</span>
</pre></div>
</div>
<p>Dans cet exemple, <a class="reference internal" href="../library/functions.html#super" title="super"><code class="xref py py-func docutils literal notranslate"><span class="pre">super()</span></code></a> détermine automatiquement l'instance dont une méthode l'appelle (l'objet <code class="docutils literal notranslate"><span class="pre">self</span></code>), observe l'<a class="reference internal" href="../glossary.html#term-method-resolution-order"><span class="xref std std-term">ordre de résolution des méthodes</span></a> obtenu avec <code class="docutils literal notranslate"><span class="pre">type(self).__mro__</span></code>, et renvoie la classe qui suit <code class="docutils literal notranslate"><span class="pre">Derived</span></code> dans cet ordre, donc <code class="docutils literal notranslate"><span class="pre">Base</span></code>.</p>
</section>
<section id="how-can-i-organize-my-code-to-make-it-easier-to-change-the-base-class">
<h3><a class="toc-backref" href="#id61">Comment organiser un code pour permettre de changer la classe mère plus facilement ?</a><a class="headerlink" href="#how-can-i-organize-my-code-to-make-it-easier-to-change-the-base-class" title="Lien permanent vers ce titre">¶</a></h3>
<p>Vous pouvez définir un alias pour la classe mère et dériver depuis l'alias. Ensuite, tout ce que vous devez changer est la valeur attribuée à cet alias. Accessoirement, cette astuce est également utile pour déterminer dynamiquement (par exemple en fonction de la disponibilité de certaines ressources) la classe mère à utiliser. Exemple :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
    <span class="o">...</span>

<span class="n">BaseAlias</span> <span class="o">=</span> <span class="n">Base</span>

<span class="k">class</span> <span class="nc">Derived</span><span class="p">(</span><span class="n">BaseAlias</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="how-do-i-create-static-class-data-and-static-class-methods">
<h3><a class="toc-backref" href="#id62">Comment créer des données statiques de classe et des méthodes statiques de classe ?</a><a class="headerlink" href="#how-do-i-create-static-class-data-and-static-class-methods" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les données statiques et les méthodes statiques (au sens C++ ou Java) sont prises en charge en Python.</p>
<p>Pour les données statiques, il suffit de définir un attribut de classe. Pour attribuer une nouvelle valeur à l'attribut, vous devez explicitement utiliser le nom de classe dans l'affectation :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c1"># number of times C.__init__ called</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">C</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">getcount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">C</span><span class="o">.</span><span class="n">count</span>  <span class="c1"># or return self.count</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">c.count</span></code> se réfère également à <code class="docutils literal notranslate"><span class="pre">C.count</span></code> pour tout <code class="docutils literal notranslate"><span class="pre">c</span></code> tel que <code class="docutils literal notranslate"><span class="pre">isInstance</span> <span class="pre">(c,</span> <span class="pre">C)</span></code> est vrai, sauf remplacement par <code class="docutils literal notranslate"><span class="pre">c</span></code> lui-même ou par une classe sur le chemin de recherche de classe mère de <code class="docutils literal notranslate"><span class="pre">c.__class__</span></code> jusqu'à <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
<p>Attention : dans une méthode de C, une affectation comme <code class="docutils literal notranslate"><span class="pre">self.count</span> <span class="pre">=</span> <span class="pre">42</span></code> crée une nouvelle instance sans rapport avec le nom <code class="docutils literal notranslate"><span class="pre">count</span></code> dans le dictionnaire de données de <code class="docutils literal notranslate"><span class="pre">self</span></code>. La redéfinition d'une donnée statique de classe doit toujours spécifier la classe, que l'on soit à l'intérieur d'une méthode ou non :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">314</span>
</pre></div>
</div>
<p>Il est possible d'utiliser des méthodes statiques :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">static</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
        <span class="c1"># No &#39;self&#39; parameter!</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Cependant, d'une manière beaucoup plus simple pour obtenir l'effet d'une méthode statique se fait par une simple fonction au niveau du module :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getcount</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">C</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
<p>Si votre code est structuré de manière à définir une classe (ou bien la hiérarchie des classes connexes) par module, ceci fournira l'encapsulation souhaitée.</p>
</section>
<section id="how-can-i-overload-constructors-or-methods-in-python">
<h3><a class="toc-backref" href="#id63">Comment surcharger les constructeurs (ou méthodes) en Python ?</a><a class="headerlink" href="#how-can-i-overload-constructors-or-methods-in-python" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette réponse s'applique en fait à toutes les méthodes, mais la question se pose généralement dans le contexte des constructeurs.</p>
<p>En C++, on écrirait</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">C</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;No arguments</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">C</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Argument is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>En Python, vous devez écrire un constructeur unique qui considère tous les cas en utilisant des arguments par défaut. Par exemple :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No arguments&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Argument is&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>Ce n'est pas tout à fait équivalent, mais suffisamment proche dans la pratique.</p>
<p>Vous pouvez aussi utiliser une liste d'arguments de longueur variable, par exemple</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>La même approche fonctionne pour toutes les définitions de méthode.</p>
</section>
<section id="i-try-to-use-spam-and-i-get-an-error-about-someclassname-spam">
<h3><a class="toc-backref" href="#id64">J'essaie d'utiliser <code class="docutils literal notranslate"><span class="pre">__spam</span></code> et j'obtiens une erreur à propos de <code class="docutils literal notranslate"><span class="pre">_SomeClassName__spam</span></code>.</a><a class="headerlink" href="#i-try-to-use-spam-and-i-get-an-error-about-someclassname-spam" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les noms de variables commençant avec deux tirets bas sont « déformés », c'est un moyen simple mais efficace de définir des variables privées à une classe. Tout identifiant de la forme <code class="docutils literal notranslate"><span class="pre">__spam</span></code> (commençant par au moins deux tirets bas et se terminant par au plus un tiret bas) est textuellement remplacé par <code class="docutils literal notranslate"><span class="pre">_classname__spam</span></code>, où <code class="docutils literal notranslate"><span class="pre">classname</span></code> est le nom de la classe en cours sans les éventuels tirets bas du début.</p>
<p>Cela ne garantit aucune protection : un utilisateur extérieur peut encore délibérément accéder à l'attribut <code class="docutils literal notranslate"><span class="pre">_classname__spam</span></code> et les valeurs privées sont visibles dans l'objet <code class="docutils literal notranslate"><span class="pre">__dict__</span></code>. De nombreux programmeurs Python ne prennent jamais la peine d'utiliser des noms de variable privés.</p>
</section>
<section id="my-class-defines-del-but-it-is-not-called-when-i-delete-the-object">
<h3><a class="toc-backref" href="#id65">Ma classe définit <code class="docutils literal notranslate"><span class="pre">__del__</span></code> mais elle n'est pas appelée lorsque je supprime l'objet.</a><a class="headerlink" href="#my-class-defines-del-but-it-is-not-called-when-i-delete-the-object" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il y a plusieurs explications possibles.</p>
<p>The <a class="reference internal" href="../reference/simple_stmts.html#del"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">del</span></code></a> statement does not necessarily call <a class="reference internal" href="../reference/datamodel.html#object.__del__" title="object.__del__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__del__()</span></code></a> -- it simply
decrements the object's reference count, and if this reaches zero
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__del__()</span></code> is called.</p>
<p>If your data structures contain circular links (e.g. a tree where each child has
a parent reference and each parent has a list of children) the reference counts
will never go back to zero.  Once in a while Python runs an algorithm to detect
such cycles, but the garbage collector might run some time after the last
reference to your data structure vanishes, so your <code class="xref py py-meth docutils literal notranslate"><span class="pre">__del__()</span></code> method may be
called at an inconvenient and random time. This is inconvenient if you're trying
to reproduce a problem. Worse, the order in which object's <code class="xref py py-meth docutils literal notranslate"><span class="pre">__del__()</span></code>
methods are executed is arbitrary.  You can run <a class="reference internal" href="../library/gc.html#gc.collect" title="gc.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code></a> to force a
collection, but there <em>are</em> pathological cases where objects will never be
collected.</p>
<p>Despite the cycle collector, it's still a good idea to define an explicit
<code class="docutils literal notranslate"><span class="pre">close()</span></code> method on objects to be called whenever you're done with them.  The
<code class="docutils literal notranslate"><span class="pre">close()</span></code> method can then remove attributes that refer to subobjects.  Don't
call <code class="xref py py-meth docutils literal notranslate"><span class="pre">__del__()</span></code> directly -- <code class="xref py py-meth docutils literal notranslate"><span class="pre">__del__()</span></code> should call <code class="docutils literal notranslate"><span class="pre">close()</span></code> and
<code class="docutils literal notranslate"><span class="pre">close()</span></code> should make sure that it can be called more than once for the same
object.</p>
<p>Une alternative pour éviter les références cycliques consiste à utiliser le module <a class="reference internal" href="../library/weakref.html#module-weakref" title="weakref: Support for weak references and weak dictionaries."><code class="xref py py-mod docutils literal notranslate"><span class="pre">weakref</span></code></a>, qui permet de faire référence à des objets sans incrémenter leur compteur de références. Par exemple, les structures d'arbres devraient utiliser des références faibles entre pères et fils (si nécessaire !).</p>
<p>Finally, if your <code class="xref py py-meth docutils literal notranslate"><span class="pre">__del__()</span></code> method raises an exception, a warning message
is printed to <a class="reference internal" href="../library/sys.html#sys.stderr" title="sys.stderr"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a>.</p>
</section>
<section id="how-do-i-get-a-list-of-all-instances-of-a-given-class">
<h3><a class="toc-backref" href="#id66">Comment obtenir toutes les instances d'une classe ?</a><a class="headerlink" href="#how-do-i-get-a-list-of-all-instances-of-a-given-class" title="Lien permanent vers ce titre">¶</a></h3>
<p>Python ne tient pas de registre de toutes les instances d'une classe (ni de n'importe quel type natif). Il est cependant possible de programmer le constructeur de la classe de façon à tenir un tel registre, en maintenant une liste de références faibles vers chaque instance.</p>
</section>
<section id="why-does-the-result-of-id-appear-to-be-not-unique">
<h3><a class="toc-backref" href="#id67">Pourquoi le résultat de <code class="docutils literal notranslate"><span class="pre">id()</span></code> peut-il être le même pour deux objets différents ?</a><a class="headerlink" href="#why-does-the-result-of-id-appear-to-be-not-unique" title="Lien permanent vers ce titre">¶</a></h3>
<p>La fonction native <a class="reference internal" href="../library/functions.html#id" title="id"><code class="xref py py-func docutils literal notranslate"><span class="pre">id()</span></code></a> renvoie un entier dont l'unicité est garantie durant toute la vie de l'objet. Vu qu'en CPython cet entier est en réalité l'adresse mémoire de l'objet, il est fréquent qu'un nouvel objet soit alloué à une adresse mémoire identique à celle d'un objet venant d'être supprimé. Comme l'illustre le code suivant :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> 
<span class="go">13901272</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span> 
<span class="go">13901272</span>
</pre></div>
</div>
<p>Les deux identifiants appartiennent à des objets entiers créés juste avant l'appel à <code class="docutils literal notranslate"><span class="pre">id()</span></code> et détruits immédiatement après. Pour s'assurer que les objets dont on veut examiner les identifiants sont toujours en vie, créons une nouvelle référence à l'objet :</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> 
<span class="go">13901272</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> 
<span class="go">13891296</span>
</pre></div>
</div>
</section>
<section id="when-can-i-rely-on-identity-tests-with-the-is-operator">
<h3><a class="toc-backref" href="#id68">Quand puis-je raisonnablement utiliser le test d'identité <em>is</em> ?</a><a class="headerlink" href="#when-can-i-rely-on-identity-tests-with-the-is-operator" title="Lien permanent vers ce titre">¶</a></h3>
<p>L'opérateur <code class="docutils literal notranslate"><span class="pre">is</span></code> détermine si deux objets sont identiques, c'est-à-dire le même objet. Le test <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">is</span> <span class="pre">b</span></code> est équivalent à <code class="docutils literal notranslate"><span class="pre">id(a)</span> <span class="pre">==</span> <span class="pre">id(b)</span></code>.</p>
<p>La propriété la plus importante du test d'identité est qu'un objet est toujours identique à lui-même. Quelle que soit la valeur de <em>a</em>, <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">is</span> <span class="pre">a</span></code> vaut toujours <code class="docutils literal notranslate"><span class="pre">True</span></code>. Un test d'identité est généralement plus rapide qu'un test d'égalité. De plus, contrairement à l'opérateur <code class="docutils literal notranslate"><span class="pre">==</span></code>, l'opérateur <code class="docutils literal notranslate"><span class="pre">is</span></code> renvoie toujours un booléen, <code class="docutils literal notranslate"><span class="pre">True</span></code> ou <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Cependant, les tests d'identité ne peuvent remplacer les tests d'égalité que si l'identité est garantie. C'est le cas dans les trois situations suivantes :</p>
<p>1) Assignments create new names but do not change object identity.  After the
assignment <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">=</span> <span class="pre">old</span></code>, it is guaranteed that <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">is</span> <span class="pre">old</span></code>.</p>
<p>Le stockage d'un objet dans un conteneur qui fonctionne avec des références n'altère pas l'identité. Si <code class="docutils literal notranslate"><span class="pre">s</span></code> est une liste, alors après l'affectation de <em>x</em> à l'indice 0, <code class="docutils literal notranslate"><span class="pre">s[0]</span> <span class="pre">=</span> <span class="pre">x</span></code>, le test <code class="docutils literal notranslate"><span class="pre">s[0]</span> <span class="pre">is</span> <span class="pre">x</span></code> s'évalue forcément à <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>3) If an object is a singleton, it means that only one instance of that object
can exist.  After the assignments <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">None</span></code>, it is
guaranteed that <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">is</span> <span class="pre">b</span></code> because <code class="docutils literal notranslate"><span class="pre">None</span></code> is a singleton.</p>
<p>Dans la plupart des autres cas, un test d'identité n'est pas approprié par rapport à un test d'égalité. En particulier, il ne faut pas utiliser <code class="docutils literal notranslate"><span class="pre">is</span></code> pour comparer à des constantes comme les entiers (type <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) ou des chaînes de caractères (type <a class="reference internal" href="../library/stdtypes.html#str" title="str"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) car ces valeurs ne sont pas nécessairement des singletons :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="ow">is</span> <span class="n">c</span>
<span class="go">False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;Python&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;Py&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="s1">&#39;thon&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="ow">is</span> <span class="n">c</span>
<span class="go">False</span>
</pre></div>
</div>
<p>De même, deux instances fraîchement créées d'un type de conteneurs muables ne sont jamais identiques :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="ow">is</span> <span class="n">b</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Voici quelques exemples de la bibliothèque standard qui illustrent comment utiliser correctement les tests d'identité dans certaines situations particulières :</p>
<p>1) As recommended by <span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-0008/"><strong>PEP 8</strong></a>, an identity test is the preferred way to check
for <code class="docutils literal notranslate"><span class="pre">None</span></code>.  This reads like plain English in code and avoids confusion with
other objects that may have boolean values that evaluate to false.</p>
<p>2) Detecting optional arguments can be tricky when <code class="docutils literal notranslate"><span class="pre">None</span></code> is a valid input
value.  In those situations, you can create a singleton sentinel object
guaranteed to be distinct from other objects.  For example, here is how
to implement a method that behaves like <a class="reference internal" href="../library/stdtypes.html#dict.pop" title="dict.pop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dict.pop()</span></code></a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">_sentinel</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_sentinel</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">_sentinel</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">default</span>
</pre></div>
</div>
<p>3) Container implementations sometimes need to augment equality tests with
identity tests.  This prevents the code from being confused by objects such as
<code class="docutils literal notranslate"><span class="pre">float('NaN')</span></code> that are not equal to themselves.</p>
<p>For example, here is the implementation of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">collections.abc.Sequence.__contains__()</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
</section>
<section id="how-can-a-subclass-control-what-data-is-stored-in-an-immutable-instance">
<h3><a class="toc-backref" href="#id69">Comment définir dans une classe fille les attributs d'une instance immuable ?</a><a class="headerlink" href="#how-can-a-subclass-control-what-data-is-stored-in-an-immutable-instance" title="Lien permanent vers ce titre">¶</a></h3>
<p>When subclassing an immutable type, override the <a class="reference internal" href="../reference/datamodel.html#object.__new__" title="object.__new__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__new__()</span></code></a> method
instead of the <a class="reference internal" href="../reference/datamodel.html#object.__init__" title="object.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> method.  The latter only runs <em>after</em> an
instance is created, which is too late to alter data in an immutable
instance.</p>
<p>Toutes les classes d'objets immuables suivantes ont des signatures de constructeur différentes de leur classe mère :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

<span class="k">class</span> <span class="nc">FirstOfMonthDate</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
    <span class="s2">&quot;Always choose the first day of the month&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">NamedInt</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
    <span class="s2">&quot;Allow text names for some numbers&quot;</span>
    <span class="n">xlat</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;zero&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ten&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">xlat</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">TitleStr</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Convert str to name suitable for a URL path&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>Ces classes s'utilisent comme ceci :</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FirstOfMonthDate</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="go">FirstOfMonthDate(2012, 2, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NamedInt</span><span class="p">(</span><span class="s1">&#39;ten&#39;</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NamedInt</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TitleStr</span><span class="p">(</span><span class="s1">&#39;Blog: Why Python Rocks&#39;</span><span class="p">)</span>
<span class="go">&#39;blog-why-python-rocks&#39;</span>
</pre></div>
</div>
</section>
<section id="how-do-i-cache-method-calls">
<span id="faq-cache-method-calls"></span><h3><a class="toc-backref" href="#id70">Comment mettre en cache le résultat d'une méthode ?</a><a class="headerlink" href="#how-do-i-cache-method-calls" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il existe deux outils principaux pour mettre en cache la valeur de retour d'une méthode, à savoir <a class="reference internal" href="../library/functools.html#functools.cached_property" title="functools.cached_property"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.cached_property()</span></code></a>, qui stocke les valeurs au niveau de l'instance, et <a class="reference internal" href="../library/functools.html#functools.lru_cache" title="functools.lru_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.lru_cache()</span></code></a>, qui le fait au niveau de la classe.</p>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">cached_property</span></code> n'est applicable qu'aux méthodes sans argument. Elle n'induit aucune référence vers l'instance. Le cache est simplement conservé aussi longtemps que l'instance elle-même.</p>
<p>L'avantage est que le cache est supprimé aussitôt que l'instance est détruite. L'inconvénient est que les caches peuvent s'accumuler avec les instances, sans limite de nombre.</p>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">lru_cache</span></code> s'applique quant à elle aux méthodes dont les arguments sont <a class="reference internal" href="../glossary.html#term-hashable"><span class="xref std std-term">hachables</span></a>. Elle crée une référence forte à l'instance, sauf à passer par des circonvolutions pour que la référence soit faible.</p>
<p>L'avantage de l'algorithme LRU est d'offrir une limitation sur la taille du cache, que l'on peut régler avec le paramètre <em>maxsize</em> (NdT : LRU signifie <em>Least Recently Used</em> en anglais, les entrées du cache les plus anciennes sont évincées pour conserver la taille). L'inconvénient est qu'une référence forte vers l'instance est conservée dans le cache, ce qui maintient l'instance hors de portée du ramasse-miettes jusqu'à ce que l'entrée soit effacée du cache ou que le cache soit remis à zéro.</p>
<p>Voici une démonstration des différentes techniques :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Weather</span><span class="p">:</span>
    <span class="s2">&quot;Lookup weather information on a government website&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_station_id</span> <span class="o">=</span> <span class="n">station_id</span>
        <span class="c1"># The _station_id is private and immutable</span>

    <span class="k">def</span> <span class="nf">current_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Latest hourly observation&quot;</span>
        <span class="c1"># Do not cache this because old results</span>
        <span class="c1"># can be out of date.</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Return the longitude/latitude coordinates of the station&quot;</span>
        <span class="c1"># Result only depends on the station_id</span>

    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">historic_rainfall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;mm&#39;</span><span class="p">):</span>
        <span class="s2">&quot;Rainfall on a given date&quot;</span>
        <span class="c1"># Depends on the station_id, date, and units.</span>
</pre></div>
</div>
<p>Cet exemple suppose que l'attribut <em>station_id</em> n'est jamais changé. Si les attributs utilisés par la méthode sont susceptibles d'être modifiés, <code class="docutils literal notranslate"><span class="pre">cached_property</span></code> ne peut pas fonctionner car elle ne peut pas détecter les mutations pour invalider le cache.</p>
<p>To make the <em>lru_cache</em> approach work when the <em>station_id</em> is mutable,
the class needs to define the <a class="reference internal" href="../reference/datamodel.html#object.__eq__" title="object.__eq__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__eq__()</span></code></a> and <a class="reference internal" href="../reference/datamodel.html#object.__hash__" title="object.__hash__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__hash__()</span></code></a>
methods so that the cache can detect relevant attribute updates:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Weather</span><span class="p">:</span>
    <span class="s2">&quot;Example with a mutable station identifier&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_id</span> <span class="o">=</span> <span class="n">station_id</span>

    <span class="k">def</span> <span class="nf">change_station</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">station_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">station_id</span> <span class="o">=</span> <span class="n">station_id</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">station_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">station_id</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">station_id</span><span class="p">)</span>

    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">historic_rainfall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;cm&#39;</span><span class="p">):</span>
        <span class="s1">&#39;Rainfall on a given date&#39;</span>
        <span class="c1"># Depends on the station_id, date, and units.</span>
</pre></div>
</div>
</section>
</section>
<section id="modules">
<h2><a class="toc-backref" href="#id71">Modules</a><a class="headerlink" href="#modules" title="Lien permanent vers ce titre">¶</a></h2>
<section id="how-do-i-create-a-pyc-file">
<h3><a class="toc-backref" href="#id72">Comment créer des fichiers <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> ?</a><a class="headerlink" href="#how-do-i-create-a-pyc-file" title="Lien permanent vers ce titre">¶</a></h3>
<p>Quand un module est importé pour la première fois (ou si le fichier source a été modifié depuis la création du fichier compilé), un fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> contenant le code précompilé est créé dans un sous-dossier <code class="docutils literal notranslate"><span class="pre">__pycache__</span></code> du dossier contentant le fichier <code class="docutils literal notranslate"><span class="pre">.py</span></code>. Le nom du fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> est identique au fichier <code class="docutils literal notranslate"><span class="pre">.py</span></code> et se termine par <code class="docutils literal notranslate"><span class="pre">.pyc</span></code>, avec une partie centrale qui dépend du binaire <code class="docutils literal notranslate"><span class="pre">python</span></code> qui l'a créé (voir la <span class="target" id="index-11"></span><a class="pep reference external" href="https://peps.python.org/pep-3147/"><strong>PEP 3147</strong></a> pour de plus amples précisions).</p>
<p>Une des raisons pour lesquelles un fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> peut ne pas être créé est un problème de droits sur le dossier qui contient le fichier source, ce qui veut dire qu'il est impossible de créer le sous-dossier <code class="docutils literal notranslate"><span class="pre">__pycache__</span></code>. Ceci peut arriver, par exemple, si vous développez en tant qu'un certain utilisateur, mais que le code est exécuté en tant qu'un autre utilisateur, par exemple pour tester un serveur Web.</p>
<p>La création du fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> est automatique durant l'importation d'un module si Python est capable (en termes de droits, d'espace disque, etc) de créer un sous-dossier <code class="docutils literal notranslate"><span class="pre">__pycache__</span></code> et d'écrire le module ainsi compilé dans ce sous-répertoire, à moins que la variable d'environnement <span class="target" id="index-12"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONDONTWRITEBYTECODE"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONDONTWRITEBYTECODE</span></code></a> soit définie.</p>
<p>Exécuter du Python dans un script de plus haut niveau n'est pas considéré comme une importation et le fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> n'est pas créé. Par exemple, si un module de plus haut niveau <code class="docutils literal notranslate"><span class="pre">foo.py</span></code> importe un autre module <code class="docutils literal notranslate"><span class="pre">xyz.py</span></code>, alors à l'exécution de <code class="docutils literal notranslate"><span class="pre">foo</span></code> (en tapant <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">foo.py</span></code> dans la console), un fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> est créé pour <code class="docutils literal notranslate"><span class="pre">xyz</span></code> mais pas pour <code class="docutils literal notranslate"><span class="pre">foo</span></code> car <code class="docutils literal notranslate"><span class="pre">foo.py</span></code> n'est pas importé.</p>
<p>Pour créer un fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> pour <code class="docutils literal notranslate"><span class="pre">foo</span></code> — c'est-à-dire créer un fichier <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> pour un module qui n'est pas importé — il existe les modules <a class="reference internal" href="../library/py_compile.html#module-py_compile" title="py_compile: Generate byte-code files from Python source files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">py_compile</span></code></a> et <a class="reference internal" href="../library/compileall.html#module-compileall" title="compileall: Tools for byte-compiling all Python source files in a directory tree."><code class="xref py py-mod docutils literal notranslate"><span class="pre">compileall</span></code></a>.</p>
<p>Le module <a class="reference internal" href="../library/py_compile.html#module-py_compile" title="py_compile: Generate byte-code files from Python source files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">py_compile</span></code></a> peut compiler n'importe quel module manuellement. Il est ainsi possible d'appeler la fonction <code class="docutils literal notranslate"><span class="pre">compile()</span></code> de manière interactive :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">py_compile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">py_compile</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;foo.py&#39;</span><span class="p">)</span>                 
</pre></div>
</div>
<p>Ces lignes écrivent le <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> dans un sous-dossier <code class="docutils literal notranslate"><span class="pre">__pycache__</span></code> à côté de <code class="docutils literal notranslate"><span class="pre">foo.py</span></code> (le paramètre optionnel <code class="docutils literal notranslate"><span class="pre">cfile</span></code> permet de changer ce comportement).</p>
<p>Tous les fichiers d'un ou plusieurs dossiers peuvent aussi être compilés avec le module <a class="reference internal" href="../library/compileall.html#module-compileall" title="compileall: Tools for byte-compiling all Python source files in a directory tree."><code class="xref py py-mod docutils literal notranslate"><span class="pre">compileall</span></code></a>. C'est possible depuis l'invite de commande en exécutant <code class="docutils literal notranslate"><span class="pre">compileall.py</span></code> avec le chemin du dossier contenant les fichiers Python à compiler :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">compileall</span> <span class="o">.</span>
</pre></div>
</div>
</section>
<section id="how-do-i-find-the-current-module-name">
<h3><a class="toc-backref" href="#id73">Comment obtenir le nom du module actuel ?</a><a class="headerlink" href="#how-do-i-find-the-current-module-name" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un module peut déterminer son propre nom en examinant la variable globale prédéfinie <code class="docutils literal notranslate"><span class="pre">__name__</span></code>. Si celle-ci vaut <code class="docutils literal notranslate"><span class="pre">'__main__'</span></code>, c'est que le programme est exécuté comme un script. Beaucoup de modules qui doivent normalement être importés pour pouvoir être utilisés fournissent aussi une interface en ligne de commande ou un test automatique. Ils n'exécutent cette portion du code qu'après avoir vérifié la valeur de <code class="docutils literal notranslate"><span class="pre">__name__</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running test...&#39;</span><span class="p">)</span>
    <span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="how-can-i-have-modules-that-mutually-import-each-other">
<h3><a class="toc-backref" href="#id74">Comment avoir des modules qui s'importent mutuellement ?</a><a class="headerlink" href="#how-can-i-have-modules-that-mutually-import-each-other" title="Lien permanent vers ce titre">¶</a></h3>
<p>Considérons les modules suivants :</p>
<p><code class="file docutils literal notranslate"><span class="pre">foo.py</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bar</span> <span class="kn">import</span> <span class="n">bar_var</span>
<span class="n">foo_var</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p><code class="file docutils literal notranslate"><span class="pre">bar.py</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">foo</span> <span class="kn">import</span> <span class="n">foo_var</span>
<span class="n">bar_var</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Le problème réside dans les étapes que l'interpréteur va réaliser :</p>
<ul class="simple">
<li><p><em>main</em> importe <em>foo</em> ;</p></li>
<li><p>Les variables globales (vides) de <em>foo</em> sont créées ;</p></li>
<li><p><em>foo</em> est compilé et commence à s'exécuter ;</p></li>
<li><p><em>foo</em> importe <em>bar</em> ;</p></li>
<li><p>Les variables globales (vides) de <em>bar</em> sont créées ;</p></li>
<li><p><em>bar</em> est compilé et commence à s'exécuter ;</p></li>
<li><p><em>bar</em> importe <em>foo</em> (en réalité, rien ne passe car il y a déjà un module appelé <em>foo</em>) ;</p></li>
<li><p>La mécanique des importations tente de lire <em>foo_var</em> dans les variables globales de <em>foo</em> pour procéder à l'affectation <code class="docutils literal notranslate"><span class="pre">bar.foo_var</span> <span class="pre">=</span> <span class="pre">foo.foo_var</span></code>.</p></li>
</ul>
<p>La dernière étape échoue car Python n'a pas fini d'interpréter <code class="docutils literal notranslate"><span class="pre">foo</span></code> et le dictionnaire global des symboles de <code class="docutils literal notranslate"><span class="pre">foo</span></code> est encore vide.</p>
<p>Le même phénomène arrive quand on utilise <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">foo</span></code>, et qu'on essaye ensuite d'accéder à <code class="docutils literal notranslate"><span class="pre">foo.foo_var</span></code> dans le code global.</p>
<p>Il y a (au moins) trois façons de contourner ce problème.</p>
<p>Guido van Rossum déconseille d'utiliser <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">&lt;module&gt;</span> <span class="pre">import</span> <span class="pre">...</span></code> et de mettre tout le code dans des fonctions.  L'initialisation des variables globales et des variables de classe ne doit utiliser que des constantes ou des fonctions natives.  Ceci implique que tout ce qui est fourni par un module soit référencé par <code class="docutils literal notranslate"><span class="pre">&lt;module&gt;.&lt;nom&gt;</span></code>.</p>
<p>Jim Roskind recommande d'effectuer les étapes suivantes dans cet ordre dans chaque module :</p>
<ul class="simple">
<li><p>les exportations (variables globales, fonctions et les classes qui ne nécessitent d'importer des classes mères)</p></li>
<li><p>les instructions <code class="docutils literal notranslate"><span class="pre">import</span></code></p></li>
<li><p>le code (avec les variables globales qui sont initialisées à partir de valeurs importées).</p></li>
</ul>
<p>van Rossum désapprouve cette approche car les importations se trouvent à un endroit bizarre, mais cela fonctionne.</p>
<p>Matthias Urlichs conseille de restructurer le code pour éviter les importations récursives.</p>
<p>Ces solutions peuvent être combinées.</p>
</section>
<section id="import-x-y-z-returns-module-x-how-do-i-get-z">
<h3><a class="toc-backref" href="#id75"><code class="docutils literal notranslate"><span class="pre">__import__('x.y.z')</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">&lt;module</span> <span class="pre">'x'&gt;</span></code> ; comment accéder à <code class="docutils literal notranslate"><span class="pre">z</span></code> ?</a><a class="headerlink" href="#import-x-y-z-returns-module-x-how-do-i-get-z" title="Lien permanent vers ce titre">¶</a></h3>
<p>Utilisez plutôt la fonction <a class="reference internal" href="../library/importlib.html#importlib.import_module" title="importlib.import_module"><code class="xref py py-func docutils literal notranslate"><span class="pre">import_module()</span></code></a> de <a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s1">&#39;x.y.z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="when-i-edit-an-imported-module-and-reimport-it-the-changes-don-t-show-up-why-does-this-happen">
<h3><a class="toc-backref" href="#id76">Quand j'édite un module et que je le réimporte, je ne vois pas les changements. Pourquoi ?</a><a class="headerlink" href="#when-i-edit-an-imported-module-and-reimport-it-the-changes-don-t-show-up-why-does-this-happen" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour des raisons de performance et de cohérence, Python ne lit le fichier d'un module que la première fois où celui-ci est importé. Si ce n'était pas le cas, dans un programme composé d'un très grand nombre de modules qui importent tous le même module de base, ce module de base serait analysé et ré-analysé un très grand nombre de fois. Pour forcer la relecture d'un module, il faut faire :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">modname</span>
<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span>
</pre></div>
</div>
<p>Attention, cette technique ne marche pas systématiquement. En particulier, les modules qui contiennent des instructions comme</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">modname</span> <span class="kn">import</span> <span class="n">some_objects</span>
</pre></div>
</div>
<p>continuent de fonctionner avec l'ancienne version des objets importés. Si le module contient une définition de classe, les instances déjà existantes de celle-ci ne sont <em>pas</em> mises à jour avec la nouvelle définition de la classe. Ceci peut conduire au comportement paradoxal suivant :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">importlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cls</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>                <span class="c1"># Create an instance of C</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="go">&lt;module &#39;cls&#39; from &#39;cls.py&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>       <span class="c1"># isinstance is false?!?</span>
<span class="go">False</span>
</pre></div>
</div>
<p>La nature du problème apparaît clairement en affichant « l'identité » des objets de la classe :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="vm">__class__</span><span class="p">))</span>
<span class="go">&#39;0x7352a0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">C</span><span class="p">))</span>
<span class="go">&#39;0x4198d0&#39;</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#">FAQ de programmation</a><ul>
<li><a class="reference internal" href="#general-questions">Questions générales</a></li>
<li><a class="reference internal" href="#core-language">Fondamentaux</a></li>
<li><a class="reference internal" href="#numbers-and-strings">Nombres et chaînes de caractères</a></li>
<li><a class="reference internal" href="#performance">Performances</a></li>
<li><a class="reference internal" href="#sequences-tuples-lists">Séquences (<em>n</em>-uplets / listes)</a></li>
<li><a class="reference internal" href="#objects">Objets</a></li>
<li><a class="reference internal" href="#modules">Modules</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="general.html"
                          title="Chapitre précédent">FAQ générale sur Python</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="design.html"
                          title="Chapitre suivant">FAQ sur l'histoire et la conception</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/faq/programming.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="design.html" title="FAQ sur l&#39;histoire et la conception"
             >suivant</a> |</li>
        <li class="right" >
          <a href="general.html" title="FAQ générale sur Python"
             >précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Questions fréquemment posées sur Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FAQ de programmation</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2001-2023, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="/license.html">History and License</a> for more information.<br />
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Mis à jour le oct. 26, 2023.
    <a href="/bugs.html">Found a bug</a>?
    <br />

    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>

  </body>
</html>