
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="FAQ : Python et Windows" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/faq/windows.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="Sommaire: FAQ : Python et Windows- Comment exécuter un programme Python sous Windows ?, Comment rendre des scripts Python exécutables ?, Pourquoi Python met-il du temps à démarrer ?, Comment constr..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="Sommaire: FAQ : Python et Windows- Comment exécuter un programme Python sous Windows ?, Comment rendre des scripts Python exécutables ?, Pourquoi Python met-il du temps à démarrer ?, Comment constr..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>FAQ : Python et Windows &#8212; Documentation Python 3.12.0</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?digest=b37c26da2f7529d09fe70b41c4b2133fe4931a90" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Documentation Python 3.12.0"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="FAQ interface graphique" href="gui.html" />
    <link rel="prev" title="FAQ extension/intégration" href="extending.html" />
    <link rel="canonical" href="https://docs.python.org/3/faq/windows.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#">FAQ : Python et Windows</a><ul>
<li><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows">Comment exécuter un programme Python sous Windows ?</a></li>
<li><a class="reference internal" href="#how-do-i-make-python-scripts-executable">Comment rendre des scripts Python exécutables ?</a></li>
<li><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start">Pourquoi Python met-il du temps à démarrer ?</a></li>
<li><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script">Comment construire un exécutable depuis un script Python ?</a></li>
<li><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll">Est-ce qu'un fichier <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> est la même chose qu'une DLL ?</a></li>
<li><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application">Comment puis-je intégrer Python dans une application Windows ?</a></li>
<li><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">Comment empêcher mon éditeur d'utiliser des tabulations dans mes fichiers Python ?</a></li>
<li><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking">Comment puis-je vérifier de manière non bloquante qu'une touche a été pressée ?</a></li>
<li><a class="reference internal" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error">Comment résoudre l'erreur « <code class="docutils literal notranslate"><span class="pre">api-ms-win-crt-runtime-l1-1-0.dll</span></code> manquante » ?</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="extending.html"
                          title="Chapitre précédent">FAQ extension/intégration</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="gui.html"
                          title="Chapitre suivant">FAQ interface graphique</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/faq/windows.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="gui.html" title="FAQ interface graphique"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="extending.html" title="FAQ extension/intégration"
             accesskey="P">précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Questions fréquemment posées sur Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FAQ : Python et Windows</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="python-on-windows-faq">
<span id="windows-faq"></span><h1><a class="toc-backref" href="#id1">FAQ : Python et Windows</a><a class="headerlink" href="#python-on-windows-faq" title="Lien permanent vers ce titre">¶</a></h1>
<div class="contents topic" id="sommaire">
<p class="topic-title">Sommaire</p>
<ul class="simple">
<li><p><a class="reference internal" href="#python-on-windows-faq" id="id1">FAQ : Python et Windows</a></p>
<ul>
<li><p><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows" id="id2">Comment exécuter un programme Python sous Windows ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-make-python-scripts-executable" id="id3">Comment rendre des scripts Python exécutables ?</a></p></li>
<li><p><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start" id="id4">Pourquoi Python met-il du temps à démarrer ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script" id="id5">Comment construire un exécutable depuis un script Python ?</a></p></li>
<li><p><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll" id="id6">Est-ce qu'un fichier <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> est la même chose qu'une DLL ?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application" id="id7">Comment puis-je intégrer Python dans une application Windows ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source" id="id8">Comment empêcher mon éditeur d'utiliser des tabulations dans mes fichiers Python ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking" id="id9">Comment puis-je vérifier de manière non bloquante qu'une touche a été pressée ?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error" id="id10">Comment résoudre l'erreur « <code class="docutils literal notranslate"><span class="pre">api-ms-win-crt-runtime-l1-1-0.dll</span></code> manquante » ?</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="how-do-i-run-a-python-program-under-windows">
<span id="faq-run-program-under-windows"></span><h2><a class="toc-backref" href="#id2">Comment exécuter un programme Python sous Windows ?</a><a class="headerlink" href="#how-do-i-run-a-python-program-under-windows" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce n'est pas forcément une question simple. Si vous êtes déjà familier avec le lancement de programmes depuis la ligne de commande de Windows alors tout semblera évident ; sinon, vous pourriez avoir besoin d'être un peu guidé.</p>
<p>À moins que vous n'utilisiez une sorte d'environnement de développement, vous finirez par <em>taper</em> des commandes Windows dans ce qui est appelé une « invite de commande Windows ». En général vous pouvez ouvrir un telle fenêtre depuis votre barre de recherche en cherchant <code class="docutils literal notranslate"><span class="pre">cmd</span></code>. Vous devriez être capable de reconnaître quand vous avez lancé une telle fenêtre parce que vous verrez une « invite de commande » Windows, qui en en général ressemble à ça :</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\&gt;</span>
</pre></div>
</div>
<p>La lettre peut être différente, et il peut y avoir d'autres choses à la suite, alors il se peut que ça ressemble également à ça :</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">D:\YourName\Projects\Python&gt;</span>
</pre></div>
</div>
<p>selon la configuration de votre ordinateur et ce que vous avez récemment fait avec. Une fois que vous avez ouvert cette fenêtre, vous êtes bien partis pour pouvoir lancer des programmes Python.</p>
<p>Retenez que vos scripts Python doivent être traités par un autre programme appelé &quot;l’interpréteur&quot; Python. L’interpréteur lit votre script, le compile en <em>bytecode</em>, et exécute le <em>bytecode</em> pour faire tourner votre programme. Alors, comment faire pour donner votre code Python à l'interpréteur ?</p>
<p>Tout d'abord, vous devez vous assurer que votre fenêtre d'invite de commande reconnaît le mot &quot;python&quot; comme une instruction pour démarrer l'interpréteur. Si vous avez ouvert une invite de commande, entrez la commande <code class="docutils literal notranslate"><span class="pre">py</span></code>, puis appuyez sur entrée :</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\Users\YourName&gt;</span> py
</pre></div>
</div>
<p>Vous devez voir quelque chose comme ça :</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Python 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:04:45) [MSC v.1900 32 bit (Intel)] on win32</span>
<span class="go">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Vous avez lancé l'interpréteur dans son &quot;mode interactif&quot;. Cela signifie que vous pouvez entrer des instructions ou des expressions Python de manière interactive pour qu'elles soient exécutées. Il s'agit là d'une des plus puissantes fonctionnalités de Python. Vous pouvez le vérifier en entrant quelques commandes de votre choix et en regardant le résultat :</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="go">Hello</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;Hello&quot;</span> <span class="o">*</span> <span class="mi">3</span>
<span class="go">&#39;HelloHelloHello&#39;</span>
</pre></div>
</div>
<p>Beaucoup de gens utilisent le mode interactif comme une calculatrice pratique mais néanmoins hautement programmable. Lorsque vous souhaitez mettre fin à votre session Python interactive, appelez la fonction <a class="reference internal" href="../library/constants.html#exit" title="exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">exit()</span></code></a> ou maintenez la touche <kbd class="kbd docutils literal notranslate">Ctrl</kbd> enfoncée pendant que vous entrez un <kbd class="kbd docutils literal notranslate">Z</kbd>, puis appuyez sur la touche &quot;<kbd class="kbd docutils literal notranslate">Enter</kbd>&quot; pour revenir à votre invite de commande Windows.</p>
<p>Peut-être avez-vous remarqué une nouvelle entrée dans votre menu Démarrer telle que <span class="menuselection">Démarrer ‣ Programmes ‣ Python 3.x ‣ Python (ligne de commande)</span> qui a pour résultat que vous voyez l'invite <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> dans une nouvelle fenêtre.  Si oui, la fenêtre va disparaître quand vous appellerez la fonction <a class="reference internal" href="../library/constants.html#exit" title="exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">exit()</span></code></a> ou entrez le caractère <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>-<kbd class="kbd docutils literal notranslate">Z</kbd></kbd> ; Windows exécute une commande &quot;python&quot; dans la fenêtre et ferme celle-ci lorsque vous fermez l'interpréteur.</p>
<p>Maintenant que nous savons que la commande <code class="docutils literal notranslate"><span class="pre">py</span></code> est reconnue, vous pouvez lui donner votre script Python. Vous devez donner le chemin absolu ou relatif du script Python. Disons que votre script Python est situé sur votre bureau et est nommé <code class="docutils literal notranslate"><span class="pre">hello.py</span></code>, et votre invite de commande est bien ouvert dans votre répertoire d’accueil, alors vous voyez quelque chose comme :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\YourName&gt;
</pre></div>
</div>
<p>Alors maintenant, vous demanderez à la commande <code class="docutils literal notranslate"><span class="pre">py</span></code> de donner votre script à Python en tapant <code class="docutils literal notranslate"><span class="pre">py</span></code> suivi de votre chemin de script :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\YourName&gt; py Desktop\hello.py
hello
</pre></div>
</div>
</section>
<section id="how-do-i-make-python-scripts-executable">
<h2><a class="toc-backref" href="#id3">Comment rendre des scripts Python exécutables ?</a><a class="headerlink" href="#how-do-i-make-python-scripts-executable" title="Lien permanent vers ce titre">¶</a></h2>
<p>Sous Windows, l'installateur Python associe l'extension <em>.py</em> avec un type de fichier (Python.File) et une commande qui lance l’interpréteur (<code class="docutils literal notranslate"><span class="pre">D:\Program</span> <span class="pre">Files\Python\python.exe</span> <span class="pre">&quot;%1&quot;</span> <span class="pre">%*</span></code>). Cela suffit pour pouvoir exécuter les scripts Python depuis la ligne de commande en saisissant <em>foo.py</em>. Si vous souhaitez pouvoir exécuter les scripts en saisissant simplement <em>foo</em> sans l’extension, vous devez ajouter <em>.py</em> au paramètre d’environnement PATHEXT.</p>
</section>
<section id="why-does-python-sometimes-take-so-long-to-start">
<h2><a class="toc-backref" href="#id4">Pourquoi Python met-il du temps à démarrer ?</a><a class="headerlink" href="#why-does-python-sometimes-take-so-long-to-start" title="Lien permanent vers ce titre">¶</a></h2>
<p>Normalement, sous Windows, Python se lance très rapidement, mais parfois des rapports d'erreurs indiquent que Python commence soudain à prendre beaucoup de temps pour démarrer. C'est d'autant plus intrigant que Python fonctionne correctement avec d'autres Windows configurés de façon similaire.</p>
<p>Le problème peut venir d'un antivirus mal configuré. Certains antivirus sont connus pour doubler le temps de démarrage lorsqu'ils sont configurés pour surveiller toutes les lectures du système de fichiers. Essayez de regarder si les antivirus des deux machines sont bien paramétrés à l'identique. <em>McAfee</em> est particulièrement problématique lorsqu'il est paramétré pour surveiller toutes les lectures du système de fichiers.</p>
</section>
<section id="how-do-i-make-an-executable-from-a-python-script">
<h2><a class="toc-backref" href="#id5">Comment construire un exécutable depuis un script Python ?</a><a class="headerlink" href="#how-do-i-make-an-executable-from-a-python-script" title="Lien permanent vers ce titre">¶</a></h2>
<p>Voir <a class="reference internal" href="programming.html#faq-create-standalone-binary"><span class="std std-ref">Comment créer un binaire autonome à partir d'un script Python ?</span></a> pour une liste d'outils qui créent des exécutables.</p>
</section>
<section id="is-a-pyd-file-the-same-as-a-dll">
<h2><a class="toc-backref" href="#id6">Est-ce qu'un fichier <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> est la même chose qu'une DLL ?</a><a class="headerlink" href="#is-a-pyd-file-the-same-as-a-dll" title="Lien permanent vers ce titre">¶</a></h2>
<p>Oui, les fichiers <em>.pyd</em> sont des fichiers <em>dll</em>, mais il y a quelques différences.  Si vous avez une <em>DLL</em> <code class="docutils literal notranslate"><span class="pre">foo.pyd</span></code>, celle-ci doit posséder une fonction <code class="docutils literal notranslate"><span class="pre">PyInit_foo()</span></code>.  Vous pouvez alors écrire en Python « <em>import foo</em> » et Python recherchera le fichier <em>foo.pyd</em> (ainsi que <em>foo.py</em> et <em>foo.pyc</em>); s'il le trouve, il tentera d'appeler <code class="docutils literal notranslate"><span class="pre">PyInit_foo()</span></code> pour l'initialiser.  Ne liez pas votre <em>.exe</em> avec <em>foo.lib</em> car dans ce cas Windows aura besoin de la DLL.</p>
<p>Notez que le chemin de recherche pour <em>foo.pyd</em> est <em>PYTHONPATH</em>, il est différent de celui qu'utilise Windows pour rechercher <em>foo.dll</em>.  De plus, <em>foo.pyd</em> n'a pas besoin d'être présent pour que votre programme s'exécute alors que si vous avez lié votre programme avec une <em>dll</em> celle-ci est requise.  Bien sûr <em>foo.pyd</em> est nécessaire si vous écrivez <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">foo</span></code>.  Dans une <em>DLL</em> le lien est déclaré dans le code source avec <code class="docutils literal notranslate"><span class="pre">__declspec(dllexport)</span></code>. Dans un <em>.pyd</em> la liaison est définie dans une liste de fonctions disponibles.</p>
</section>
<section id="how-can-i-embed-python-into-a-windows-application">
<h2><a class="toc-backref" href="#id7">Comment puis-je intégrer Python dans une application Windows ?</a><a class="headerlink" href="#how-can-i-embed-python-into-a-windows-application" title="Lien permanent vers ce titre">¶</a></h2>
<p>L'intégration de l'interpréteur Python dans une application Windows peut se résumer comme suit :</p>
<ol class="arabic">
<li><p>Ne compilez <strong>pas</strong> Python directement dans votre fichier <em>.exe</em>.  Sous Windows, Python doit être une DLL pour pouvoir importer des modules qui sont eux-mêmes des DLL (ceci constitue une information de première importance non documentée). Au lieu de cela faites un lien vers <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code> qui est généralement placé dans <code class="docutils literal notranslate"><span class="pre">C:\Windows\System</span></code>.  <em>NN</em> étant la version Python, par exemple « 33 » pour Python 3.3.</p>
<p>Vous pouvez créer un lien vers Python de deux manières différentes.  Un lien au moment du chargement signifie pointer vers <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></code>, tandis qu'un lien au moment de l'exécution signifie pointer vers <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>.  (Note générale : <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></code> est le soi-disant « <em>import lib</em> » correspondant à <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>.  Il définit simplement des  liens symboliques pour l'éditeur de liens.)</p>
<p>La liaison en temps réel simplifie grandement les options de liaison ; tout se passe au moment de l'exécution.  Votre code doit charger <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code> en utilisant la routine Windows <code class="docutils literal notranslate"><span class="pre">LoadLibraryEx()</span></code>.  Le code doit aussi utiliser des routines d'accès et des données dans <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code> (c'est-à-dire les API C de Python) en utilisant des pointeurs obtenus par la routine Windows <code class="docutils literal notranslate"><span class="pre">GetProcAddress()</span></code>.  Les macros peuvent rendre l'utilisation de ces pointeurs transparente à tout code C qui appelle des routines dans l'API C de Python.</p>
</li>
<li><p>Si vous utilisez SWIG, il est facile de créer un « module d'extension » Python qui rendra les données et les méthodes de l'application disponibles pour Python.  SWIG s'occupera de tous les détails ennuyeux pour vous.  Le résultat est du code C que vous liez <em>dans</em> votre <em>fichier.exe</em> (!) Vous n'avez <strong>pas</strong> besoin de créer un fichier DLL, et cela simplifie également la liaison.</p></li>
<li><p>SWIG va créer une fonction d'initialisation (fonction en C) dont le nom dépend du nom du module d'extension.  Par exemple, si le nom du module est <em>leo</em>, la fonction <em>init</em> sera appelée <em>initleo()</em>.  Si vous utilisez des classes <em>shadow</em> SWIG, comme vous le devriez, la fonction <em>init</em> sera appelée <em>initleoc()</em>.  Ceci initialise une classe auxiliaire invisible utilisée par la classe <em>shadow</em>.</p>
<p>La raison pour laquelle vous pouvez lier le code C à l'étape 2 dans votre <em>fichier.exe</em> est que l'appel de la fonction d'initialisation équivaut à importer le module dans Python ! (C'est le deuxième fait clé non documenté.)</p>
</li>
<li><p>En bref, vous pouvez utiliser le code suivant pour initialiser l'interpréteur Python avec votre module d'extension.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Python.h&gt;</span>
<span class="p">...</span>
<span class="n">Py_Initialize</span><span class="p">();</span><span class="w">  </span><span class="c1">// Initialize Python.</span>
<span class="n">initmyAppc</span><span class="p">();</span><span class="w">  </span><span class="c1">// Initialize (import) the helper class.</span>
<span class="n">PyRun_SimpleString</span><span class="p">(</span><span class="s">&quot;import myApp&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Import the shadow class.</span>
</pre></div>
</div>
</li>
<li><p>Il y a deux problèmes avec l'API C de Python qui apparaîtront si vous utilisez un compilateur autre que MSVC, le compilateur utilisé pour construire <em>pythonNN.dll</em>.</p>
<p>Problème 1 : Les fonctions dites de « Très Haut Niveau » qui prennent les arguments <code class="docutils literal notranslate"><span class="pre">FILE</span> <span class="pre">*</span></code> ne fonctionneront pas dans un environnement multi-compilateur car chaque compilateur aura une notion différente de <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">FILE</span></code>.  Du point de vue de l'implémentation, il s'agit de fonctions de très bas niveau.</p>
<p>Problème 2 : SWIG génère le code suivant lors de la génération <em>d'encapsuleurs</em> pour annuler les fonctions :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Py_INCREF</span><span class="p">(</span><span class="n">Py_None</span><span class="p">);</span>
<span class="n">_resultobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Py_None</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="n">_resultobj</span><span class="p">;</span>
</pre></div>
</div>
<p>Hélas, <em>Py_None</em> est une macro qui se développe en référence à une structure de données complexe appelée <em>_Py_NoneStruct</em> dans <em>pythonNN.dll</em>.  Encore une fois, ce code échouera dans un environnement multi-compilateur.  Remplacez ce code par :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">return</span><span class="w"> </span><span class="n">Py_BuildValue</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Il est possible d'utiliser la commande <code class="docutils literal notranslate"><span class="pre">%typemap</span></code> de SWIG pour effectuer le changement automatiquement, bien que je n'ai pas réussi à le faire fonctionner (je suis un débutant complet avec SWIG).</p>
</li>
<li><p>Utiliser un script shell Python pour créer une fenêtre d'interpréteur Python depuis votre application Windows n'est pas une bonne idée ; la fenêtre résultante sera indépendante du système de fenêtrage de votre application.  Vous (ou la classe <em>wxPythonWindow</em>) devriez plutôt créer une fenêtre d'interpréteur « native ». Il est facile de connecter cette fenêtre à l'interpréteur Python. Vous pouvez rediriger l'entrée/sortie de Python vers <em>n'importe quel</em> objet qui supporte la lecture et l'écriture, donc tout ce dont vous avez besoin est un objet Python (défini dans votre module d'extension) qui contient les méthodes <em>read()</em> et <em>write()</em>.</p></li>
</ol>
</section>
<section id="how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">
<h2><a class="toc-backref" href="#id8">Comment empêcher mon éditeur d'utiliser des tabulations dans mes fichiers Python ?</a><a class="headerlink" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source" title="Lien permanent vers ce titre">¶</a></h2>
<p>La FAQ ne recommande pas l'utilisation des indentations et le guide stylistique de Python, la <span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-0008/"><strong>PEP 8</strong></a>, recommande l'utilisation de 4 espaces dans les codes Python. C'est aussi le comportement par défaut d'Emacs avec Python.</p>
<p>Quel que soit votre éditeur, mélanger des tabulations et des espaces est une mauvaise idée. <em>Visual C++</em>, par exemple, peut être facilement configuré pour utiliser des espaces : allez dans <span class="menuselection">Tools ‣ Options ‣ Tabs</span> et pour le type de fichier par défaut, vous devez mettre <em>Tab size</em> et <em>Indent size</em> à 4, puis sélectionner <em>Insert spaces</em>.</p>
<p>Python va lever <a class="reference internal" href="../library/exceptions.html#IndentationError" title="IndentationError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">IndentationError</span></code></a> ou <a class="reference internal" href="../library/exceptions.html#TabError" title="TabError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TabError</span></code></a> si un mélange de tabulation et d’indentation pose problème en début de ligne. Vous pouvez aussi utiliser le module  <a class="reference internal" href="../library/tabnanny.html#module-tabnanny" title="tabnanny: Tool for detecting white space related problems in Python source files in a directory tree."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tabnanny</span></code></a> pour détecter ces erreurs.</p>
</section>
<section id="how-do-i-check-for-a-keypress-without-blocking">
<h2><a class="toc-backref" href="#id9">Comment puis-je vérifier de manière non bloquante qu'une touche a été pressée ?</a><a class="headerlink" href="#how-do-i-check-for-a-keypress-without-blocking" title="Lien permanent vers ce titre">¶</a></h2>
<p>Utilisez le module <a class="reference internal" href="../library/msvcrt.html#module-msvcrt" title="msvcrt: Miscellaneous useful routines from the MS VC++ runtime. (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msvcrt</span></code></a>. C'est une extension standard spécifique à Windows, qui définit une fonction <code class="docutils literal notranslate"><span class="pre">kbhit()</span></code> qui vérifie si une pression de touche s'est produite, et <code class="docutils literal notranslate"><span class="pre">getch()</span></code> qui récupère le caractère sans l'afficher.</p>
</section>
<section id="how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error">
<h2><a class="toc-backref" href="#id10">Comment résoudre l'erreur « <code class="docutils literal notranslate"><span class="pre">api-ms-win-crt-runtime-l1-1-0.dll</span></code> manquante » ?</a><a class="headerlink" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce problème peut se produire avec Python 3.5 et les versions ultérieures lorsque vous utilisez Windows 8.1 ou une version antérieure sans que toutes les mises à jour aient été installées. Assurez-vous d'abord que votre système d'exploitation est pris en charge et qu'il est à jour, et si cela ne résout pas le problème, visitez la <a class="reference external" href="https://support.microsoft.com/en-us/help/3118401/">page d’assistance de Microsoft</a> pour obtenir des conseils sur l'installation manuelle de la mise à jour du <em>C Runtime</em>.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#">FAQ : Python et Windows</a><ul>
<li><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows">Comment exécuter un programme Python sous Windows ?</a></li>
<li><a class="reference internal" href="#how-do-i-make-python-scripts-executable">Comment rendre des scripts Python exécutables ?</a></li>
<li><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start">Pourquoi Python met-il du temps à démarrer ?</a></li>
<li><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script">Comment construire un exécutable depuis un script Python ?</a></li>
<li><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll">Est-ce qu'un fichier <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> est la même chose qu'une DLL ?</a></li>
<li><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application">Comment puis-je intégrer Python dans une application Windows ?</a></li>
<li><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">Comment empêcher mon éditeur d'utiliser des tabulations dans mes fichiers Python ?</a></li>
<li><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking">Comment puis-je vérifier de manière non bloquante qu'une touche a été pressée ?</a></li>
<li><a class="reference internal" href="#how-do-i-solve-the-missing-api-ms-win-crt-runtime-l1-1-0-dll-error">Comment résoudre l'erreur « <code class="docutils literal notranslate"><span class="pre">api-ms-win-crt-runtime-l1-1-0.dll</span></code> manquante » ?</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="extending.html"
                          title="Chapitre précédent">FAQ extension/intégration</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="gui.html"
                          title="Chapitre suivant">FAQ interface graphique</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/faq/windows.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="gui.html" title="FAQ interface graphique"
             >suivant</a> |</li>
        <li class="right" >
          <a href="extending.html" title="FAQ extension/intégration"
             >précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Questions fréquemment posées sur Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FAQ : Python et Windows</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2001-2023, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="/license.html">History and License</a> for more information.<br />
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Mis à jour le oct. 26, 2023.
    <a href="/bugs.html">Found a bug</a>?
    <br />

    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>

  </body>
</html>