
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="doctest — Exemples de tests interactifs en Python" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/library/doctest.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="Code source : Lib/doctest.py Le module doctest cherche des extraits de texte ressemblant à des sessions Python interactives avant de les exécuter, de façon à vérifier que le fonctionnement correspo..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="Code source : Lib/doctest.py Le module doctest cherche des extraits de texte ressemblant à des sessions Python interactives avant de les exécuter, de façon à vérifier que le fonctionnement correspo..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>doctest — Exemples de tests interactifs en Python &#8212; Documentation Python 3.12.0</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?digest=b37c26da2f7529d09fe70b41c4b2133fe4931a90" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Documentation Python 3.12.0"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="unittest — Framework de tests unitaires" href="unittest.html" />
    <link rel="prev" title="Python Development Mode" href="devmode.html" />
    <link rel="canonical" href="https://docs.python.org/3/library/doctest.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code> — Exemples de tests interactifs en Python</a><ul>
<li><a class="reference internal" href="#simple-usage-checking-examples-in-docstrings">Utilisation simple : vérifier des exemples dans des <em>docstrings</em></a></li>
<li><a class="reference internal" href="#simple-usage-checking-examples-in-a-text-file">Utilisation simple : vérifier des exemples dans un fichier texte</a></li>
<li><a class="reference internal" href="#how-it-works">Comment ça marche</a><ul>
<li><a class="reference internal" href="#which-docstrings-are-examined">Quelles <em>docstrings</em> sont considérées ?</a></li>
<li><a class="reference internal" href="#how-are-docstring-examples-recognized">Comment les exemples <em>docstring</em> sont-ils identifiés ?</a></li>
<li><a class="reference internal" href="#what-s-the-execution-context">Quel est le contexte d'exécution ?</a></li>
<li><a class="reference internal" href="#what-about-exceptions">Qu'en est-il des exceptions ?</a></li>
<li><a class="reference internal" href="#option-flags">Options de ligne de commande</a></li>
<li><a class="reference internal" href="#directives">Instructions</a></li>
<li><a class="reference internal" href="#warnings">Avertissements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-api">API de base</a></li>
<li><a class="reference internal" href="#unittest-api">API de tests unitaires</a></li>
<li><a class="reference internal" href="#advanced-api">API avancé</a><ul>
<li><a class="reference internal" href="#doctest-objects">Objets <em>doctest</em></a></li>
<li><a class="reference internal" href="#example-objects">Exemples d'objets</a></li>
<li><a class="reference internal" href="#doctestfinder-objects">Objets <em>DocTestFinder</em></a></li>
<li><a class="reference internal" href="#doctestparser-objects">Objets <em>DocTestParser</em></a></li>
<li><a class="reference internal" href="#doctestrunner-objects">Objets <em>DocTestRunner</em></a></li>
<li><a class="reference internal" href="#outputchecker-objects">Objets <em>OutputChecker</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging">Débogage</a></li>
<li><a class="reference internal" href="#soapbox">Éditorial</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="devmode.html"
                          title="Chapitre précédent">Python Development Mode</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="unittest.html"
                          title="Chapitre suivant"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code> — <em>Framework</em> de tests unitaires</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/doctest.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="unittest.html" title="unittest — Framework de tests unitaires"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="devmode.html" title="Python Development Mode"
             accesskey="P">précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La bibliothèque standard</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="development.html" accesskey="U">Outils de développement</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code> — Exemples de tests interactifs en Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-doctest">
<span id="doctest-test-interactive-python-examples"></span><h1><a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> — Exemples de tests interactifs en Python<a class="headerlink" href="#module-doctest" title="Lien permanent vers ce titre">¶</a></h1>
<p><strong>Code source :</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/doctest.py">Lib/doctest.py</a></p>
<hr class="docutils" />
<p>Le module <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> cherche des extraits de texte ressemblant à des sessions Python interactives avant de les exécuter, de façon à vérifier que le fonctionnement correspond exactement à la description. Voici quelques cas d'utilisation de <em>doctest</em> :</p>
<ul class="simple">
<li><p>Vérifier que les <em>docstrings</em> d'un module sont à jour en vérifiant que tous les exemples interactifs fonctionnent toujours tels que décrits.</p></li>
<li><p>Réaliser un test de régression en vérifiant que les exemples interactifs provenant d'un fichier de test ou d'un objet de test fonctionnent comme prévu.</p></li>
<li><p>Rédiger de la documentation sous forme de tutoriel pour un paquet, avec une abondance d'exemples ayant des entrées et des sorties. On pourrait voir ça comme des tests « dans le texte » ou de la « documentation exécutable », selon le point de vue.</p></li>
</ul>
<p>Voici un petit exemple d'un module qui soit tout de même complet :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is the &quot;example&quot; module.</span>

<span class="sd">The example module supplies one function, factorial().  For example,</span>

<span class="sd">&gt;&gt;&gt; factorial(5)</span>
<span class="sd">120</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the factorial of n, an exact integer &gt;= 0.</span>

<span class="sd">    &gt;&gt;&gt; [factorial(n) for n in range(6)]</span>
<span class="sd">    [1, 1, 2, 6, 24, 120]</span>
<span class="sd">    &gt;&gt;&gt; factorial(30)</span>
<span class="sd">    265252859812191058636308480000000</span>
<span class="sd">    &gt;&gt;&gt; factorial(-1)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">    ValueError: n must be &gt;= 0</span>

<span class="sd">    Factorials of floats are OK, but the float must be an exact integer:</span>
<span class="sd">    &gt;&gt;&gt; factorial(30.1)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">    ValueError: n must be exact integer</span>
<span class="sd">    &gt;&gt;&gt; factorial(30.0)</span>
<span class="sd">    265252859812191058636308480000000</span>

<span class="sd">    It must also not be ridiculously large:</span>
<span class="sd">    &gt;&gt;&gt; factorial(1e100)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">    OverflowError: n too large</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">math</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n must be &gt;= 0&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n must be exact integer&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>  <span class="c1"># catch a value like 1e300</span>
        <span class="k">raise</span> <span class="ne">OverflowError</span><span class="p">(</span><span class="s2">&quot;n too large&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span> <span class="n">factor</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">factor</span>
        <span class="n">factor</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>
</div>
<p>L'exécution du fichier <code class="file docutils literal notranslate"><span class="pre">example.py</span></code> directement à partir de la ligne de commande démontre la magie de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> :</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>example.py
<span class="gp">$</span>
</pre></div>
</div>
<p>Il n'y a pas de sortie ! C'est normal, cela signifie que tous les exemples fonctionnent. Passez <code class="docutils literal notranslate"><span class="pre">-v</span></code> au script pour que <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> affiche un journal détaillé de ce qui a été essayé, avant d'afficher un résumé à la fin :</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>example.py<span class="w"> </span>-v
<span class="go">Trying:</span>
<span class="go">    factorial(5)</span>
<span class="go">Expecting:</span>
<span class="go">    120</span>
<span class="go">ok</span>
<span class="go">Trying:</span>
<span class="go">    [factorial(n) for n in range(6)]</span>
<span class="go">Expecting:</span>
<span class="go">    [1, 1, 2, 6, 24, 120]</span>
<span class="go">ok</span>
</pre></div>
</div>
<p>Et ainsi de suite, jusqu'à ce qu'on atteigne :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Trying:
    factorial(1e100)
Expecting:
    Traceback (most recent call last):
        ...
    OverflowError: n too large
ok
2 items passed all tests:
   1 tests in __main__
   8 tests in __main__.factorial
9 tests in 2 items.
9 passed and 0 failed.
Test passed.
$
</pre></div>
</div>
<p>C'est tout ce dont vous avez besoin pour pouvoir commencer une utilisation productive de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> ! Allez-y. Les sections suivantes donnent tous les détails. Notez qu'il y a plusieurs exemples de <em>doctests</em> dans la suite de tests de la bibliothèque standard de Python et dans les autres bibliothèques. Des exemples particulièrement utiles se situent dans le fichier de test standard <code class="file docutils literal notranslate"><span class="pre">Lib/test/test_doctest.py</span></code>.</p>
<section id="simple-usage-checking-examples-in-docstrings">
<span id="doctest-simple-testmod"></span><h2>Utilisation simple : vérifier des exemples dans des <em>docstrings</em><a class="headerlink" href="#simple-usage-checking-examples-in-docstrings" title="Lien permanent vers ce titre">¶</a></h2>
<p>Le plus simple pour commencer à utiliser <em>doctest</em> (mais pas nécessairement la façon avec laquelle vous continuerez) est de terminer chaque module <code class="xref py py-mod docutils literal notranslate"><span class="pre">M</span></code> avec :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> examine alors les <em>docstrings</em> dans le module <code class="xref py py-mod docutils literal notranslate"><span class="pre">M</span></code>.</p>
<p>Exécuter le module comme un script a comme conséquence d'exécuter et de vérifier les exemples dans les <em>docstrings</em> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">M</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Ceci n'affiche rien à moins qu'un exemple échoue ; le cas échéant, les exemples défaillants et les causes du ou des échecs sont affichés sur <em>stdout</em>, et la ligne finale de la sortie est <code class="docutils literal notranslate"><span class="pre">***Test</span> <span class="pre">Failed***</span> <span class="pre">*N</span> <span class="pre">failures*.</span></code>, où <em>N</em> est le nombre d'exemples défaillants.</p>
<p>À la place, exécutez-la avec l'option de ligne de commande <code class="docutils literal notranslate"><span class="pre">-v</span></code> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">M</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">v</span>
</pre></div>
</div>
<p>alors, un rapport détaillé de tous les exemples faisant partie de l'essai est affiché sur la sortie standard, accompagné à la fin de leurs résumés.</p>
<p>Vous pouvez activer le mode verbeux en passant <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> à <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a>, ou vous le désactiver en lui passant <code class="docutils literal notranslate"><span class="pre">verbose=False</span></code>. Dans ces deux cas, <code class="docutils literal notranslate"><span class="pre">sys.argv</span></code> n'est pas inspecté par <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a> (ainsi, lui passer <code class="docutils literal notranslate"><span class="pre">-v</span></code> ou pas n'a aucun effet).</p>
<p>Il y a un raccourci pour exécuter <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a> à partir de la ligne de commande. Vous demandez à l'interpréteur Python d'exécuter le module <em>doctest</em> directement à partir de la bibliothèque standard afin de passer le ou les noms des modules à partir de la ligne de commande ainsi :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">doctest</span> <span class="o">-</span><span class="n">v</span> <span class="n">example</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Ceci importera <code class="file docutils literal notranslate"><span class="pre">example.py</span></code> comme un module autonome et exécutera <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a> sur celui-ci. Notez que ceci peut ne pas fonctionner si le fichier fait partie d'un paquet et importe d'autres sous-modules de ce paquet.</p>
<p>Pour plus d'informations sur <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a>, consultez la section <a class="reference internal" href="#doctest-basic-api"><span class="std std-ref">API de base</span></a>.</p>
</section>
<section id="simple-usage-checking-examples-in-a-text-file">
<span id="doctest-simple-testfile"></span><h2>Utilisation simple : vérifier des exemples dans un fichier texte<a class="headerlink" href="#simple-usage-checking-examples-in-a-text-file" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une autre application simple de <em>doctest</em> est de tester des exemples interactifs dans un fichier texte. Ceci est fait avec la fonction <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">doctest</span>
<span class="n">doctest</span><span class="o">.</span><span class="n">testfile</span><span class="p">(</span><span class="s2">&quot;example.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ce court script exécute et vérifie chacun des exemples Python interactifs contenus dans le fichier <code class="file docutils literal notranslate"><span class="pre">example.txt</span></code>. Le contenu du fichier est traité comme une seule <em>docstring</em> géante ; le fichier n'a pas besoin de contenir un programme Python ! Par exemple, prenons un fichier <code class="file docutils literal notranslate"><span class="pre">example.txt</span></code> contenant :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The ``example`` module
======================

Using ``factorial``
-------------------

This is an example text file in reStructuredText format.  First import
``factorial`` from the ``example`` module:

    &gt;&gt;&gt; from example import factorial

Now use it:

    &gt;&gt;&gt; factorial(6)
    120
</pre></div>
</div>
<p>Exécuter <code class="docutils literal notranslate"><span class="pre">doctest.testfile(&quot;example.txt&quot;)</span></code> recherche les erreurs dans cette documentation :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="s2">&quot;./example.txt&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">14</span><span class="p">,</span> <span class="ow">in</span> <span class="n">example</span><span class="o">.</span><span class="n">txt</span>
<span class="n">Failed</span> <span class="n">example</span><span class="p">:</span>
    <span class="n">factorial</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">Expected</span><span class="p">:</span>
    <span class="mi">120</span>
<span class="n">Got</span><span class="p">:</span>
    <span class="mi">720</span>
</pre></div>
</div>
<p>Comme pour <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a>, <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> n'affichera rien sauf si un exemple échoue. Si un exemple échoue, alors le ou les exemples défaillants et leurs causes sont affichés sur <em>stdout</em>, dans le même format que <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a>.</p>
<p>Par défaut, <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> cherche les fichiers dans le répertoire où se situe le module qui l'appelle. Consultez la section <a class="reference internal" href="#doctest-basic-api"><span class="std std-ref">API de base</span></a> pour une description des options de ligne de commande à utiliser afin de chercher dans d'autres répertoires.</p>
<p>Comme pour <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a>, la verbosité de <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> peut être ajustée avec l'option de ligne de commande <code class="docutils literal notranslate"><span class="pre">-v</span></code> ou avec le mot clé <em>verbose</em>.</p>
<p>Il y a un raccourci pour exécuter <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> à partir de la ligne de commande.  Demandez à l'interpréteur Python d'exécuter le module <em>doctest</em> directement à partir de la bibliothèque standard et de passer le ou les noms des modules à partir de la ligne de commande ainsi :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">doctest</span> <span class="o">-</span><span class="n">v</span> <span class="n">example</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Puisque le nom du fichier ne se termine pas par <code class="file docutils literal notranslate"><span class="pre">.py</span></code>, <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> en déduit qu'il s'exécute à l'aide de <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a>, et non pas <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a>.</p>
<p>Pour plus d'information sur <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a>, consultez la section <a class="reference internal" href="#doctest-basic-api"><span class="std std-ref">API de base</span></a>.</p>
</section>
<section id="how-it-works">
<span id="doctest-how-it-works"></span><h2>Comment ça marche<a class="headerlink" href="#how-it-works" title="Lien permanent vers ce titre">¶</a></h2>
<p>Cette section examine en détail le fonctionnement de <em>doctest</em> : quelles <em>docstrings</em> sont considérées, comment sont trouvés les exemples interactifs, quel est le contexte d'exécution sélectionné, comment les exceptions sont gérées, et de quelles façons les options de ligne de commande peuvent être utilisées pour définir le comportement. Ceci est l'information dont vous avez besoin pour écrire des exemples <em>doctest</em> ; pour de l'information sur l'exécution de <em>doctest</em> sur ces exemples, consultez les sections suivantes.</p>
<section id="which-docstrings-are-examined">
<span id="doctest-which-docstrings"></span><h3>Quelles <em>docstrings</em> sont considérées ?<a class="headerlink" href="#which-docstrings-are-examined" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les <em>docstrings</em> du module, de toutes les fonctions, classes, et méthodes sont cherchées. Les objets qui sont importés dans le module ne sont pas cherchés.</p>
<p>In addition, there are cases when you want tests to be part of a module but not part
of the help text, which requires that the tests not be included in the docstring.
Doctest looks for a module-level variable called <code class="docutils literal notranslate"><span class="pre">__test__</span></code> and uses it to locate other
tests. If <code class="docutils literal notranslate"><span class="pre">M.__test__</span></code> exists and is truthy, it must be a dict, and each
entry maps a (string) name to a function object, class object, or string.
Function and class object docstrings found from <code class="docutils literal notranslate"><span class="pre">M.__test__</span></code> are searched, and
strings are treated as if they were docstrings.  In output, a key <code class="docutils literal notranslate"><span class="pre">K</span></code> in
<code class="docutils literal notranslate"><span class="pre">M.__test__</span></code> appears with name <code class="docutils literal notranslate"><span class="pre">M.__test__.K</span></code>.</p>
<p>For example, place this block of code at the top of <code class="file docutils literal notranslate"><span class="pre">example.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">__test__</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;numbers&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&gt;&gt;&gt; factorial(6)</span>
<span class="s2">720</span>

<span class="s2">&gt;&gt;&gt; [factorial(n) for n in range(6)]</span>
<span class="s2">[1, 1, 2, 6, 24, 120]</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The value of <code class="docutils literal notranslate"><span class="pre">example.__test__[&quot;numbers&quot;]</span></code> will be treated as a
docstring and all the tests inside it will be run. It is
important to note that the value can be mapped to a function,
class object, or module; if so, <code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code>
searches them recursively for docstrings, which are then scanned for tests.</p>
<p>Toute classe trouvée est ainsi cherchée récursivement, afin de tester les <em>docstrings</em> contenues dans leurs méthodes et leurs classes imbriquées.</p>
</section>
<section id="how-are-docstring-examples-recognized">
<span id="doctest-finding-examples"></span><h3>Comment les exemples <em>docstring</em> sont-ils identifiés ?<a class="headerlink" href="#how-are-docstring-examples-recognized" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans la plupart des cas, un copier-coller d'une séance interactive de console fonctionne bien, mais <em>doctest</em> n'essaye pas de faire une simulation exacte d'un <em>shell</em> Python spécifique.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># comments are ignored</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;yes&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NO&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NO!!!&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">no</span>
<span class="go">NO</span>
<span class="go">NO!!!</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p id="index-0">Toute sortie souhaitée doit immédiatement suivre le dernier <code class="docutils literal notranslate"><span class="pre">'&gt;&gt;&gt;</span> <span class="pre">'</span></code> ou le dernier <code class="docutils literal notranslate"><span class="pre">'...</span> <span class="pre">'</span></code> contenant le code, et la sortie souhaitée, s'il y en a une, s'étend jusqu'au prochain <code class="docutils literal notranslate"><span class="pre">'&gt;&gt;&gt;</span> <span class="pre">'</span></code> ou à la prochaine ligne vide.</p>
<p>En détail :</p>
<ul>
<li><p>La sortie souhaitée ne peut pas contenir une ligne vide, puisque contenir une telle ligne signale la fin de la sortie souhaitée. Si la sortie souhaitée doit contenir une ligne vide, ajoutez <code class="docutils literal notranslate"><span class="pre">&lt;BLANKLINE&gt;</span></code> dans votre exemple <em>doctest</em> à chaque endroit où une ligne vide est souhaitée.</p></li>
<li><p>Tous les caractères de tabulation insécables (<em>hard tab characters</em>) sont convertis en espaces, en utilisant des taquets de tabulation de 8 espaces. Les tabulations se trouvant dans la sortie générée par le code test ne sont pas modifiées. Comme tout caractère de tabulation insécable <em>est</em> converti, ceci veut dire que si le code de sortie inclut des caractères de tabulation insécables, alors la seule façon que le <em>doctest</em> peut réussir est si l'option <a class="reference internal" href="#doctest.NORMALIZE_WHITESPACE" title="doctest.NORMALIZE_WHITESPACE"><code class="xref py py-const docutils literal notranslate"><span class="pre">NORMALIZE_WHITESPACE</span></code></a> ou si <a class="reference internal" href="#doctest-directives"><span class="std std-ref">directive</span></a> a cours. De façon alternative, le test peut être ré-écrit afin de capturer la sortie et de la comparer à un ensemble de valeurs attendues, et ce, en tant qu'étape du test. Cette gestion des tabulations à la source a été obtenue suite à un processus d'essais et d'erreurs ; il a été démontré que c'était là la façon de les gérer qui soit la moins susceptible de générer des erreurs. Il est possible d'utiliser un algorithme différent pour la gestion des tabulations en rédigeant une classe sur mesure <a class="reference internal" href="#doctest.DocTestParser" title="doctest.DocTestParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestParser</span></code></a>.</p></li>
<li><p>La sortie vers <em>stdout</em> est capturée, mais pas la sortie vers <em>stderr</em> (les traces d'appel sont capturées par d'autres moyens).</p></li>
<li><p>Si vous souhaitez conserver les barres obliques inversées telles quelles lorsque vous terminez une ligne avec une barre oblique inversée dans une séance interactive, ou quand vous utilisez une telle barre pour toute autre raison, vous devez utiliser une <em>docstring</em> brute :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sa">r</span><span class="sd">&#39;&#39;&#39;Backslashes in a raw docstring: m\n&#39;&#39;&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="go">Backslashes in a raw docstring: m\n</span>
</pre></div>
</div>
<p>Sinon, la barre oblique inversée est interprétée comme faisant partie de la chaîne de caractères. Par exemple, le <code class="docutils literal notranslate"><span class="pre">\n</span></code> ci-dessus est interprété comme un caractère de saut de ligne. De façon alternative, vous pouvez doubler chaque barre oblique inversée dans la version <em>doctest</em> (et n'utilisez pas dans ce cas de <em>docstring</em> brute) :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Backslashes in a raw docstring: m\\n&#39;&#39;&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="go">Backslashes in a raw docstring: m\n</span>
</pre></div>
</div>
</li>
<li><p>La colonne de départ n'a pas d'importance :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="s2">&quot;Easy!&quot;</span>
<span class="go">      &gt;&gt;&gt; import math</span>
<span class="go">          &gt;&gt;&gt; math.floor(1.9)</span>
<span class="go">          1</span>
</pre></div>
</div>
<p>et autant d'espaces sont retirés de la sortie attendue qu'il y avait d'espaces avant la ligne commençant par <code class="docutils literal notranslate"><span class="pre">'&gt;&gt;&gt;</span> <span class="pre">'</span></code>.</p>
</li>
</ul>
</section>
<section id="what-s-the-execution-context">
<span id="doctest-execution-context"></span><h3>Quel est le contexte d'exécution ?<a class="headerlink" href="#what-s-the-execution-context" title="Lien permanent vers ce titre">¶</a></h3>
<p>Par défaut, chaque fois que <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> trouve une <em>docstring</em> à tester, il utilise une <em>copie superficielle</em> des variables globales de <code class="xref py py-mod docutils literal notranslate"><span class="pre">M</span></code>, de telle façon que l'exécution de tests ne change pas les variables globales réelles du module et que l'exécution d'un unique test dans <code class="xref py py-mod docutils literal notranslate"><span class="pre">M</span></code> ne puisse laisser traîner des miettes pouvant accidentellement causer la réussite d'un autre test. Ceci signifie que les exemples peuvent utiliser librement n'importe quel nom défini au niveau supérieur dans <code class="xref py py-mod docutils literal notranslate"><span class="pre">M</span></code> ainsi que les noms définis précédemment dans la <em>docstring</em> en cours d'exécution. Les exemples ne peuvent voir les noms définis dans d'autres <em>docstrings</em>.</p>
<p>Vous pouvez forcer l'utilisation de votre propre <em>dict</em> comme contexte d'exécution en passant <code class="docutils literal notranslate"><span class="pre">globs=your_dict</span></code> à <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a> ou encore, à <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a>.</p>
</section>
<section id="what-about-exceptions">
<span id="doctest-exceptions"></span><h3>Qu'en est-il des exceptions ?<a class="headerlink" href="#what-about-exceptions" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pas de problèmes, tant que la trace d'appels est la seule sortie produite par l'exemple : il suffit d'ajouter la trace. <a class="footnote-reference brackets" href="#id2" id="id1">1</a> Comme les traces d'appels contiennent des détails qui sont sujets à changement rapide (par exemple, le chemin exact vers un fichier et les numéros de ligne), ceci est un cas où <em>doctest</em> fait un effort pour être flexible dans ce qu'il accepte.</p>
<p>Exemple simple :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">ValueError</span>: <span class="n">list.remove(x): x not in list</span>
</pre></div>
</div>
<p>Ce <em>doctest</em> réussit si <a class="reference internal" href="exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> est levée, avec le détail <code class="docutils literal notranslate"><span class="pre">list.remote(x):</span> <span class="pre">x</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">list</span></code> tel que montré.</p>
<p>La sortie attendue pour une exception doit commencer par un en-tête de trace d'appels, qui peut être l'une des deux lignes suivantes, avec la même indentation que la première ligne de l'exemple :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">innermost</span> <span class="n">last</span><span class="p">):</span>
</pre></div>
</div>
<p>L'en-tête de la trace d'appels est suivi par une pile optionnelle de trace d'appels, dont le contenu est ignoré par <em>doctest</em>. La trace d'appels est habituellement omise, ou est copiée verbatim à partir d'une séance interactive.</p>
<p>La pile de trace d'appels est suivie par la partie la plus intéressante : la ou les lignes contenant le type et le détail de l'exception. Ceci est habituellement la dernière ligne de la trace d'appels ; dans le cas où l'exception a un détail sur plusieurs lignes, il est possible de prolonger sur plusieurs lignes :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;multi</span><span class="se">\n</span><span class="s1">    line</span><span class="se">\n</span><span class="s1">detail&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">ValueError</span>: <span class="n">multi</span>
<span class="x">    line</span>
<span class="x">detail</span>
</pre></div>
</div>
<p>Les trois dernières lignes (en commençant par <a class="reference internal" href="exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>) sont comparées avec le type et le détail de l'exception ; tout le reste est ignoré.</p>
<p>La pratique optimale est d'omettre la pile de trace d'appels, à moins que celle-ci ait une valeur significative de documentation de l'exemple. Ainsi, le dernier exemple est probablement meilleur tel qui suit :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;multi</span><span class="se">\n</span><span class="s1">    line</span><span class="se">\n</span><span class="s1">detail&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">multi</span>
<span class="x">    line</span>
<span class="x">detail</span>
</pre></div>
</div>
<p>Prenez note que les traces d'appels sont traitées de façon vraiment particulière. Précisément, dans l'exemple ré-écrit, l'utilisation de <code class="docutils literal notranslate"><span class="pre">...</span></code> est indépendante de l'option <em>doctest</em> <a class="reference internal" href="#doctest.ELLIPSIS" title="doctest.ELLIPSIS"><code class="xref py py-const docutils literal notranslate"><span class="pre">ELLIPSIS</span></code></a>. Les points de suspension dans cet exemple peuvent être omis, ou peuvent aussi être trois (ou trois cents) virgules ou chiffres, ou une retranscription indentée d'une parodie de Monty Python.</p>
<p>Quelques détails que vous devriez lire une fois, mais que vous pouvez oublier :</p>
<ul class="simple">
<li><p><em>Doctest</em> ne peut pas deviner si votre sortie attendue provient d'une trace d'appels issue d'une exception ou d'un affichage ordinaire. Ainsi, si nous avons un exemple s'attendant à obtenir <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">42</span> <span class="pre">is</span> <span class="pre">prime</span></code>, celui-ci réussira peu importe si <a class="reference internal" href="exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> est réellement levée ou si l'exemple affiche simplement ce texte de trace d'appels. Dans la pratique, une sortie ordinaire commence rarement par une ligne d'en-tête de trace d'appels ; ainsi, ceci ne pose pas de vrai problème.</p></li>
<li><p>Chaque ligne de la trace d'appel (s'il y en a) doit soit être indentée d'un niveau supplémentaire au niveau de la première ligne de l'exemple <em>ou</em> doit commencer par un caractère qui ne soit pas alphanumérique. La première ligne suivant l'en-tête de la trace d'appels qui soit indentée similairement et qui commence par un caractère alphanumérique est comprise comme étant le début du détail de l'exception. Bien sûr, ceci fait la chose adéquate pour les traces d'appels véritables.</p></li>
<li><p>Lorsque l'option de <em>doctest</em> <a class="reference internal" href="#doctest.IGNORE_EXCEPTION_DETAIL" title="doctest.IGNORE_EXCEPTION_DETAIL"><code class="xref py py-const docutils literal notranslate"><span class="pre">IGNORE_EXCEPTION_DETAIL</span></code></a> est définie, tout ce qui suit le point-virgule se trouvant le plus à gauche ainsi que toute information liée au module dans le nom de l'exception sont ignorés.</p></li>
<li><p>Le shell interactif omet la ligne d'en-tête de la trace d'appels pour certaines erreurs <a class="reference internal" href="exceptions.html#SyntaxError" title="SyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxError</span></code></a>. Ceci étant dit, <em>doctest</em> utilise la ligne d'en-tête de la trace d'appels afin de faire une distinction entre les exceptions et les autres types d'erreurs. Ainsi, dans les rares cas où vous avez besoin de tester une erreur <a class="reference internal" href="exceptions.html#SyntaxError" title="SyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxError</span></code></a> qui omet l'en-tête de la trace d'appels, il vous est nécessaire d'ajouter manuellement la ligne d'en-tête de la trace d'appels à l'exemple de test.</p></li>
</ul>
<ul id="index-1">
<li><p>For some exceptions, Python displays the position of the error using <code class="docutils literal notranslate"><span class="pre">^</span></code>
markers and tildes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span> <span class="o">+</span> <span class="kc">None</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>
<span class="w">    </span><span class="mi">1</span> <span class="o">+</span> <span class="kc">None</span>
<span class="w">    </span><span class="pm">~~^~~~~~</span>
<span class="gr">TypeError</span>: <span class="n">unsupported operand type(s) for +: &#39;int&#39; and &#39;NoneType&#39;</span>
</pre></div>
</div>
<p>Comme les lignes dénotant la position de l'erreur précèdent le type et le détail de l'exception, elles ne sont pas vérifiées par <em>doctest</em>. Par exemple, le test suivant réussira, même si le marqueur <code class="docutils literal notranslate"><span class="pre">^</span></code> n'est pas à la bonne place :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span> <span class="o">+</span> <span class="kc">None</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>
<span class="w">    </span><span class="mi">1</span> <span class="o">+</span> <span class="kc">None</span>
<span class="w">    </span><span class="pm">^~~~~~~~</span>
<span class="gr">TypeError</span>: <span class="n">unsupported operand type(s) for +: &#39;int&#39; and &#39;NoneType&#39;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="option-flags">
<span id="doctest-options"></span><span id="option-flags-and-directives"></span><h3>Options de ligne de commande<a class="headerlink" href="#option-flags" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un ensemble d'options de ligne de commande contrôle différents aspects du comportement de <em>doctest</em>. Pour les options, des noms symboliques sont fournis comme des constantes de module, qui peuvent être composés par un OU bit à bit (<a class="reference internal" href="../reference/expressions.html#bitwise"><span class="std std-ref">bitwise ORed</span></a>) et passés à diverses fonctions. Les noms peuvent aussi être utilisés dans des <a class="reference internal" href="#doctest-directives"><span class="std std-ref">instructions doctest</span></a>, et peuvent être passés à l'interface de ligne de commande de <em>doctest</em> à l'aide de l'option <code class="docutils literal notranslate"><span class="pre">-o</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Nouveau dans la version 3.4: </span>L'option de ligne de commande <code class="docutils literal notranslate"><span class="pre">-o</span></code>.</p>
</div>
<p>Le premier groupe d'options définit les sémantiques de test, de façon à contrôler comment <em>doctest</em> décide si la sortie obtenue correspond à la sortie attendue de l'exemple :</p>
<dl class="py data">
<dt class="sig sig-object py" id="doctest.DONT_ACCEPT_TRUE_FOR_1">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DONT_ACCEPT_TRUE_FOR_1</span></span><a class="headerlink" href="#doctest.DONT_ACCEPT_TRUE_FOR_1" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Par défaut, si un bloc de sortie attendu contient uniquement un <code class="docutils literal notranslate"><span class="pre">1</span></code>, un vrai bloc de sortie contenant uniquement un <code class="docutils literal notranslate"><span class="pre">1</span></code> ou un <code class="docutils literal notranslate"><span class="pre">True</span></code> sera considéré comme étant une correspondance ; de façon similaire, nous avons une correspondance pour <code class="docutils literal notranslate"><span class="pre">0</span></code> et <code class="docutils literal notranslate"><span class="pre">False</span></code>. Lorsque l'option <a class="reference internal" href="#doctest.DONT_ACCEPT_TRUE_FOR_1" title="doctest.DONT_ACCEPT_TRUE_FOR_1"><code class="xref py py-const docutils literal notranslate"><span class="pre">DONT_ACCEPT_TRUE_FOR_1</span></code></a> est précisée, aucune de ces substitutions n'est acceptée. Le comportement par défaut s'ajuste au fait que Python a changé le type de renvoi de plusieurs fonctions, passant de nombres entiers à des booléens ; les <em>doctests</em> s'attendant à une sortie de &quot;petit entier&quot; (<em>little integer</em>) fonctionnent encore dans ces cas. Cette option disparaîtra probablement, mais pas avant plusieurs années.</p>
</dd></dl>

<span class="target" id="index-2"></span><dl class="py data">
<dt class="sig sig-object py" id="doctest.DONT_ACCEPT_BLANKLINE">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DONT_ACCEPT_BLANKLINE</span></span><a class="headerlink" href="#doctest.DONT_ACCEPT_BLANKLINE" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Par défaut, si un bloc de sortie attendue contient une ligne contenant uniquement la chaîne de caractères <code class="docutils literal notranslate"><span class="pre">&lt;BLANKLINE&gt;</span></code>, alors cette ligne sera en correspondance avec une ligne vide dans la sortie réelle. Puisqu'une véritable ligne vide permet de délimiter la sortie attendue, ceci est la seule façon de communiquer qu'une ligne vide est souhaitée. Lorsque l'option <a class="reference internal" href="#doctest.DONT_ACCEPT_BLANKLINE" title="doctest.DONT_ACCEPT_BLANKLINE"><code class="xref py py-const docutils literal notranslate"><span class="pre">DONT_ACCEPT_BLANKLINE</span></code></a> est précisée, cette substitution n'est pas permise.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.NORMALIZE_WHITESPACE">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">NORMALIZE_WHITESPACE</span></span><a class="headerlink" href="#doctest.NORMALIZE_WHITESPACE" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, toutes les séquences de caractères d'espacement et de caractères de saut de ligne sont traitées comme équivalentes. Toute séquence de caractères d'espacement à l'intérieur de la sortie attendue correspondra alors à toute séquence de caractères d'espacement à l'intérieur de la sortie réelle. Par défaut, les caractères d'espacement doivent correspondre de façon exacte. L'option <a class="reference internal" href="#doctest.NORMALIZE_WHITESPACE" title="doctest.NORMALIZE_WHITESPACE"><code class="xref py py-const docutils literal notranslate"><span class="pre">NORMALIZE_WHITESPACE</span></code></a> est particulièrement utile lorsqu'une ligne de sortie attendue est très longue, et que l'on souhaite la répartir sur plusieurs lignes dans le fichier source.</p>
</dd></dl>

<span class="target" id="index-3"></span><dl class="py data">
<dt class="sig sig-object py" id="doctest.ELLIPSIS">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">ELLIPSIS</span></span><a class="headerlink" href="#doctest.ELLIPSIS" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, un marqueur de points de suspension (<code class="docutils literal notranslate"><span class="pre">...</span></code>) dans la sortie attendue peut correspondre à n'importe quelle partie de chaîne de caractères dans la sortie réelle. Ceci inclut les parties qui traversent les frontières de lignes, ainsi que les parties vides de chaînes de caractères ; ainsi, il est préférable d'en faire une utilisation simple. Les usages complexes mènent aux mêmes surprises du type &quot;oups, il y avait trop de correspondances !&quot; que l'utilisation de <code class="docutils literal notranslate"><span class="pre">.*</span></code> dans les expressions régulières.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.IGNORE_EXCEPTION_DETAIL">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">IGNORE_EXCEPTION_DETAIL</span></span><a class="headerlink" href="#doctest.IGNORE_EXCEPTION_DETAIL" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>When specified, doctests expecting exceptions pass so long as an exception
of the expected type is raised, even if the details
(message and fully qualified exception name) don't match.</p>
<p>For example, an example expecting <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">42</span></code> will pass if the actual
exception raised is <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">3*14</span></code>, but will fail if, say, a
<a class="reference internal" href="exceptions.html#TypeError" title="TypeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> is raised instead.
It will also ignore any fully qualified name included before the
exception class, which can vary between implementations and versions
of Python and the code/libraries in use.
Hence, all three of these variations will work with the flag specified:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">Exception</span>: <span class="n">message</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">builtins.Exception</span>: <span class="n">message</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">__main__.Exception</span>: <span class="n">message</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="#doctest.ELLIPSIS" title="doctest.ELLIPSIS"><code class="xref py py-const docutils literal notranslate"><span class="pre">ELLIPSIS</span></code></a> can also be used to ignore the
details of the exception message, but such a test may still fail based
on whether the module name is present or matches exactly.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Modifié dans la version 3.2: </span>Maintenant, <a class="reference internal" href="#doctest.IGNORE_EXCEPTION_DETAIL" title="doctest.IGNORE_EXCEPTION_DETAIL"><code class="xref py py-const docutils literal notranslate"><span class="pre">IGNORE_EXCEPTION_DETAIL</span></code></a> permet aussi d'ignorer toute information liée au module contenant l'exception qui est en train d'être testée.</p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.SKIP">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">SKIP</span></span><a class="headerlink" href="#doctest.SKIP" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, cesse complètement l'exécution de tous les exemples. Ceci peut être utile dans des contextes où les exemples <em>doctest</em> sont à la fois de la documentation et des cas de tests, et qu'un exemple doit être inclus pour des raisons de documentation, mais ne devrait pas être vérifié. Par exemple, la sortie de l'exemple doit être aléatoire ; ou encore, lorsque l'exemple peut dépendre de ressources inatteignables pour l'exécuteur de test.</p>
<p>L'option <em>SKIP</em> peut aussi être utilisée temporairement afin de commenter des exemples et d'en empêcher l'exécution.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.COMPARISON_FLAGS">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">COMPARISON_FLAGS</span></span><a class="headerlink" href="#doctest.COMPARISON_FLAGS" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Un masque binaire effectuant une composition avec OU de toutes les options de comparaisons ci-dessus.</p>
</dd></dl>

<p>Le deuxième groupe d'options détermine comment les échecs de tests sont signalés :</p>
<dl class="py data">
<dt class="sig sig-object py" id="doctest.REPORT_UDIFF">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">REPORT_UDIFF</span></span><a class="headerlink" href="#doctest.REPORT_UDIFF" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, les défaillances qui font intervenir des sorties attendues et réelles multi-lignes sont affichées dans une <em>diff</em> unifiée.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.REPORT_CDIFF">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">REPORT_CDIFF</span></span><a class="headerlink" href="#doctest.REPORT_CDIFF" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, les défaillances qui font intervenir des sorties attendues et réelles multi-lignes sont affichées dans une <em>diff</em> de contexte.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.REPORT_NDIFF">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">REPORT_NDIFF</span></span><a class="headerlink" href="#doctest.REPORT_NDIFF" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, les différences sont obtenues grâce à <code class="docutils literal notranslate"><span class="pre">difflib.Differ</span></code>, en utilisant le même algorithme que le populaire utilitaire <code class="file docutils literal notranslate"><span class="pre">ndiff.py</span></code>. Ceci est la seule méthode qui puisse faire la différence à l'intérieur des lignes ainsi que parmi les lignes prises conjointement. Par exemple, si une ligne de sortie attendue contient le chiffre <code class="docutils literal notranslate"><span class="pre">1</span></code> alors que la sortie réelle contient la lettre <code class="docutils literal notranslate"><span class="pre">l</span></code>, une ligne est insérée avec un marqueur caret démarquant les positions de colonnes où il n'y a pas de correspondance.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.REPORT_ONLY_FIRST_FAILURE">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">REPORT_ONLY_FIRST_FAILURE</span></span><a class="headerlink" href="#doctest.REPORT_ONLY_FIRST_FAILURE" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, le premier exemple défaillant de chaque <em>doctest</em> est affiché, mais la sortie est supprimée pour tous les autres exemples. Ceci empêche <em>doctest</em> de rapporter les exemples adéquats qui échouent du fait d'échecs précédents ; ceci peut aussi cacher des exemples inadéquats qui échouent de façon indépendante au premier échec. Lorsque <a class="reference internal" href="#doctest.REPORT_ONLY_FIRST_FAILURE" title="doctest.REPORT_ONLY_FIRST_FAILURE"><code class="xref py py-const docutils literal notranslate"><span class="pre">REPORT_ONLY_FIRST_FAILURE</span></code></a> est précisé, les exemples restants sont toujours exécutés, et sont toujours comptabilisés dans le nombre total des lignes échouant ; seulement la sortie est omise.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.FAIL_FAST">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">FAIL_FAST</span></span><a class="headerlink" href="#doctest.FAIL_FAST" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Lorsque précisé, mettre fin à l'exécution après le premier exemple défaillant et ne pas essayer d'exécuter les exemples restants. Ainsi, le nombre d'échecs rapporté sera au plus un (1). Cette option peut être utile durant le débogage, étant donné que les exemples suivant le premier échec ne produiront aucune sortie de débogage.</p>
<p>La ligne de commande de <em>doctest</em> accepte l'option <code class="docutils literal notranslate"><span class="pre">-f</span></code> comme un raccourci de <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">FAIL_FAST</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Nouveau dans la version 3.4.</span></p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="doctest.REPORTING_FLAGS">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">REPORTING_FLAGS</span></span><a class="headerlink" href="#doctest.REPORTING_FLAGS" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Un masque binaire effectuant une composition avec le OU de toutes les options de signalement ci-dessus.</p>
</dd></dl>

<p>Il y a aussi une façon d'enregistrer des nouveaux noms d'option, quoique ceci n'est pas utile sauf dans le cas où vous devez faire une extension pour le code interne de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> par le biais d'une sous-classe :</p>
<dl class="py function">
<dt class="sig sig-object py" id="doctest.register_optionflag">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">register_optionflag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.register_optionflag" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Crée une nouvelle option avec un nom donné, et renvoie la valeur en nombre entier de la nouvelle option. La fonction <a class="reference internal" href="#doctest.register_optionflag" title="doctest.register_optionflag"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_optionflag()</span></code></a> peut être utilisée lors de la création de sous-classes à partir de <a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a> ou <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> pour créer de nouvelles options qui sont supportées par vos sous-classes. La fonction <a class="reference internal" href="#doctest.register_optionflag" title="doctest.register_optionflag"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_optionflag()</span></code></a> devrait toujours être appelée par l'expression suivante :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">MY_FLAG</span> <span class="o">=</span> <span class="n">register_optionflag</span><span class="p">(</span><span class="s1">&#39;MY_FLAG&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="directives">
<span id="doctest-directives"></span><span id="index-4"></span><h3>Instructions<a class="headerlink" href="#directives" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les instructions <em>doctest</em> peuvent être utilisées afin de modifier les <a class="reference internal" href="#doctest-options"><span class="std std-ref">options</span></a> pour un exemple individuel. Les instructions <em>doctest</em> sont des commentaires Python spéciaux suivant le code source d'un exemple :</p>
<pre>
<strong id="grammar-token-doctest-directive"><span id="grammar-token-directive"></span>directive            </strong> ::=  &quot;#&quot; &quot;doctest:&quot; <a class="reference internal" href="#grammar-token-doctest-directive_options"><code class="xref docutils literal notranslate"><span class="pre">directive_options</span></code></a>
<strong id="grammar-token-doctest-directive_options"><span id="grammar-token-directive-options"></span>directive_options    </strong> ::=  <a class="reference internal" href="#grammar-token-doctest-directive_option"><code class="xref docutils literal notranslate"><span class="pre">directive_option</span></code></a> (&quot;,&quot; <a class="reference internal" href="#grammar-token-doctest-directive_option"><code class="xref docutils literal notranslate"><span class="pre">directive_option</span></code></a>)*
<strong id="grammar-token-doctest-directive_option"><span id="grammar-token-directive-option"></span>directive_option     </strong> ::=  <a class="reference internal" href="#grammar-token-doctest-on_or_off"><code class="xref docutils literal notranslate"><span class="pre">on_or_off</span></code></a> <a class="reference internal" href="#grammar-token-doctest-directive_option_name"><code class="xref docutils literal notranslate"><span class="pre">directive_option_name</span></code></a>
<strong id="grammar-token-doctest-on_or_off"><span id="grammar-token-on-or-off"></span>on_or_off            </strong> ::=  &quot;+&quot; | &quot;-&quot;
<strong id="grammar-token-doctest-directive_option_name"><span id="grammar-token-directive-option-name"></span>directive_option_name</strong> ::=  &quot;DONT_ACCEPT_BLANKLINE&quot; | &quot;NORMALIZE_WHITESPACE&quot; | ...
</pre>
<p>Whitespace is not allowed between the <code class="docutils literal notranslate"><span class="pre">+</span></code> or <code class="docutils literal notranslate"><span class="pre">-</span></code> and the directive option
name.  The directive option name can be any of the option flag names explained
above.</p>
<p>Les instructions d'un exemple <em>doctest</em> modifient le comportement de <em>doctest</em> et ce, seulement pour cet exemple. Utilisez <code class="docutils literal notranslate"><span class="pre">+</span></code> pour activer le comportement nommé, ou <code class="docutils literal notranslate"><span class="pre">-</span></code> pour le désactiver.</p>
<p>For example, this test passes:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>  <span class="c1"># doctest: +NORMALIZE_WHITESPACE</span>
<span class="go">[0,   1,  2,  3,  4,  5,  6,  7,  8,  9,</span>
<span class="go">10,  11, 12, 13, 14, 15, 16, 17, 18, 19]</span>
</pre></div>
</div>
<p>Without the directive it would fail, both because the actual output doesn't have
two blanks before the single-digit list elements, and because the actual output
is on a single line.  This test also passes, and also requires a directive to do
so:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">[0, 1, ..., 18, 19]</span>
</pre></div>
</div>
<p>Multiple directives can be used on a single physical line, separated by
commas:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>  <span class="c1"># doctest: +ELLIPSIS, +NORMALIZE_WHITESPACE</span>
<span class="go">[0,    1, ...,   18,    19]</span>
</pre></div>
</div>
<p>If multiple directive comments are used for a single example, then they are
combined:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="gp">... </span>                        <span class="c1"># doctest: +NORMALIZE_WHITESPACE</span>
<span class="go">[0,    1, ...,   18,    19]</span>
</pre></div>
</div>
<p>As the previous example shows, you can add <code class="docutils literal notranslate"><span class="pre">...</span></code> lines to your example
containing only directives.  This can be useful when an example is too long for
a directive to comfortably fit on the same line:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">)))</span>
<span class="gp">... </span><span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">[0, ..., 4, 10, ..., 19, 30, ..., 39]</span>
</pre></div>
</div>
<p>Prendre note que puisque toutes les options sont désactivées par défaut, et comme les instructions s'appliquent uniquement aux exemples dans lesquelles elles apparaissent, activer les options (par le biais de <code class="docutils literal notranslate"><span class="pre">+</span></code> dans une instruction) est habituellement le seul choix ayant du sens. Toutefois, les options peuvent aussi être passées aux fonctions qui exécutent les <em>doctests</em>, définissant de nouvelles valeurs par défaut. Dans de tels cas, désactiver une option par l'utilisation de <code class="docutils literal notranslate"><span class="pre">-</span></code> dans une instruction peut être utile.</p>
</section>
<section id="warnings">
<span id="doctest-warnings"></span><h3>Avertissements<a class="headerlink" href="#warnings" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le module <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> est rigoureux pour ce qui est d'inclure des correspondances exactes dans la sortie attendue. Si un seul caractère ne correspond pas, le test échoue. Ceci vous surprendra probablement quelques fois, alors que vous apprenez exactement ce que Python garantit et ne garantit pas pour qui est des sorties. Par exemple, lorsqu'on affiche un ensemble (set), Python ne garantit pas que les éléments sont affichés dans un ordre particulier ; ainsi un test tel que</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">()</span>
<span class="go">{&quot;Hermione&quot;, &quot;Harry&quot;}</span>
</pre></div>
</div>
<p>est vulnérable ! Une alternative est de faire</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;Hermione&quot;</span><span class="p">,</span> <span class="s2">&quot;Harry&quot;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
<p>à la place. Une autre façon de faire est</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">foo</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">[&#39;Harry&#39;, &#39;Hermione&#39;]</span>
</pre></div>
</div>
<p>Il y en a d'autres, mais vous saisissez l'idée.</p>
<p>Another bad idea is to print things that embed an object address, like</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># certain to fail some of the time  </span>
<span class="go">7948648</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">()</span>  <span class="c1"># the default repr() for instances embeds an address   </span>
<span class="go">&lt;C object at 0x00AC18F0&gt;</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#doctest.ELLIPSIS" title="doctest.ELLIPSIS"><code class="xref py py-const docutils literal notranslate"><span class="pre">ELLIPSIS</span></code></a> directive gives a nice approach for the last example:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">()</span>  <span class="c1"># doctest: +ELLIPSIS</span>
<span class="go">&lt;C object at 0x...&gt;</span>
</pre></div>
</div>
<p>Les nombres à virgule flottante sont aussi sujets à de petites variations à la sortie, tout dépendamment de la plateforme utilisée, étant donné que Python s'en remet à la bibliothèque de la plateforme C pour la mise-en-forme des <em>floats</em>, et les bibliothèques C varient grandement pour ce qui de leur qualité sur ce point.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">1.</span><span class="o">/</span><span class="mi">7</span>  <span class="c1"># risky</span>
<span class="go">0.14285714285714285</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># safer</span>
<span class="go">0.142857142857</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="c1"># much safer</span>
<span class="go">0.142857</span>
</pre></div>
</div>
<p>Numbers of the form <code class="docutils literal notranslate"><span class="pre">I/2.**J</span></code> are safe across all platforms, and I often
contrive doctest examples to produce numbers of that form:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">3.</span><span class="o">/</span><span class="mi">4</span>  <span class="c1"># utterly safe</span>
<span class="go">0.75</span>
</pre></div>
</div>
<p>Les fractions simples sont aussi plus faciles à comprendre, et cela fait une meilleure documentation.</p>
</section>
</section>
<section id="basic-api">
<span id="doctest-basic-api"></span><h2>API de base<a class="headerlink" href="#basic-api" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les fonctions <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a> et <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> fournissent une interface simple pour <em>doctest</em> qui est suffisante pour les cas d'usage les plus élémentaires. Pour une introduction moins formelle à ces deux fonctions, voir les sections <a class="reference internal" href="#doctest-simple-testmod"><span class="std std-ref">Utilisation simple : vérifier des exemples dans des docstrings</span></a> et <a class="reference internal" href="#doctest-simple-testfile"><span class="std std-ref">Utilisation simple : vérifier des exemples dans un fichier texte</span></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="doctest.testfile">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">testfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">package</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraglobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DocTestParser()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.testfile" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Tous les arguments sauf <em>filename</em> sont optionnels, et doivent être précisés sous forme lettrée.</p>
<p>Teste les exemples dans le fichier nommé <em>filename</em>. Renvoie <code class="docutils literal notranslate"><span class="pre">(failure_count,</span> <span class="pre">test_count)</span></code>.</p>
<p>L'argument optionnel <em>module_relative</em> précise comment le nom de fichier doit être interprété :</p>
<ul class="simple">
<li><p>Si <em>module_relative</em> prend la valeur <code class="docutils literal notranslate"><span class="pre">True</span></code> (la valeur par défaut), alors <em>filename</em> précise un chemin relatif au module qui soit indépendant du système d'exploitation (<em>OS</em>). Par défaut, ce chemin est relatif au répertoire du module appelant ; mais si l'argument <em>package</em> est précisé, alors il est relatif à ce paquet. Pour garantir l'indépendance quant au système d'exploitation, <em>filename</em> doit utiliser des caractères <code class="docutils literal notranslate"><span class="pre">/</span></code> pour séparer chaque segment de chemin, et ne peut pas être un chemin absolu (c'est-à-dire qu'il ne peut pas commencer par <code class="docutils literal notranslate"><span class="pre">/</span></code>).</p></li>
<li><p>Si <em>module_relative</em> prend la valeur <code class="docutils literal notranslate"><span class="pre">False</span></code>, alors <em>filename</em> précise un chemin en fonction du système d'exploitation. Le chemin peut être absolu ou relatif ; les chemins relatifs sont résolus en rapport au répertoire actif.</p></li>
</ul>
<p>L'option <em>name</em> désigne le nom du test ; par défaut, ou si <code class="docutils literal notranslate"><span class="pre">None</span></code> est passé en argument, <code class="docutils literal notranslate"><span class="pre">os.path.basename(filename)</span></code> est utilisé.</p>
<p>L'option <em>package</em> est un paquet Python ou le nom d'un paquet Python dont le répertoire doit être utilisé comme le répertoire principal pour un nom de fichier lié à un module. Si aucun paquet n'est spécifié, le répertoire du module appelé à l'exécution est utilisé comme le répertoire principal pour les noms de fichiers liés au module. C'est une erreur que de spécifier <em>package</em> si <em>module_relative</em> a <code class="docutils literal notranslate"><span class="pre">False</span></code> comme valeur.</p>
<p>L'option <em>globs</em> spécifie un <em>dict</em> à utiliser comme <em>globals</em> lorsque des exemples sont exécutés. Une copie superficielle de ce <em>dict</em> est créée pour le <em>doctest</em> ; ainsi, ces exemples commencent avec un état vide. Par défaut, ou si <code class="docutils literal notranslate"><span class="pre">None</span></code> est passé en argument, un nouveau <em>dict</em> vide est utilisé.</p>
<p>L'option <em>extraglobs</em> spécifie un <em>dict</em> intégré dans les variables globales utilisées pour exécuter l'exemple. Ceci fonctionne comme <a class="reference internal" href="stdtypes.html#dict.update" title="dict.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dict.update()</span></code></a> : si <em>globs</em> et <em>extraglobs</em> ont une clé commune, la valeur associée à <em>extraglobs</em> apparaît dans le <em>dict</em> combiné. Par défaut, ou si <code class="docutils literal notranslate"><span class="pre">None</span></code> est passé en argument, aucune variable globale supplémentaire est utilisée. Ceci est une fonctionnalité avancée qui permet la configuration des <em>doctests</em>. Par exemple, un <em>doctest</em> peut être rédigé pour une classe de base, en utilisant un nom générique pour la classe, puis réutilisé afin de tester un nombre indéfini de sous-classes en passant un <em>dict</em> <em>extraglobs</em> reliant le nom générique à la sous-classe qui doit être testée.</p>
<p>L'option <em>verbose</em> affiche une grande quantité d'information si elle est vraie, et affiche uniquement les défaillances si elle est fausse ; par défaut, ou si <code class="docutils literal notranslate"><span class="pre">None</span></code>, celle-ci est vraie si et seulement si <code class="docutils literal notranslate"><span class="pre">-v</span></code> est présent dans <code class="docutils literal notranslate"><span class="pre">sys.argv</span></code>.</p>
<p>L'option <em>report</em> affiche un résumé à la fin lorsque vraie ; sinon, rien n'est affiché à la fin. En mode <em>verbose</em>, le résumé est détaillé, sinon le résumé est très bref (en fait, vide si tous les tests ont réussi).</p>
<p>L'option <em>optionflags</em> (dont la valeur par défaut est de zéro) calcule la valeur <a class="reference internal" href="../reference/expressions.html#bitwise"><span class="std std-ref">bitwise OR</span></a> des options de ligne de commande. Voir la section <a class="reference internal" href="#doctest-options"><span class="std std-ref">Options de ligne de commande</span></a>.</p>
<p>L'option <em>raise_on_error</em> est fausse par défaut. Si elle est vraie, une exception est levée à la première défaillance ou à la première exception qui ne soit prévue dans l'exemple. Ceci permet aux défaillances d'être analysées lors d'un post-mortem. Le comportement par défaut est de poursuivre l'exécution des exemples.</p>
<p>L'option <em>parser</em> définit une classe ou une sous-classe <a class="reference internal" href="#doctest.DocTestParser" title="doctest.DocTestParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestParser</span></code></a> qui doit être utilisée pour extraire les tests des fichiers. Par défaut, on utilise un analyseur normal (c'est-à-dire, <code class="docutils literal notranslate"><span class="pre">DocTestParser()</span></code>).</p>
<p>L'option <em>encoding</em> définit un encodage à utiliser pour convertir le fichier en format <em>unicode</em>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="doctest.testmod">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">testmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraglobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_on_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.testmod" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Toutes les options sont facultatives, et toutes sauf <em>m</em> doivent être définies en format lettré.</p>
<p>Ceci teste les exemples en <em>docstrings</em> dans les fonctions et les classes accessibles depuis le module <em>m</em> (ou depuis le module <a class="reference internal" href="__main__.html#module-__main__" title="__main__: The environment where top-level code is run. Covers command-line interfaces, import-time behavior, and ``__name__ == '__main__'``."><code class="xref py py-mod docutils literal notranslate"><span class="pre">__main__</span></code></a> si <em>m</em> n'a pas été défini ou est <code class="docutils literal notranslate"><span class="pre">None</span></code>), en commençant par <code class="docutils literal notranslate"><span class="pre">m.__doc__</span></code>.</p>
<p>Ceci teste aussi les exemples accessibles depuis le <em>dict</em> <code class="docutils literal notranslate"><span class="pre">m.__test__</span></code>, si et seulement s'il existe et qu'il n'est pas <code class="docutils literal notranslate"><span class="pre">None</span></code>.  Le <em>dict</em> <code class="docutils literal notranslate"><span class="pre">m.__test__</span></code> associe des noms (chaînes de caractères) à des fonctions, des classes et des chaînes de caractères ; les <em>docstrings</em> de fonctions et de classes sont fouillées pour des exemples ; les chaînes de caractères sont fouillées directement, comme si elles étaient des <em>docstrings</em>.</p>
<p>Seulement les <em>docstrings</em> attribuées à des objets appartenant au module <em>m</em> sont fouillées.</p>
<p>Renvoie <code class="docutils literal notranslate"><span class="pre">(failure_count,</span> <span class="pre">test_count)</span></code>.</p>
<p>L'option <em>name</em> donne le nom du module ; par défaut, ou si <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">m.__name__</span></code> est utilisé.</p>
<p>L'option <em>exclude_empty</em> prend la valeur faux par défaut. Si la valeur est vraie, les objets pour lesquels aucun <em>doctest</em> n'est trouvé ne sont pas pris en compte. Le défaut est un bricolage permettant la compatibilité à rebours, de façon à ce que le code qui utilise toujours <code class="xref py py-meth docutils literal notranslate"><span class="pre">doctest.master.summarize()</span></code> en conjonction avec <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a> puisse continuer d'obtenir des sorties pour les objets n'ayant aucun test. L'option <em>exclude_empty</em> dans  le constructeur de la classe plus récente <a class="reference internal" href="#doctest.DocTestFinder" title="doctest.DocTestFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestFinder</span></code></a> prend vrai comme valeur par défaut.</p>
<p>Les options <em>extraglobs</em>, <em>verbose</em>, <em>report</em>, <em>optionflags</em>, <em>raise_on_error</em>, et <em>globs</em> sont les mêmes que pour la fonction <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> ci-dessus, sauf pour <em>globs</em>, qui est <code class="docutils literal notranslate"><span class="pre">m.__dict__</span></code> par défaut.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="doctest.run_docstring_examples">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">run_docstring_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NoName'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compileflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.run_docstring_examples" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Les exemples de test associés à l'objet <em>f</em> ; par exemple, <em>f</em> peut être une chaîne de caractères, un module, une fonction, ou un objet de classe.</p>
<p>Une copie superficielle de l'argument-dictionnaire <em>globs</em> est utilisée pour le contexte d'exécution.</p>
<p>L'option <em>name</em> est utilisée pour les messages d'échec, et prend <code class="docutils literal notranslate"><span class="pre">&quot;NoName&quot;</span></code> comme valeur par défaut.</p>
<p>Si l'option <em>verbose</em> est vraie, les sorties sont générées même s'il n'y a aucun échec. Par défaut, la sortie est générée seulement si un exemple échoue.</p>
<p>L'option <em>compileflags</em> donne l'ensemble des options qui doit être utilisée par le compilateur Python lorsqu'il exécute les exemples. Par défaut, ou si <code class="docutils literal notranslate"><span class="pre">None</span></code>, les options sont inférées à partir de l'ensemble des fonctionnalités futures trouvées dans <em>globs</em>.</p>
<p>L'option <em>optionflags</em> fonctionne similairement à la fonction <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> ci-dessus.</p>
</dd></dl>

</section>
<section id="unittest-api">
<span id="doctest-unittest-api"></span><h2>API de tests unitaires<a class="headerlink" href="#unittest-api" title="Lien permanent vers ce titre">¶</a></h2>
<p>Au fur et à mesure que la collection de modules testés avec <em>doctest</em> s'agrandira, vous allez souhaiter avoir une façon d'exécuter systématiquement tous les <em>doctests</em>. Le module <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> fournit deux fonctions qui peuvent être utilisées afin de créer des suites de tests unitaires <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> à partir des modules et des fichiers textes contenant des <em>doctests</em>. Afin d'intégrer la découverte fournie par <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a>, il suffit d'ajouter une fonction <code class="xref py py-func docutils literal notranslate"><span class="pre">load_tests()</span></code> dans votre module de test :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">doctest</span>
<span class="kn">import</span> <span class="nn">my_module_with_doctests</span>

<span class="k">def</span> <span class="nf">load_tests</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">tests</span><span class="p">,</span> <span class="n">ignore</span><span class="p">):</span>
    <span class="n">tests</span><span class="o">.</span><span class="n">addTests</span><span class="p">(</span><span class="n">doctest</span><span class="o">.</span><span class="n">DocTestSuite</span><span class="p">(</span><span class="n">my_module_with_doctests</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tests</span>
</pre></div>
</div>
<p>Il y a deux fonctions principales pour créer des instances de la classe <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a> à partir de fichiers textes et de modules ayant des <em>doctests</em> :</p>
<dl class="py function">
<dt class="sig sig-object py" id="doctest.DocFileSuite">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DocFileSuite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_relative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">package</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setUp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tearDown</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DocTestParser()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocFileSuite" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Convertit des tests <em>doctest</em> à partir d'un ou plusieurs fichiers vers une classe <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a>.</p>
<p>La classe renvoyée <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a> doit être exécutée dans le cadriciel de tests unitaires et exécute les exemples interactifs trouvés dans chaque fichier. Si un exemple de n'importe quel fichier échoue, alors le test unitaire de synthèse échoue aussi, et une exception <code class="xref py py-exc docutils literal notranslate"><span class="pre">failureException</span></code> est levée, affichant le nom du fichier contenant le test et un numéro de ligne (celui-ci est parfois approximatif).</p>
<p>Passe un ou plusieurs chemins (sous forme de chaînes de caractères) à des fichiers textes afin d'être vérifiés.</p>
<p>Les options peuvent être fournies comme des options lettrées :</p>
<p>L'option <em>module_relative</em> précise comment les noms de fichiers dans <em>paths</em> doivent être interprétés :</p>
<ul class="simple">
<li><p>Si <em>module_relative</em> a <code class="docutils literal notranslate"><span class="pre">True</span></code> comme valeur (valeur par défaut), alors chaque nom de fichier dans <em>paths</em> précise un chemin relatif au module qui soit indépendant du système d'exploitation. Par défaut, ce chemin est relatif au répertoire du module appelant ; mais si l'option <em>package</em> est précisée, alors il est relatif à ce paquet. Afin de garantir l'indépendance face au système d'exploitation, chaque nom de fichier doit utiliser des caractères <code class="docutils literal notranslate"><span class="pre">/</span></code> afin de séparer les segments de chemin, et ne peut pas être un chemin absolu (c'est-à-dire, il ne peut pas commencer par <code class="docutils literal notranslate"><span class="pre">/</span></code>).</p></li>
<li><p>Si <em>module_relative</em> prend la valeur <code class="docutils literal notranslate"><span class="pre">False</span></code>, alors <em>filename</em> précise un chemin en fonction du système d'exploitation. Le chemin peut être absolu ou relatif ; les chemins relatifs sont résolus en rapport au répertoire actif.</p></li>
</ul>
<p>L'option <em>package</em> est un paquet Python ou le nom d'un paquet Python dont le répertoire dont être utilisé comme le répertoire principal pour un nom de fichier dans <em>paths</em> qui soit lié à un module. Si aucun paquet n'est spécifié, le répertoire du module appelé à l'exécution est utilisé comme le répertoire principal pour les noms de fichiers liés au module. C'est une erreur que de spécifier <em>package</em> si <em>module_relative</em> a <code class="docutils literal notranslate"><span class="pre">False</span></code> comme valeur.</p>
<p>L'option <em>setUp</em> précise une fonction de mise-en-place pour la suite de tests. Ceci est appelé avant l'exécution des tests dans chaque fichier. La fonction <em>setUp</em> est passée à un objet <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>. La fonction <em>setUp</em> peut accéder aux valeurs globales du test par le biais de l'attribut <em>globs</em> du test passé.</p>
<p>L'option <em>tearDown</em> précise une fonction de démolition pour la suite de tests. Celle-ci est appelée après avoir exécuté les tests dans chaque fichier. La fonction <em>tearDown</em> est passée à un objet <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>. La fonction <em>setUp</em> peut accéder aux valeurs globales du test par l'attribut <em>globs</em> du test passé.</p>
<p>L'option <em>globs</em> est un dictionnaire contenant les variables globales initiales pour les tests. Une nouvelle copie de ce dictionnaire est créée pour chaque test. Par défaut, <em>globs</em> est un nouveau dictionnaire vide.</p>
<p>Les options <em>optionflags</em> précisent les options par défaut de <em>doctest</em> pour les tests, créées en composant par un OU les différentes options individuelles. Voir la section <a class="reference internal" href="#doctest-options"><span class="std std-ref">Options de ligne de commande</span></a>. Voir la fonction <a class="reference internal" href="#doctest.set_unittest_reportflags" title="doctest.set_unittest_reportflags"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_unittest_reportflags()</span></code></a> ci-dessous pour une meilleure façon de préciser des options de rapport.</p>
<p>L'option <em>parser</em> définit une classe ou une sous-classe <a class="reference internal" href="#doctest.DocTestParser" title="doctest.DocTestParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestParser</span></code></a> qui doit être utilisée pour extraire les tests des fichiers. Par défaut, on utilise un analyseur normal (c'est-à-dire, <code class="docutils literal notranslate"><span class="pre">DocTestParser()</span></code>).</p>
<p>L'option <em>encoding</em> définit un encodage à utiliser pour convertir le fichier en format <em>unicode</em>.</p>
<p>La valeur globale <code class="docutils literal notranslate"><span class="pre">__file__</span></code> est ajoutée aux valeurs globales fournies par les <em>doctests</em>, ceux-ci étant téléchargés d'un fichier texte utilisant la fonction <a class="reference internal" href="#doctest.DocFileSuite" title="doctest.DocFileSuite"><code class="xref py py-func docutils literal notranslate"><span class="pre">DocFileSuite()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="doctest.DocTestSuite">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DocTestSuite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraglobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_finder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setUp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tearDown</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestSuite" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Convertit les tests <em>doctest</em> pour un module donné à une classe <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a>.</p>
<p>La classe renvoyée <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a> doit être exécutée par le cadriciel de test unitaire, afin d'exécuter chaque <em>doctest</em> dans le module. Si n'importe lequel des <em>doctests</em> échoue, alors le test unitaire de synthèse échoue, et une exception <code class="xref py py-exc docutils literal notranslate"><span class="pre">failureException</span></code> est levée, affichant le nom du fichier contenant le test et un numéro de ligne pouvant être approximatif.</p>
<p>L'option <em>module</em> fournit le module qui sera testé. Il peut prendre la forme d'un objet-module ou celle du nom d'un module (possiblement <em>dotted</em>). Si non-précisée, le module appelant cette fonction est utilisé.</p>
<p>L'option <em>globs</em> est un dictionnaire contenant les variables globales initiales pour les tests. Une nouvelle copie de ce dictionnaire est créée pour chaque test. Par défaut, <em>globs</em> est un nouveau dictionnaire vide.</p>
<p>L'option <em>extraglobs</em> précise un ensemble supplémentaire de variables globales, à fusionner avec <em>globs</em>. Par défaut, aucune variable globale supplémentaire est utilisée.</p>
<p>L'option <em>test_finder</em> est l'instance de <a class="reference internal" href="#doctest.DocTestFinder" title="doctest.DocTestFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestFinder</span></code></a> (ou un remplacement <em>drop-in</em>) qui est utilisée pour extraire les <em>doctests</em> à partir du module.</p>
<p>Les options <em>setUp</em>, <em>tearDown</em> et <em>optionflags</em> sont les mêmes que pour la fonction <a class="reference internal" href="#doctest.DocFileSuite" title="doctest.DocFileSuite"><code class="xref py py-func docutils literal notranslate"><span class="pre">DocFileSuite()</span></code></a> ci-dessus.</p>
<p>Cette fonction utilise la même technique de recherche que <a class="reference internal" href="#doctest.testmod" title="doctest.testmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">testmod()</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Modifié dans la version 3.5: </span>La fonction <a class="reference internal" href="#doctest.DocTestSuite" title="doctest.DocTestSuite"><code class="xref py py-func docutils literal notranslate"><span class="pre">DocTestSuite()</span></code></a> renvoie une instance vide de la classe <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a> si <em>module</em> ne contient aucune <em>docstring</em>, et ce, au lieu de lever l'exception <a class="reference internal" href="exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>.</p>
</div>
</dd></dl>

<p>Sous le capot, <a class="reference internal" href="#doctest.DocTestSuite" title="doctest.DocTestSuite"><code class="xref py py-func docutils literal notranslate"><span class="pre">DocTestSuite()</span></code></a> crée une classe <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a> à partir d'instances de <code class="xref py py-class docutils literal notranslate"><span class="pre">doctest.DocTestCase</span></code> ; de plus, <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestCase</span></code> est une sous-classe de <a class="reference internal" href="unittest.html#unittest.TestCase" title="unittest.TestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestCase</span></code></a>. La classe <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestCase</span></code> n'est pas documentée ici (c'est un détail interne), mais l'étude de son code peut répondre à des questions concernant les détails exacts de l'intégration du module <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a>.</p>
<p>De la même façon, <a class="reference internal" href="#doctest.DocFileSuite" title="doctest.DocFileSuite"><code class="xref py py-func docutils literal notranslate"><span class="pre">DocFileSuite()</span></code></a> crée une classe <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a> à partir des instances <code class="xref py py-class docutils literal notranslate"><span class="pre">doctest.DocFileCase</span></code>, où <code class="xref py py-class docutils literal notranslate"><span class="pre">DocFileCase</span></code> est une sous-classe de <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestCase</span></code>.</p>
<p>Ainsi, les deux façons de créer une <a class="reference internal" href="unittest.html#unittest.TestSuite" title="unittest.TestSuite"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code></a> utilisent des instances de la classe <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestCase</span></code>. Ceci est important pour une raison subtile : lorsque vous exécutez par vous-même des fonctions <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a>, vous pouvez contrôler les options <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> qui sont utilisées de façon directe, en passant des options aux fonctions <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a>. Toutefois, si vous écrivez un cadriciel <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a>, alors <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> a le contrôle final de quand et de comment les tests sont exécutés. La personne qui écrit le cadriciel souhaite habituellement contrôler les options de rapport de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> (qui sont peut-être, par exemple, spécifiées en options de ligne de commande), sauf qu'il n'y a pas de moyen de spécifier des options à l'attention des exécuteurs de test de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> à partir de <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a>.</p>
<p>Pour cette raison, <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> implémente le concept d'options de rapport de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> qui soit spécifique à <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a>, par le biais de cette fonction :</p>
<dl class="py function">
<dt class="sig sig-object py" id="doctest.set_unittest_reportflags">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">set_unittest_reportflags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.set_unittest_reportflags" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Voir les options de ligne de commandes de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> pour l'utilisation.</p>
<p>L'argument <em>flags</em> prend la <a class="reference internal" href="../reference/expressions.html#bitwise"><span class="std std-ref">composition OU bit à bit</span></a> des arguments. Voir la section <a class="reference internal" href="#doctest-options"><span class="std std-ref">Options de ligne de commande</span></a>. Ce sont uniquement les &quot;options de rapport&quot; qui peuvent être utilisées.</p>
<p>Ceci est un paramètre au niveau global du module, et affecte tous les futurs <em>doctests</em> exécutés par le module <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> : la méthode <code class="xref py py-meth docutils literal notranslate"><span class="pre">runTest()</span></code> de <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestCase</span></code> prend en compte les options précisées pour le cas de test lorsque l'instance de la classe <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestCase</span></code> a été construite. Si aucune option de rapport n'a été précisée (ce qui est le cas typique et attendu), les options de rapport du module <code class="xref py py-mod docutils literal notranslate"><span class="pre">unitest</span></code> de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> sont <a class="reference internal" href="../reference/expressions.html#bitwise"><span class="std std-ref">&lt;composés avec un OU</span></a> vers les options, et les options obtenues sont passées à l'instance de la classe <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> créée pour exécuter le <em>doctest</em>. Si une seule option de rapport a été précisée lorsque l'instance de <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestCase</span></code> a été construite, les options de rapport du module <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> de <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> sont ignorées.</p>
<p>La valeur prise par les options de rapport de <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> et ce, avant que la fonction n'ait été appelée, est renvoyée par la fonction.</p>
</dd></dl>

</section>
<section id="advanced-api">
<span id="doctest-advanced-api"></span><h2>API avancé<a class="headerlink" href="#advanced-api" title="Lien permanent vers ce titre">¶</a></h2>
<p>The basic API is a simple wrapper that's intended to make doctest easy to use.
It is fairly flexible, and should meet most users' needs; however, if you
require more fine-grained control over testing, or wish to extend doctest's
capabilities, then you should use the advanced API.</p>
<p>The advanced API revolves around two container classes, which are used to store
the interactive examples extracted from doctest cases:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> : Un unique <a class="reference internal" href="../glossary.html#term-statement"><span class="xref std std-term">statement</span></a> Python, pris conjointement avec sa sortie attendue.</p></li>
<li><p><a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> : Une collection de <a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a>, habituellement extraits d'une seule <em>docstring</em> ou fichier texte.</p></li>
</ul>
<p>Additional processing classes are defined to find, parse, and run, and check
doctest examples:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#doctest.DocTestFinder" title="doctest.DocTestFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestFinder</span></code></a>: Finds all docstrings in a given module, and uses a
<a class="reference internal" href="#doctest.DocTestParser" title="doctest.DocTestParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestParser</span></code></a> to create a <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> from every docstring that
contains interactive examples.</p></li>
<li><p><a class="reference internal" href="#doctest.DocTestParser" title="doctest.DocTestParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestParser</span></code></a>: Creates a <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> object from a string (such
as an object's docstring).</p></li>
<li><p><a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a>: Executes the examples in a <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>, and uses
an <a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a> to verify their output.</p></li>
<li><p><a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a>: Compares the actual output from a doctest example with
the expected output, and decides whether they match.</p></li>
</ul>
<p>The relationships among these processing classes are summarized in the following
diagram:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>                            <span class="nb">list</span> <span class="n">of</span><span class="p">:</span>
<span class="o">+------+</span>                   <span class="o">+---------+</span>
<span class="o">|</span><span class="n">module</span><span class="o">|</span> <span class="o">--</span><span class="n">DocTestFinder</span><span class="o">-&gt;</span> <span class="o">|</span> <span class="n">DocTest</span> <span class="o">|</span> <span class="o">--</span><span class="n">DocTestRunner</span><span class="o">-&gt;</span> <span class="n">results</span>
<span class="o">+------+</span>    <span class="o">|</span>        <span class="o">^</span>     <span class="o">+---------+</span>     <span class="o">|</span>       <span class="o">^</span>    <span class="p">(</span><span class="n">printed</span><span class="p">)</span>
            <span class="o">|</span>        <span class="o">|</span>     <span class="o">|</span> <span class="n">Example</span> <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>
            <span class="n">v</span>        <span class="o">|</span>     <span class="o">|</span>   <span class="o">...</span>   <span class="o">|</span>     <span class="n">v</span>       <span class="o">|</span>
           <span class="n">DocTestParser</span>   <span class="o">|</span> <span class="n">Example</span> <span class="o">|</span>   <span class="n">OutputChecker</span>
                           <span class="o">+---------+</span>
</pre></div>
</div>
<section id="doctest-objects">
<span id="doctest-doctest"></span><h3>Objets <em>doctest</em><a class="headerlink" href="#doctest-objects" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="doctest.DocTest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DocTest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">examples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">docstring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTest" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A collection of doctest examples that should be run in a single namespace.  The
constructor arguments are used to initialize the attributes of the same names.</p>
<p><a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> définit les attributs suivants. Ils sont initialisés par le constructeur, et ne doivent pas être modifiés directement.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTest.examples">
<span class="sig-name descname"><span class="pre">examples</span></span><a class="headerlink" href="#doctest.DocTest.examples" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A list of <a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> objects encoding the individual interactive Python
examples that should be run by this test.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTest.globs">
<span class="sig-name descname"><span class="pre">globs</span></span><a class="headerlink" href="#doctest.DocTest.globs" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The namespace (aka globals) that the examples should be run in. This is a
dictionary mapping names to values.  Any changes to the namespace made by the
examples (such as binding new variables) will be reflected in <a class="reference internal" href="#doctest.DocTest.globs" title="doctest.DocTest.globs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">globs</span></code></a>
after the test is run.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTest.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#doctest.DocTest.name" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A string name identifying the <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>.  Typically, this is the name
of the object or file that the test was extracted from.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTest.filename">
<span class="sig-name descname"><span class="pre">filename</span></span><a class="headerlink" href="#doctest.DocTest.filename" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The name of the file that this <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> was extracted from; or
<code class="docutils literal notranslate"><span class="pre">None</span></code> if the filename is unknown, or if the <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> was not
extracted from a file.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTest.lineno">
<span class="sig-name descname"><span class="pre">lineno</span></span><a class="headerlink" href="#doctest.DocTest.lineno" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The line number within <a class="reference internal" href="#doctest.DocTest.filename" title="doctest.DocTest.filename"><code class="xref py py-attr docutils literal notranslate"><span class="pre">filename</span></code></a> where this <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> begins, or
<code class="docutils literal notranslate"><span class="pre">None</span></code> if the line number is unavailable.  This line number is zero-based
with respect to the beginning of the file.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTest.docstring">
<span class="sig-name descname"><span class="pre">docstring</span></span><a class="headerlink" href="#doctest.DocTest.docstring" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The string that the test was extracted from, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the string is
unavailable, or if the test was not extracted from a string.</p>
</dd></dl>

</dd></dl>

</section>
<section id="example-objects">
<span id="doctest-example"></span><h3>Exemples d'objets<a class="headerlink" href="#example-objects" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="doctest.Example">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">Example</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">want</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc_msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.Example" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A single interactive example, consisting of a Python statement and its expected
output.  The constructor arguments are used to initialize the attributes of
the same names.</p>
<p><a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> defines the following attributes.  They are initialized by
the constructor, and should not be modified directly.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.Example.source">
<span class="sig-name descname"><span class="pre">source</span></span><a class="headerlink" href="#doctest.Example.source" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A string containing the example's source code.  This source code consists of a
single Python statement, and always ends with a newline; the constructor adds
a newline when necessary.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.Example.want">
<span class="sig-name descname"><span class="pre">want</span></span><a class="headerlink" href="#doctest.Example.want" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The expected output from running the example's source code (either from
stdout, or a traceback in case of exception).  <a class="reference internal" href="#doctest.Example.want" title="doctest.Example.want"><code class="xref py py-attr docutils literal notranslate"><span class="pre">want</span></code></a> ends with a
newline unless no output is expected, in which case it's an empty string.  The
constructor adds a newline when necessary.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.Example.exc_msg">
<span class="sig-name descname"><span class="pre">exc_msg</span></span><a class="headerlink" href="#doctest.Example.exc_msg" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The exception message generated by the example, if the example is expected to
generate an exception; or <code class="docutils literal notranslate"><span class="pre">None</span></code> if it is not expected to generate an
exception.  This exception message is compared against the return value of
<a class="reference internal" href="traceback.html#traceback.format_exception_only" title="traceback.format_exception_only"><code class="xref py py-func docutils literal notranslate"><span class="pre">traceback.format_exception_only()</span></code></a>.  <a class="reference internal" href="#doctest.Example.exc_msg" title="doctest.Example.exc_msg"><code class="xref py py-attr docutils literal notranslate"><span class="pre">exc_msg</span></code></a> ends with a newline
unless it's <code class="docutils literal notranslate"><span class="pre">None</span></code>.  The constructor adds a newline if needed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.Example.lineno">
<span class="sig-name descname"><span class="pre">lineno</span></span><a class="headerlink" href="#doctest.Example.lineno" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The line number within the string containing this example where the example
begins.  This line number is zero-based with respect to the beginning of the
containing string.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.Example.indent">
<span class="sig-name descname"><span class="pre">indent</span></span><a class="headerlink" href="#doctest.Example.indent" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>The example's indentation in the containing string, i.e., the number of space
characters that precede the example's first prompt.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.Example.options">
<span class="sig-name descname"><span class="pre">options</span></span><a class="headerlink" href="#doctest.Example.options" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A dictionary mapping from option flags to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>, which is used
to override default options for this example.  Any option flags not contained
in this dictionary are left at their default value (as specified by the
<a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a>'s <code class="xref py py-attr docutils literal notranslate"><span class="pre">optionflags</span></code>). By default, no options are set.</p>
</dd></dl>

</dd></dl>

</section>
<section id="doctestfinder-objects">
<span id="doctest-doctestfinder"></span><h3>Objets <em>DocTestFinder</em><a class="headerlink" href="#doctestfinder-objects" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="doctest.DocTestFinder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DocTestFinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DocTestParser()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestFinder" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A processing class used to extract the <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>s that are relevant to
a given object, from its docstring and the docstrings of its contained objects.
<a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>s can be extracted from modules, classes, functions,
methods, staticmethods, classmethods, and properties.</p>
<p>The optional argument <em>verbose</em> can be used to display the objects searched by
the finder.  It defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code> (no output).</p>
<p>The optional argument <em>parser</em> specifies the <a class="reference internal" href="#doctest.DocTestParser" title="doctest.DocTestParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestParser</span></code></a> object (or a
drop-in replacement) that is used to extract doctests from docstrings.</p>
<p>If the optional argument <em>recurse</em> is false, then <a class="reference internal" href="#doctest.DocTestFinder.find" title="doctest.DocTestFinder.find"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestFinder.find()</span></code></a>
will only examine the given object, and not any contained objects.</p>
<p>If the optional argument <em>exclude_empty</em> is false, then
<a class="reference internal" href="#doctest.DocTestFinder.find" title="doctest.DocTestFinder.find"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestFinder.find()</span></code></a> will include tests for objects with empty docstrings.</p>
<p>La classe <a class="reference internal" href="#doctest.DocTestFinder" title="doctest.DocTestFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestFinder</span></code></a> définit la méthode suivante :</p>
<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestFinder.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">obj[,</span> <span class="pre">name][,</span> <span class="pre">module][,</span> <span class="pre">globs][,</span> <span class="pre">extraglobs]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestFinder.find" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Return a list of the <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>s that are defined by <em>obj</em>'s
docstring, or by any of its contained objects' docstrings.</p>
<p>The optional argument <em>name</em> specifies the object's name; this name will be
used to construct names for the returned <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>s.  If <em>name</em> is
not specified, then <code class="docutils literal notranslate"><span class="pre">obj.__name__</span></code> is used.</p>
<p>The optional parameter <em>module</em> is the module that contains the given object.
If the module is not specified or is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the test finder will attempt
to automatically determine the correct module.  The object's module is used:</p>
<ul class="simple">
<li><p>As a default namespace, if <em>globs</em> is not specified.</p></li>
<li><p>To prevent the DocTestFinder from extracting DocTests from objects that are
imported from other modules.  (Contained objects with modules other than
<em>module</em> are ignored.)</p></li>
<li><p>Afin de trouver le nom du fichier contenant l'objet.</p></li>
<li><p>To help find the line number of the object within its file.</p></li>
</ul>
<p>If <em>module</em> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, no attempt to find the module will be made.  This is
obscure, of use mostly in testing doctest itself: if <em>module</em> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or
is <code class="docutils literal notranslate"><span class="pre">None</span></code> but cannot be found automatically, then all objects are considered
to belong to the (non-existent) module, so all contained objects will
(recursively) be searched for doctests.</p>
<p>The globals for each <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> is formed by combining <em>globs</em> and
<em>extraglobs</em> (bindings in <em>extraglobs</em> override bindings in <em>globs</em>).  A new
shallow copy of the globals dictionary is created for each <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>.
If <em>globs</em> is not specified, then it defaults to the module's <em>__dict__</em>, if
specified, or <code class="docutils literal notranslate"><span class="pre">{}</span></code> otherwise.  If <em>extraglobs</em> is not specified, then it
defaults to <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="doctestparser-objects">
<span id="doctest-doctestparser"></span><h3>Objets <em>DocTestParser</em><a class="headerlink" href="#doctestparser-objects" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="doctest.DocTestParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DocTestParser</span></span><a class="headerlink" href="#doctest.DocTestParser" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A processing class used to extract interactive examples from a string, and use
them to create a <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> object.</p>
<p>La classe <a class="reference internal" href="#doctest.DocTestFinder" title="doctest.DocTestFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestFinder</span></code></a> définit les méthodes suivantes :</p>
<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestParser.get_doctest">
<span class="sig-name descname"><span class="pre">get_doctest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestParser.get_doctest" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Extrait tous les exemples de <em>doctests</em> à partir de la chaîne de caractère donnée, et les réunit dans un objet <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>.</p>
<p>Notez que <em>globs</em>, <em>name</em>, <em>filname</em> et <em>lineno</em> sont des attributs pour le nouvel objet <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>. Voir la documentation pour <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> pour plus d'information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestParser.get_examples">
<span class="sig-name descname"><span class="pre">get_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;string&gt;'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestParser.get_examples" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Extract all doctest examples from the given string, and return them as a list
of <a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> objects.  Line numbers are 0-based.  The optional argument
<em>name</em> is a name identifying this string, and is only used for error messages.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestParser.parse">
<span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&lt;string&gt;'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestParser.parse" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Divide the given string into examples and intervening text, and return them as
a list of alternating <a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a>s and strings. Line numbers for the
<a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a>s are 0-based.  The optional argument <em>name</em> is a name
identifying this string, and is only used for error messages.</p>
</dd></dl>

</dd></dl>

</section>
<section id="doctestrunner-objects">
<span id="doctest-doctestrunner"></span><h3>Objets <em>DocTestRunner</em><a class="headerlink" href="#doctestrunner-objects" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="doctest.DocTestRunner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DocTestRunner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestRunner" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A processing class used to execute and verify the interactive examples in a
<a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a>.</p>
<p>The comparison between expected outputs and actual outputs is done by an
<a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a>.  This comparison may be customized with a number of
option flags; see section <a class="reference internal" href="#doctest-options"><span class="std std-ref">Options de ligne de commande</span></a> for more information.  If the
option flags are insufficient, then the comparison may also be customized by
passing a subclass of <a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a> to the constructor.</p>
<p>The test runner's display output can be controlled in two ways. First, an output
function can be passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">TestRunner.run()</span></code>; this function will be called
with strings that should be displayed.  It defaults to <code class="docutils literal notranslate"><span class="pre">sys.stdout.write</span></code>.  If
capturing the output is not sufficient, then the display output can be also
customized by subclassing DocTestRunner, and overriding the methods
<a class="reference internal" href="#doctest.DocTestRunner.report_start" title="doctest.DocTestRunner.report_start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">report_start()</span></code></a>, <a class="reference internal" href="#doctest.DocTestRunner.report_success" title="doctest.DocTestRunner.report_success"><code class="xref py py-meth docutils literal notranslate"><span class="pre">report_success()</span></code></a>,
<a class="reference internal" href="#doctest.DocTestRunner.report_unexpected_exception" title="doctest.DocTestRunner.report_unexpected_exception"><code class="xref py py-meth docutils literal notranslate"><span class="pre">report_unexpected_exception()</span></code></a>, and <a class="reference internal" href="#doctest.DocTestRunner.report_failure" title="doctest.DocTestRunner.report_failure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">report_failure()</span></code></a>.</p>
<p>The optional keyword argument <em>checker</em> specifies the <a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a>
object (or drop-in replacement) that should be used to compare the expected
outputs to the actual outputs of doctest examples.</p>
<p>The optional keyword argument <em>verbose</em> controls the <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a>'s
verbosity.  If <em>verbose</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then information is printed about each
example, as it is run.  If <em>verbose</em> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then only failures are
printed.  If <em>verbose</em> is unspecified, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, then verbose output is used
iff the command-line switch <code class="docutils literal notranslate"><span class="pre">-v</span></code> is used.</p>
<p>The optional keyword argument <em>optionflags</em> can be used to control how the test
runner compares expected output to actual output, and how it displays failures.
For more information, see section <a class="reference internal" href="#doctest-options"><span class="std std-ref">Options de ligne de commande</span></a>.</p>
<p>La classe <a class="reference internal" href="#doctest.DocTestFinder" title="doctest.DocTestFinder"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestFinder</span></code></a> définit les méthodes suivantes :</p>
<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestRunner.report_start">
<span class="sig-name descname"><span class="pre">report_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestRunner.report_start" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Report that the test runner is about to process the given example. This method
is provided to allow subclasses of <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> to customize their
output; it should not be called directly.</p>
<p><em>example</em> is the example about to be processed.  <em>test</em> is the test
<em>containing example</em>.  <em>out</em> is the output function that was passed to
<a class="reference internal" href="#doctest.DocTestRunner.run" title="doctest.DocTestRunner.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestRunner.run()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestRunner.report_success">
<span class="sig-name descname"><span class="pre">report_success</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">got</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestRunner.report_success" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Report that the given example ran successfully.  This method is provided to
allow subclasses of <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> to customize their output; it
should not be called directly.</p>
<p><em>example</em> is the example about to be processed.  <em>got</em> is the actual output
from the example.  <em>test</em> is the test containing <em>example</em>.  <em>out</em> is the
output function that was passed to <a class="reference internal" href="#doctest.DocTestRunner.run" title="doctest.DocTestRunner.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestRunner.run()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestRunner.report_failure">
<span class="sig-name descname"><span class="pre">report_failure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">got</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestRunner.report_failure" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Report that the given example failed.  This method is provided to allow
subclasses of <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> to customize their output; it should not
be called directly.</p>
<p><em>example</em> is the example about to be processed.  <em>got</em> is the actual output
from the example.  <em>test</em> is the test containing <em>example</em>.  <em>out</em> is the
output function that was passed to <a class="reference internal" href="#doctest.DocTestRunner.run" title="doctest.DocTestRunner.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestRunner.run()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestRunner.report_unexpected_exception">
<span class="sig-name descname"><span class="pre">report_unexpected_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestRunner.report_unexpected_exception" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Report that the given example raised an unexpected exception. This method is
provided to allow subclasses of <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> to customize their
output; it should not be called directly.</p>
<p><em>example</em> is the example about to be processed. <em>exc_info</em> is a tuple
containing information about the unexpected exception (as returned by
<a class="reference internal" href="sys.html#sys.exc_info" title="sys.exc_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.exc_info()</span></code></a>). <em>test</em> is the test containing <em>example</em>.  <em>out</em> is the
output function that was passed to <a class="reference internal" href="#doctest.DocTestRunner.run" title="doctest.DocTestRunner.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestRunner.run()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestRunner.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compileflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_globs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestRunner.run" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Run the examples in <em>test</em> (a <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> object), and display the
results using the writer function <em>out</em>.</p>
<p>The examples are run in the namespace <code class="docutils literal notranslate"><span class="pre">test.globs</span></code>.  If <em>clear_globs</em> is
true (the default), then this namespace will be cleared after the test runs,
to help with garbage collection. If you would like to examine the namespace
after the test completes, then use <em>clear_globs=False</em>.</p>
<p><em>compileflags</em> gives the set of flags that should be used by the Python
compiler when running the examples.  If not specified, then it will default to
the set of future-import flags that apply to <em>globs</em>.</p>
<p>The output of each example is checked using the <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a>'s
output checker, and the results are formatted by the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestRunner.report_*()</span></code> methods.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.DocTestRunner.summarize">
<span class="sig-name descname"><span class="pre">summarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestRunner.summarize" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Print a summary of all the test cases that have been run by this DocTestRunner,
and return a <a class="reference internal" href="../glossary.html#term-named-tuple"><span class="xref std std-term">named tuple</span></a> <code class="docutils literal notranslate"><span class="pre">TestResults(failed,</span> <span class="pre">attempted)</span></code>.</p>
<p>The optional <em>verbose</em> argument controls how detailed the summary is.  If the
verbosity is not specified, then the <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a>'s verbosity is
used.</p>
</dd></dl>

</dd></dl>

</section>
<section id="outputchecker-objects">
<span id="doctest-outputchecker"></span><h3>Objets <em>OutputChecker</em><a class="headerlink" href="#outputchecker-objects" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="doctest.OutputChecker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">OutputChecker</span></span><a class="headerlink" href="#doctest.OutputChecker" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A class used to check the whether the actual output from a doctest example
matches the expected output.  <a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a> defines two methods:
<a class="reference internal" href="#doctest.OutputChecker.check_output" title="doctest.OutputChecker.check_output"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_output()</span></code></a>, which compares a given pair of outputs, and returns <code class="docutils literal notranslate"><span class="pre">True</span></code>
if they match; and <a class="reference internal" href="#doctest.OutputChecker.output_difference" title="doctest.OutputChecker.output_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">output_difference()</span></code></a>, which returns a string describing
the differences between two outputs.</p>
<p>La classe <a class="reference internal" href="#doctest.OutputChecker" title="doctest.OutputChecker"><code class="xref py py-class docutils literal notranslate"><span class="pre">OutputChecker</span></code></a> définit les méthodes suivantes :</p>
<dl class="py method">
<dt class="sig sig-object py" id="doctest.OutputChecker.check_output">
<span class="sig-name descname"><span class="pre">check_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">want</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">got</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.OutputChecker.check_output" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> iff the actual output from an example (<em>got</em>) matches the
expected output (<em>want</em>).  These strings are always considered to match if
they are identical; but depending on what option flags the test runner is
using, several non-exact match types are also possible.  See section
<a class="reference internal" href="#doctest-options"><span class="std std-ref">Options de ligne de commande</span></a> for more information about option flags.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="doctest.OutputChecker.output_difference">
<span class="sig-name descname"><span class="pre">output_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">got</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.OutputChecker.output_difference" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Return a string describing the differences between the expected output for a
given example (<em>example</em>) and the actual output (<em>got</em>).  <em>optionflags</em> is the
set of option flags used to compare <em>want</em> and <em>got</em>.</p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="debugging">
<span id="doctest-debugging"></span><h2>Débogage<a class="headerlink" href="#debugging" title="Lien permanent vers ce titre">¶</a></h2>
<p><em>Doctest</em> fournit plusieurs mécanismes pour déboguer des exemples <em>doctest</em> :</p>
<ul>
<li><p>Plusieurs fonctions convertissent les <em>doctests</em> en programmes Python exécutables, qui peuvent être exécutés grâce au débogueur Python, <a class="reference internal" href="pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a>.</p></li>
<li><p>The <a class="reference internal" href="#doctest.DebugRunner" title="doctest.DebugRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DebugRunner</span></code></a> class is a subclass of <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> that
raises an exception for the first failing example, containing information about
that example. This information can be used to perform post-mortem debugging on
the example.</p></li>
<li><p>The <a class="reference internal" href="unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> cases generated by <a class="reference internal" href="#doctest.DocTestSuite" title="doctest.DocTestSuite"><code class="xref py py-func docutils literal notranslate"><span class="pre">DocTestSuite()</span></code></a> support the
<a class="reference internal" href="#doctest.debug" title="doctest.debug"><code class="xref py py-meth docutils literal notranslate"><span class="pre">debug()</span></code></a> method defined by <a class="reference internal" href="unittest.html#unittest.TestCase" title="unittest.TestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.TestCase</span></code></a>.</p></li>
<li><p>You can add a call to <a class="reference internal" href="pdb.html#pdb.set_trace" title="pdb.set_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">pdb.set_trace()</span></code></a> in a doctest example, and you'll
drop into the Python debugger when that line is executed.  Then you can inspect
current values of variables, and so on.  For example, suppose <code class="file docutils literal notranslate"><span class="pre">a.py</span></code>
contains just this module docstring:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">&gt;&gt;&gt; def f(x):</span>
<span class="sd">...     g(x*2)</span>
<span class="sd">&gt;&gt;&gt; def g(x):</span>
<span class="sd">...     print(x+3)</span>
<span class="sd">...     import pdb; pdb.set_trace()</span>
<span class="sd">&gt;&gt;&gt; f(3)</span>
<span class="sd">9</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Alors une séance interactive de Python peut ressembler à ceci :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">a</span><span class="o">,</span> <span class="nn">doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">--Return--</span>
<span class="go">&gt; &lt;doctest a[1]&gt;(3)g()-&gt;None</span>
<span class="go">-&gt; import pdb; pdb.set_trace()</span>
<span class="go">(Pdb) list</span>
<span class="go">  1     def g(x):</span>
<span class="go">  2         print(x+3)</span>
<span class="go">  3  -&gt;     import pdb; pdb.set_trace()</span>
<span class="go">[EOF]</span>
<span class="go">(Pdb) p x</span>
<span class="go">6</span>
<span class="go">(Pdb) step</span>
<span class="go">--Return--</span>
<span class="go">&gt; &lt;doctest a[0]&gt;(2)f()-&gt;None</span>
<span class="go">-&gt; g(x*2)</span>
<span class="go">(Pdb) list</span>
<span class="go">  1     def f(x):</span>
<span class="go">  2  -&gt;     g(x*2)</span>
<span class="go">[EOF]</span>
<span class="go">(Pdb) p x</span>
<span class="go">3</span>
<span class="go">(Pdb) step</span>
<span class="go">--Return--</span>
<span class="go">&gt; &lt;doctest a[2]&gt;(1)?()-&gt;None</span>
<span class="go">-&gt; f(3)</span>
<span class="go">(Pdb) cont</span>
<span class="go">(0, 3)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p>Functions that convert doctests to Python code, and possibly run the synthesized
code under the debugger:</p>
<dl class="py function">
<dt class="sig sig-object py" id="doctest.script_from_examples">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">script_from_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.script_from_examples" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Convertit du texte contenant des exemples en un script.</p>
<p>Argument <em>s</em> is a string containing doctest examples.  The string is converted
to a Python script, where doctest examples in <em>s</em> are converted to regular code,
and everything else is converted to Python comments.  The generated script is
returned as a string. For example,</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">doctest</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doctest</span><span class="o">.</span><span class="n">script_from_examples</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Set x and y to 1 and 2.</span>
<span class="s2">    &gt;&gt;&gt; x, y = 1, 2</span>

<span class="s2">    Print their sum:</span>
<span class="s2">    &gt;&gt;&gt; print(x+y)</span>
<span class="s2">    3</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>displays:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set x and y to 1 and 2.</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="c1">#</span>
<span class="c1"># Print their sum:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># Expected:</span>
<span class="c1">## 3</span>
</pre></div>
</div>
<p>Cette fonction est utilisée à l'interne par d'autres fonctions (voir ci-bas), mais peut aussi être utile lorsque l'on souhaite transformer une séance interactive de Python en script Python.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="doctest.testsource">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">testsource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.testsource" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Convertit en script l'objet <em>doctest</em>.</p>
<p>Argument <em>module</em> is a module object, or dotted name of a module, containing the
object whose doctests are of interest.  Argument <em>name</em> is the name (within the
module) of the object with the doctests of interest.  The result is a string,
containing the object's docstring converted to a Python script, as described for
<a class="reference internal" href="#doctest.script_from_examples" title="doctest.script_from_examples"><code class="xref py py-func docutils literal notranslate"><span class="pre">script_from_examples()</span></code></a> above.  For example, if module <code class="file docutils literal notranslate"><span class="pre">a.py</span></code>
contains a top-level function <code class="xref py py-func docutils literal notranslate"><span class="pre">f()</span></code>, then</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">a</span><span class="o">,</span> <span class="nn">doctest</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doctest</span><span class="o">.</span><span class="n">testsource</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s2">&quot;a.f&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>affiche une version script de la <em>docstring</em> de la fonction <code class="xref py py-func docutils literal notranslate"><span class="pre">f()</span></code>, avec des <em>doctests</em> convertis en code, et le reste dans les commentaires.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="doctest.debug">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.debug" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Débogue les <em>doctests</em> pour un objet.</p>
<p>The <em>module</em> and <em>name</em> arguments are the same as for function
<a class="reference internal" href="#doctest.testsource" title="doctest.testsource"><code class="xref py py-func docutils literal notranslate"><span class="pre">testsource()</span></code></a> above.  The synthesized Python script for the named object's
docstring is written to a temporary file, and then that file is run under the
control of the Python debugger, <a class="reference internal" href="pdb.html#module-pdb" title="pdb: The Python debugger for interactive interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code></a>.</p>
<p>Une copie superficielle de <code class="docutils literal notranslate"><span class="pre">module.__dict__</span></code> est utilisée à la fois pour les contextes d'exécution locaux et globaux.</p>
<p>Optional argument <em>pm</em> controls whether post-mortem debugging is used.  If <em>pm</em>
has a true value, the script file is run directly, and the debugger gets
involved only if the script terminates via raising an unhandled exception.  If
it does, then post-mortem debugging is invoked, via <a class="reference internal" href="pdb.html#pdb.post_mortem" title="pdb.post_mortem"><code class="xref py py-func docutils literal notranslate"><span class="pre">pdb.post_mortem()</span></code></a>,
passing the traceback object from the unhandled exception.  If <em>pm</em> is not
specified, or is false, the script is run under the debugger from the start, via
passing an appropriate <a class="reference internal" href="functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a> call to <a class="reference internal" href="pdb.html#pdb.run" title="pdb.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">pdb.run()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="doctest.debug_src">
<span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">debug_src</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">globs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.debug_src" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Débogue les <em>doctests</em> dans une chaîne de caractères.</p>
<p>Ceci est similaire à la fonction <a class="reference internal" href="#doctest.debug" title="doctest.debug"><code class="xref py py-func docutils literal notranslate"><span class="pre">debug()</span></code></a> décrite ci-haut, mis-à-part qu'une chaîne de caractères contenant des exemples <em>doctest</em> est définie directement, par l'option <em>src</em>.</p>
<p>L'option <em>pm</em> a la même définition que dans la fonction <a class="reference internal" href="#doctest.debug" title="doctest.debug"><code class="xref py py-func docutils literal notranslate"><span class="pre">debug()</span></code></a> ci-haut.</p>
<p>L'option <em>globs</em> définit un dictionnaire à utiliser comme contexte d'exécution global et local. Si elle n'est pas définie, ou si <code class="docutils literal notranslate"><span class="pre">None</span></code>, un dictionnaire vide est utilisé. Si définie, une copie superficielle du dictionnaire est utilisée.</p>
</dd></dl>

<p>The <a class="reference internal" href="#doctest.DebugRunner" title="doctest.DebugRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DebugRunner</span></code></a> class, and the special exceptions it may raise, are of
most interest to testing framework authors, and will only be sketched here.  See
the source code, and especially <a class="reference internal" href="#doctest.DebugRunner" title="doctest.DebugRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DebugRunner</span></code></a>'s docstring (which is a
doctest!) for more details:</p>
<dl class="py class">
<dt class="sig sig-object py" id="doctest.DebugRunner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DebugRunner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optionflags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DebugRunner" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>A subclass of <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> that raises an exception as soon as a
failure is encountered.  If an unexpected exception occurs, an
<a class="reference internal" href="#doctest.UnexpectedException" title="doctest.UnexpectedException"><code class="xref py py-exc docutils literal notranslate"><span class="pre">UnexpectedException</span></code></a> exception is raised, containing the test, the
example, and the original exception.  If the output doesn't match, then a
<a class="reference internal" href="#doctest.DocTestFailure" title="doctest.DocTestFailure"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DocTestFailure</span></code></a> exception is raised, containing the test, the example, and
the actual output.</p>
<p>Pour de l'information sur les paramètres et méthodes du constructeur, voir la documentation pour la classe <code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestrunner</span></code> dans la section <a class="reference internal" href="#doctest-advanced-api"><span class="std std-ref">API avancé</span></a>.</p>
</dd></dl>

<p>Il y a deux exceptions qui peuvent être levées par des instances <a class="reference internal" href="#doctest.DebugRunner" title="doctest.DebugRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DebugRunner</span></code></a> :</p>
<dl class="py exception">
<dt class="sig sig-object py" id="doctest.DocTestFailure">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">DocTestFailure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">got</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.DocTestFailure" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Une exception levée par <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> pour signaler que la sortie obtenue suite à un exemple <em>doctest</em> ne correspond pas à la sortie attendue. Les arguments du constructeur sont utilisés pour initialiser les attributs des mêmes noms.</p>
</dd></dl>

<p><a class="reference internal" href="#doctest.DocTestFailure" title="doctest.DocTestFailure"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DocTestFailure</span></code></a> définit les attributs suivants :</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTestFailure.test">
<span class="sig-prename descclassname"><span class="pre">DocTestFailure.</span></span><span class="sig-name descname"><span class="pre">test</span></span><a class="headerlink" href="#doctest.DocTestFailure.test" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>L'objet issu de la classe <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> qui était en cours d'exécution lorsque l'exemple a échoué.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTestFailure.example">
<span class="sig-prename descclassname"><span class="pre">DocTestFailure.</span></span><span class="sig-name descname"><span class="pre">example</span></span><a class="headerlink" href="#doctest.DocTestFailure.example" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>L'exemple <a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> qui a échoué.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.DocTestFailure.got">
<span class="sig-prename descclassname"><span class="pre">DocTestFailure.</span></span><span class="sig-name descname"><span class="pre">got</span></span><a class="headerlink" href="#doctest.DocTestFailure.got" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>La sortie obtenue par l'exécution de l'exemple.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="doctest.UnexpectedException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">doctest.</span></span><span class="sig-name descname"><span class="pre">UnexpectedException</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc_info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#doctest.UnexpectedException" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Une exception levée par <a class="reference internal" href="#doctest.DocTestRunner" title="doctest.DocTestRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTestRunner</span></code></a> afin de signaler qu'un exemple <em>doctest</em> a levé une exception inattendue. Les arguments du constructeur sont utilisés pour initialiser les attributs des mêmes noms.</p>
</dd></dl>

<p><a class="reference internal" href="#doctest.UnexpectedException" title="doctest.UnexpectedException"><code class="xref py py-exc docutils literal notranslate"><span class="pre">UnexpectedException</span></code></a> définit les attributs suivants :</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.UnexpectedException.test">
<span class="sig-prename descclassname"><span class="pre">UnexpectedException.</span></span><span class="sig-name descname"><span class="pre">test</span></span><a class="headerlink" href="#doctest.UnexpectedException.test" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>L'objet issu de la classe <a class="reference internal" href="#doctest.DocTest" title="doctest.DocTest"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocTest</span></code></a> qui était en cours d'exécution lorsque l'exemple a échoué.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.UnexpectedException.example">
<span class="sig-prename descclassname"><span class="pre">UnexpectedException.</span></span><span class="sig-name descname"><span class="pre">example</span></span><a class="headerlink" href="#doctest.UnexpectedException.example" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>L'exemple <a class="reference internal" href="#doctest.Example" title="doctest.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> qui a échoué.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="doctest.UnexpectedException.exc_info">
<span class="sig-prename descclassname"><span class="pre">UnexpectedException.</span></span><span class="sig-name descname"><span class="pre">exc_info</span></span><a class="headerlink" href="#doctest.UnexpectedException.exc_info" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Un n-uplet contenant l'information au sujet de l'exception inattendue, telle que retourné par <a class="reference internal" href="sys.html#sys.exc_info" title="sys.exc_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.exc_info()</span></code></a>.</p>
</dd></dl>

</section>
<section id="soapbox">
<span id="doctest-soapbox"></span><h2>Éditorial<a class="headerlink" href="#soapbox" title="Lien permanent vers ce titre">¶</a></h2>
<p>Comme mentionné dans l'introduction, <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> a présentement trois usages principaux :</p>
<ol class="arabic simple">
<li><p>Vérifier les exemples dans les <em>docstrings</em>.</p></li>
<li><p>Test de régression.</p></li>
<li><p>De la documentation exécutable / des tests littéraires.</p></li>
</ol>
<p>These uses have different requirements, and it is important to distinguish them.
In particular, filling your docstrings with obscure test cases makes for bad
documentation.</p>
<p>When writing a docstring, choose docstring examples with care. There's an art to
this that needs to be learned---it may not be natural at first.  Examples should
add genuine value to the documentation.  A good example can often be worth many
words. If done with care, the examples will be invaluable for your users, and
will pay back the time it takes to collect them many times over as the years go
by and things change.  I'm still amazed at how often one of my <a class="reference internal" href="#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a>
examples stops working after a &quot;harmless&quot; change.</p>
<p>Doctest also makes an excellent tool for regression testing, especially if you
don't skimp on explanatory text.  By interleaving prose and examples, it becomes
much easier to keep track of what's actually being tested, and why.  When a test
fails, good prose can make it much easier to figure out what the problem is, and
how it should be fixed.  It's true that you could write extensive comments in
code-based testing, but few programmers do. Many have found that using doctest
approaches instead leads to much clearer tests.  Perhaps this is simply because
doctest makes writing prose a little easier than writing code, while writing
comments in code is a little harder.  I think it goes deeper than just that:
the natural attitude when writing a doctest-based test is that you want to
explain the fine points of your software, and illustrate them with examples.
This in turn naturally leads to test files that start with the simplest
features, and logically progress to complications and edge cases.  A coherent
narrative is the result, instead of a collection of isolated functions that test
isolated bits of functionality seemingly at random.  It's a different attitude,
and produces different results, blurring the distinction between testing and
explaining.</p>
<p>Regression testing is best confined to dedicated objects or files.  There are
several options for organizing tests:</p>
<ul class="simple">
<li><p>Write text files containing test cases as interactive examples, and test the
files using <a class="reference internal" href="#doctest.testfile" title="doctest.testfile"><code class="xref py py-func docutils literal notranslate"><span class="pre">testfile()</span></code></a> or <a class="reference internal" href="#doctest.DocFileSuite" title="doctest.DocFileSuite"><code class="xref py py-func docutils literal notranslate"><span class="pre">DocFileSuite()</span></code></a>.  This is recommended,
although is easiest to do for new projects, designed from the start to use
doctest.</p></li>
<li><p>Define functions named <code class="docutils literal notranslate"><span class="pre">_regrtest_topic</span></code> that consist of single docstrings,
containing test cases for the named topics.  These functions can be included in
the same file as the module, or separated out into a separate test file.</p></li>
<li><p>Define a <code class="docutils literal notranslate"><span class="pre">__test__</span></code> dictionary mapping from regression test topics to
docstrings containing test cases.</p></li>
</ul>
<p>Lorsque vous placez vos tests dans un module, le module lui-même peut être l'exécuteur de tests. Lorsqu'un test échoue, vous pouvez signifier à votre exécuteur de tests de rouler une seconde fois uniquement les tests qui échouent et ce, tant que vous travaillez sur le problème. Voici un exemple minimal d'un test exécuteur de tests :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="n">doctest</span><span class="o">.</span><span class="n">REPORT_NDIFF</span><span class="o">|</span><span class="n">doctest</span><span class="o">.</span><span class="n">FAIL_FAST</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">__test__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">doctest</span><span class="o">.</span><span class="n">run_docstring_examples</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                       <span class="n">optionflags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fail</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">optionflags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> failures out of </span><span class="si">{}</span><span class="s2"> tests&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fail</span><span class="p">,</span> <span class="n">total</span><span class="p">))</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Les exemples contenant à la fois la sortie attendue et une exception ne sont pas supportés. Tenter de deviner où finit l'un et où commence l'autre peut mener à plusieurs erreurs, en plus d'être un test qui soit source de confusion.</p>
</dd>
</dl>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code> — Exemples de tests interactifs en Python</a><ul>
<li><a class="reference internal" href="#simple-usage-checking-examples-in-docstrings">Utilisation simple : vérifier des exemples dans des <em>docstrings</em></a></li>
<li><a class="reference internal" href="#simple-usage-checking-examples-in-a-text-file">Utilisation simple : vérifier des exemples dans un fichier texte</a></li>
<li><a class="reference internal" href="#how-it-works">Comment ça marche</a><ul>
<li><a class="reference internal" href="#which-docstrings-are-examined">Quelles <em>docstrings</em> sont considérées ?</a></li>
<li><a class="reference internal" href="#how-are-docstring-examples-recognized">Comment les exemples <em>docstring</em> sont-ils identifiés ?</a></li>
<li><a class="reference internal" href="#what-s-the-execution-context">Quel est le contexte d'exécution ?</a></li>
<li><a class="reference internal" href="#what-about-exceptions">Qu'en est-il des exceptions ?</a></li>
<li><a class="reference internal" href="#option-flags">Options de ligne de commande</a></li>
<li><a class="reference internal" href="#directives">Instructions</a></li>
<li><a class="reference internal" href="#warnings">Avertissements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-api">API de base</a></li>
<li><a class="reference internal" href="#unittest-api">API de tests unitaires</a></li>
<li><a class="reference internal" href="#advanced-api">API avancé</a><ul>
<li><a class="reference internal" href="#doctest-objects">Objets <em>doctest</em></a></li>
<li><a class="reference internal" href="#example-objects">Exemples d'objets</a></li>
<li><a class="reference internal" href="#doctestfinder-objects">Objets <em>DocTestFinder</em></a></li>
<li><a class="reference internal" href="#doctestparser-objects">Objets <em>DocTestParser</em></a></li>
<li><a class="reference internal" href="#doctestrunner-objects">Objets <em>DocTestRunner</em></a></li>
<li><a class="reference internal" href="#outputchecker-objects">Objets <em>OutputChecker</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging">Débogage</a></li>
<li><a class="reference internal" href="#soapbox">Éditorial</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="devmode.html"
                          title="Chapitre précédent">Python Development Mode</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="unittest.html"
                          title="Chapitre suivant"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code> — <em>Framework</em> de tests unitaires</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/doctest.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="unittest.html" title="unittest — Framework de tests unitaires"
             >suivant</a> |</li>
        <li class="right" >
          <a href="devmode.html" title="Python Development Mode"
             >précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La bibliothèque standard</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="development.html" >Outils de développement</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code> — Exemples de tests interactifs en Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2001-2023, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="/license.html">History and License</a> for more information.<br />
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Mis à jour le oct. 26, 2023.
    <a href="/bugs.html">Found a bug</a>?
    <br />

    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>

  </body>
</html>