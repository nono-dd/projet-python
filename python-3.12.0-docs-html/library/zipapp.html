
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="zipapp — Gestion des archives zip exécutables Python" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/library/zipapp.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="Code source : Lib/zipapp.py Ce module fournit des outils pour gérer la création de fichiers zip contenant du code Python, qui peuvent être exécutés directement par l'interpréteur Python. Le module ..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="Code source : Lib/zipapp.py Ce module fournit des outils pour gérer la création de fichiers zip contenant du code Python, qui peuvent être exécutés directement par l'interpréteur Python. Le module ..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>zipapp — Gestion des archives zip exécutables Python &#8212; Documentation Python 3.12.0</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?digest=b37c26da2f7529d09fe70b41c4b2133fe4931a90" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Documentation Python 3.12.0"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="À propos de ces documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Environnement d&#39;exécution Python" href="python.html" />
    <link rel="prev" title="venv — Création d&#39;environnements virtuels" href="venv.html" />
    <link rel="canonical" href="https://docs.python.org/3/library/zipapp.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code> — Gestion des archives zip exécutables Python</a><ul>
<li><a class="reference internal" href="#basic-example">Exemple de base</a></li>
<li><a class="reference internal" href="#command-line-interface">Interface en ligne de commande</a></li>
<li><a class="reference internal" href="#python-api">API Python</a></li>
<li><a class="reference internal" href="#examples">Exemples</a></li>
<li><a class="reference internal" href="#specifying-the-interpreter">Spécification de l'interprète</a></li>
<li><a class="reference internal" href="#creating-standalone-applications-with-zipapp">Création d'applications autonomes avec <em>zipapp</em></a><ul>
<li><a class="reference internal" href="#caveats">Mises en garde</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-python-zip-application-archive-format">Le format d'archive d'application Zip Python</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="venv.html"
                          title="Chapitre précédent"><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code> — Création d'environnements virtuels</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="python.html"
                          title="Chapitre suivant">Environnement d'exécution Python</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/zipapp.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="python.html" title="Environnement d&#39;exécution Python"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="venv.html" title="venv — Création d&#39;environnements virtuels"
             accesskey="P">précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La bibliothèque standard</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="distribution.html" accesskey="U">Paquets et distribution de paquets logiciels</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code> — Gestion des archives zip exécutables Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-zipapp">
<span id="zipapp-manage-executable-python-zip-archives"></span><h1><a class="reference internal" href="#module-zipapp" title="zipapp: Manage executable Python zip archives"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code></a> — Gestion des archives zip exécutables Python<a class="headerlink" href="#module-zipapp" title="Lien permanent vers ce titre">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified added">Nouveau dans la version 3.5.</span></p>
</div>
<p><strong>Code source :</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/zipapp.py">Lib/zipapp.py</a></p>
<hr class="docutils" id="index-0" />
<p>Ce module fournit des outils pour gérer la création de fichiers zip contenant du code Python, qui peuvent être <a class="reference internal" href="../using/cmdline.html#using-on-interface-options"><span class="std std-ref">exécutés directement par l'interpréteur Python</span></a>.  Le module fournit à la fois une interface de ligne de commande <a class="reference internal" href="#zipapp-command-line-interface"><span class="std std-ref">Interface en ligne de commande</span></a> et une interface <a class="reference internal" href="#zipapp-python-api"><span class="std std-ref">API Python</span></a>.</p>
<section id="basic-example">
<h2>Exemple de base<a class="headerlink" href="#basic-example" title="Lien permanent vers ce titre">¶</a></h2>
<p>L'exemple suivant montre comment l'interface de ligne de commande <a class="reference internal" href="#zipapp-command-line-interface"><span class="std std-ref">Interface en ligne de commande</span></a> peut être utilisée pour créer une archive exécutable depuis un répertoire contenant du code Python.  Lors de l'exécution, l'archive exécutera la fonction <code class="docutils literal notranslate"><span class="pre">main</span></code> du module <code class="docutils literal notranslate"><span class="pre">myapp</span></code> dans l'archive.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>zipapp<span class="w"> </span>myapp<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;myapp:main&quot;</span>
<span class="gp">$ </span>python<span class="w"> </span>myapp.pyz
<span class="go">&lt;output from myapp&gt;</span>
</pre></div>
</div>
</section>
<section id="command-line-interface">
<span id="zipapp-command-line-interface"></span><h2>Interface en ligne de commande<a class="headerlink" href="#command-line-interface" title="Lien permanent vers ce titre">¶</a></h2>
<p>Lorsqu'il est appelé en tant que programme à partir de la ligne de commande, la syntaxe suivante est utilisée :</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>zipapp<span class="w"> </span><span class="nb">source</span><span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
</pre></div>
</div>
<p>Si <em>source</em> est un répertoire, une archive est créée à partir du contenu de <em>source</em>.  Si <em>source</em> est un fichier, ce doit être une archive et il est copié dans l'archive cible (ou le contenu de sa ligne <em>shebang</em> est affiché si l'option <code class="docutils literal notranslate"><span class="pre">--info</span></code> est indiquée).</p>
<p>Les options suivantes sont disponibles :</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-zipapp-o">
<span id="cmdoption-zipapp-output"></span><span class="sig-name descname"><span class="pre">-o</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;output&gt;</span></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--output</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;output&gt;</span></span><a class="headerlink" href="#cmdoption-zipapp-o" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Écrit la sortie dans un fichier nommé <em>output</em>.  Si cette option n'est pas spécifiée, le nom du fichier de sortie sera le même que celui de l'entrée <em>source</em>, avec l'extension <code class="docutils literal notranslate"><span class="pre">.pyz</span></code>.  Si un nom de fichier explicite est donné, il est utilisé tel quel (une extension <code class="docutils literal notranslate"><span class="pre">.pyz</span></code> doit donc être incluse si nécessaire).</p>
<p>Un nom de fichier de sortie doit être spécifié si la <em>source</em> est une archive (et, dans ce cas, la <em>sortie</em> ne doit pas être la même que la <em>source</em>).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-zipapp-p">
<span id="cmdoption-zipapp-python"></span><span class="sig-name descname"><span class="pre">-p</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;interpreter&gt;</span></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--python</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;interpreter&gt;</span></span><a class="headerlink" href="#cmdoption-zipapp-p" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Ajoute une ligne <code class="docutils literal notranslate"><span class="pre">#!</span></code> à l'archive en spécifiant <em>interpreter</em> comme commande à exécuter.  Aussi, sur un système POSIX, cela rend l'archive exécutable.  Le comportement par défaut est de ne pas écrire la ligne <code class="docutils literal notranslate"><span class="pre">#!</span></code> et de ne pas rendre le fichier exécutable.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-zipapp-m">
<span id="cmdoption-zipapp-main"></span><span class="sig-name descname"><span class="pre">-m</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;mainfn&gt;</span></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--main</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;mainfn&gt;</span></span><a class="headerlink" href="#cmdoption-zipapp-m" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Écrit un fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> dans l'archive qui exécute <em>mainfn</em>.  L'argument <em>mainfn</em> est de la forme « <em>pkg.mod:fn</em> », où « <em>pkg.mod</em> » est un paquet/module dans l'archive, et « <em>fn</em> » est un appelable dans le module donné. Le fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> réalise cet appel.</p>
<p><a class="reference internal" href="#cmdoption-zipapp-m"><code class="xref std std-option docutils literal notranslate"><span class="pre">--main</span></code></a> ne peut pas être spécifié lors de la copie d'une archive.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-zipapp-c">
<span id="cmdoption-zipapp-compress"></span><span class="sig-name descname"><span class="pre">-c</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--compress</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-zipapp-c" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Compresse les fichiers avec la méthode <em>deflate</em>, réduisant ainsi la taille du fichier de sortie. Par défaut, les fichiers sont stockés non compressés dans l'archive.</p>
<p><a class="reference internal" href="#cmdoption-zipapp-c"><code class="xref std std-option docutils literal notranslate"><span class="pre">--compress</span></code></a> n'a aucun effet lors de la copie d'une archive.</p>
<div class="versionadded">
<p><span class="versionmodified added">Nouveau dans la version 3.7.</span></p>
</div>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-zipapp-info">
<span class="sig-name descname"><span class="pre">--info</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-zipapp-info" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Affiche l'interpréteur intégré dans l'archive, à des fins de diagnostic.  Dans ce cas, toutes les autres options sont ignorées et SOURCE doit être une archive et non un répertoire.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-zipapp-h">
<span id="cmdoption-zipapp-help"></span><span class="sig-name descname"><span class="pre">-h</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--help</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-zipapp-h" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Affiche un court message d'aide et quitte.</p>
</dd></dl>

</section>
<section id="python-api">
<span id="zipapp-python-api"></span><h2>API Python<a class="headerlink" href="#python-api" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce module définit deux fonctions utilitaires :</p>
<dl class="py function">
<dt class="sig sig-object py" id="zipapp.create_archive">
<span class="sig-prename descclassname"><span class="pre">zipapp.</span></span><span class="sig-name descname"><span class="pre">create_archive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpreter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">main</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#zipapp.create_archive" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Crée une archive d'application à partir de <em>source</em>.  La source peut être de natures suivantes :</p>
<ul class="simple">
<li><p>Le nom d'un répertoire, ou un <a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a> se référant à un répertoire ; dans ce cas, une nouvelle archive d'application sera créée à partir du contenu de ce répertoire.</p></li>
<li><p>Le nom d'un fichier d'archive d'application existant, ou un <a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a> se référant à un tel fichier ; dans ce cas, le fichier est copié sur la cible (en le modifiant pour refléter la valeur donnée à l'argument <em>interpreter</em>).  Le nom du fichier doit inclure l'extension <code class="docutils literal notranslate"><span class="pre">.pyz</span></code>, si nécessaire.</p></li>
<li><p>Un objet fichier ouvert pour la lecture en mode binaire.  Le contenu du fichier doit être une archive d'application et Python suppose que l'objet fichier est positionné au début de l'archive.</p></li>
</ul>
<p>L'argument <em>target</em> détermine où l'archive résultante sera écrite :</p>
<ul class="simple">
<li><p>S'il s'agit d'un nom de fichier, ou d'un <a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a>, l'archive sera écrite dans ce fichier.</p></li>
<li><p>S'il s'agit d'un objet fichier ouvert, l'archive sera écrite dans cet objet fichier, qui doit être ouvert pour l'écriture en mode octets.</p></li>
<li><p>Si la cible est omise (ou <code class="docutils literal notranslate"><span class="pre">None</span></code>), la source doit être un répertoire et la cible sera un fichier portant le même nom que la source, avec une extension <code class="docutils literal notranslate"><span class="pre">.pyz</span></code> ajoutée.</p></li>
</ul>
<p>L'argument <em>interpreter</em> spécifie le nom de l'interpréteur Python avec lequel l'archive sera exécutée.  Il est écrit dans une ligne <em>shebang</em> au début de l'archive.  Sur un système POSIX, cela est interprété par le système d'exploitation et, sur Windows, il sera géré par le lanceur Python.  L'omission de l'<em>interpreter</em> n'entraîne pas l'écriture d'une ligne <em>shebang</em>.  Si un interpréteur est spécifié et que la cible est un nom de fichier, le bit exécutable du fichier cible sera mis à 1.</p>
<p>L'argument <em>main</em> spécifie le nom d'un appelable, utilisé comme programme principal pour l'archive.  Il ne peut être spécifié que si la source est un répertoire et si la source ne contient pas déjà un fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code>.  L'argument <em>main</em> doit prendre la forme <code class="docutils literal notranslate"><span class="pre">pkg.module:callable</span></code> et l'archive sera exécutée en important <code class="docutils literal notranslate"><span class="pre">pkg.module</span></code> et en exécutant l'appelable donné sans argument.  Omettre <em>main</em> est une erreur si la source est un répertoire et ne contient pas un fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> car, dans ce cas, l'archive résultante ne serait pas exécutable.</p>
<p>L'argument optionnel <em>filter</em> spécifie une fonction de rappel à laquelle on passe un objet <em>Path</em> représentant le chemin du fichier à ajouter (par rapport au répertoire source).  Elle doit renvoyer <code class="docutils literal notranslate"><span class="pre">True</span></code> si le fichier doit effectivement être ajouté.</p>
<p>L'argument optionnel <em>compressed</em> détermine si les fichiers doivent être compressés.  S'il vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>, les fichiers de l'archive sont compressés avec l'algorithme <em>deflate</em> ; sinon, les fichiers sont stockés non compressés. Cet argument n'a aucun effet lors de la copie d'une archive existante.</p>
<p>Si un objet fichier est spécifié pour <em>source</em> ou <em>target</em>, il est de la responsabilité de l'appelant de le fermer après avoir appelé <code class="docutils literal notranslate"><span class="pre">create_archive</span></code>.</p>
<p>Lors de la copie d'une archive existante, les objets fichier fournis n'ont besoin que des méthodes <code class="docutils literal notranslate"><span class="pre">read</span></code> et <code class="docutils literal notranslate"><span class="pre">readline</span></code> ou <code class="docutils literal notranslate"><span class="pre">write</span></code>.  Lors de la création d'une archive à partir d'un répertoire, si la cible est un objet fichier, elle sera passée à la classe <code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile</span></code> et devra fournir les méthodes nécessaires à cette classe.</p>
<div class="versionadded">
<p><span class="versionmodified added">Nouveau dans la version 3.7: </span>Ajout des arguments <em>filter</em> et <em>compressed</em>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="zipapp.get_interpreter">
<span class="sig-prename descclassname"><span class="pre">zipapp.</span></span><span class="sig-name descname"><span class="pre">get_interpreter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">archive</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#zipapp.get_interpreter" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Renvoie l'interpréteur spécifié dans la ligne <code class="docutils literal notranslate"><span class="pre">#!</span></code> au début de l'archive.  S'il n'y a pas de ligne <code class="docutils literal notranslate"><span class="pre">#!</span></code>, renvoie <a class="reference internal" href="constants.html#None" title="None"><code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code></a>. L'argument <em>archive</em> peut être un nom de fichier ou un objet de type fichier ouvert à la lecture en mode binaire. Python suppose qu'il est au début de l'archive.</p>
</dd></dl>

</section>
<section id="examples">
<span id="zipapp-examples"></span><h2>Exemples<a class="headerlink" href="#examples" title="Lien permanent vers ce titre">¶</a></h2>
<p>Regroupe le contenu d'un répertoire dans une archive, puis l'exécute.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>zipapp<span class="w"> </span>myapp
<span class="gp">$ </span>python<span class="w"> </span>myapp.pyz
<span class="go">&lt;output from myapp&gt;</span>
</pre></div>
</div>
<p>La même chose peut être faite en utilisant la fonction <a class="reference internal" href="#zipapp.create_archive" title="zipapp.create_archive"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_archive()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zipapp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zipapp</span><span class="o">.</span><span class="n">create_archive</span><span class="p">(</span><span class="s1">&#39;myapp&#39;</span><span class="p">,</span> <span class="s1">&#39;myapp.pyz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour rendre l'application directement exécutable sur un système POSIX, spécifiez un interpréteur à utiliser.</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>zipapp<span class="w"> </span>myapp<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;/usr/bin/env python&quot;</span>
<span class="gp">$ </span>./myapp.pyz
<span class="go">&lt;output from myapp&gt;</span>
</pre></div>
</div>
<p>Pour remplacer la ligne <em>shebang</em> sur une archive existante, créez une archive modifiée en utilisant la fonction <a class="reference internal" href="#zipapp.create_archive" title="zipapp.create_archive"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_archive()</span></code></a> :</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zipapp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zipapp</span><span class="o">.</span><span class="n">create_archive</span><span class="p">(</span><span class="s1">&#39;old_archive.pyz&#39;</span><span class="p">,</span> <span class="s1">&#39;new_archive.pyz&#39;</span><span class="p">,</span> <span class="s1">&#39;/usr/bin/python3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To update the file in place, do the replacement in memory using a <a class="reference internal" href="io.html#io.BytesIO" title="io.BytesIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">BytesIO</span></code></a>
object, and then overwrite the source afterwards.  Note that there is a risk
when overwriting a file in place that an error will result in the loss of
the original file.  This code does not protect against such errors, but
production code should do so.  Also, this method will only work if the archive
fits in memory:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">zipapp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">io</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zipapp</span><span class="o">.</span><span class="n">create_archive</span><span class="p">(</span><span class="s1">&#39;myapp.pyz&#39;</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="s1">&#39;/usr/bin/python2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;myapp.pyz&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="specifying-the-interpreter">
<span id="zipapp-specifying-the-interpreter"></span><h2>Spécification de l'interprète<a class="headerlink" href="#specifying-the-interpreter" title="Lien permanent vers ce titre">¶</a></h2>
<p>Notez que si vous spécifiez un interpréteur et que vous distribuez ensuite votre archive d'application, vous devez vous assurer que l'interpréteur utilisé est portable.  Le lanceur Python pour Windows gère la plupart des formes courantes de la ligne POSIX <code class="docutils literal notranslate"><span class="pre">#!</span></code>, mais il y a d'autres problèmes à considérer :</p>
<ul class="simple">
<li><p>Si vous utilisez <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">python</span></code> (ou d'autres formes de la commande <em>python</em>, comme <code class="docutils literal notranslate"><span class="pre">/usr/bin/python</span></code>), vous devez considérer que vos utilisateurs peuvent avoir Python 2 ou Python 3 par défaut, et écrire votre code pour fonctionner dans les deux versions.</p></li>
<li><p>Si vous utilisez une version explicite, par exemple <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">python3</span></code> votre application ne fonctionnera pas pour les utilisateurs qui n'ont pas cette version.  (C'est peut-être ce que vous voulez si vous n'avez pas rendu votre code compatible Python 2).</p></li>
<li><p>Il n'y a aucun moyen de dire « python X.Y ou supérieur » donc faites attention si vous utilisez une version exacte comme <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">python3.4</span></code> car vous devrez changer votre ligne <em>shebang</em> pour les utilisateurs de Python 3.5, par exemple.</p></li>
</ul>
<p>Normalement, vous devriez utiliser un <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">python2</span></code> ou <code class="docutils literal notranslate"><span class="pre">/usr/bin/env</span> <span class="pre">python3</span></code>, selon que votre code soit écrit pour Python 2 ou 3.</p>
</section>
<section id="creating-standalone-applications-with-zipapp">
<h2>Création d'applications autonomes avec <em>zipapp</em><a class="headerlink" href="#creating-standalone-applications-with-zipapp" title="Lien permanent vers ce titre">¶</a></h2>
<p>En utilisant le module <a class="reference internal" href="#module-zipapp" title="zipapp: Manage executable Python zip archives"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code></a>, il est possible de créer  des programmes Python qui peuvent être distribués à des utilisateurs finaux dont le seul pré-requis est d'avoir la bonne version de Python installée sur leur ordinateur. Pour y arriver, la clé est de regrouper toutes les dépendances de l'application dans l'archive avec le code source de l'application.</p>
<p>Les étapes pour créer une archive autonome sont les suivantes :</p>
<ol class="arabic">
<li><p>Créez votre application dans un répertoire comme d'habitude, de manière à avoir un répertoire <code class="docutils literal notranslate"><span class="pre">myapp</span></code> contenant un fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> et tout le code de l'application correspondante.</p></li>
<li><p>Installez toutes les dépendances de votre application dans le répertoire <code class="docutils literal notranslate"><span class="pre">myapp</span></code> en utilisant <em>pip</em> :</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt<span class="w"> </span>--target<span class="w"> </span>myapp
</pre></div>
</div>
<p>(ceci suppose que vous ayez vos dépendances de projet dans un fichier <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> — sinon vous pouvez simplement lister les dépendances manuellement sur la ligne de commande <em>pip</em>).</p>
</li>
<li><p>Regroupez le tout à l'aide de :</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>zipapp<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;interpreter&quot;</span><span class="w"> </span>myapp
</pre></div>
</div>
</li>
</ol>
<p>Cela produira un exécutable autonome qui peut être exécuté sur n'importe quelle machine avec l'interpréteur approprié disponible. Voir <a class="reference internal" href="#zipapp-specifying-the-interpreter"><span class="std std-ref">Spécification de l'interprète</span></a> pour plus de détails. Il peut être envoyé aux utilisateurs sous la forme d'un seul fichier.</p>
<p>Sous Unix, le fichier <code class="docutils literal notranslate"><span class="pre">myapp.pyz</span></code> est exécutable tel quel.  Vous pouvez renommer le fichier pour supprimer l'extension <code class="docutils literal notranslate"><span class="pre">.pyz</span></code> si vous préférez un nom de commande « simple ».  Sous Windows, le fichier <code class="docutils literal notranslate"><span class="pre">myapp.pyz[w]</span></code> est exécutable en vertu du fait que l'interpréteur Python est associé aux extensions de fichier <code class="docutils literal notranslate"><span class="pre">.pyz</span></code> et <code class="docutils literal notranslate"><span class="pre">.pyzw</span></code> une fois installé.</p>
<section id="caveats">
<h3>Mises en garde<a class="headerlink" href="#caveats" title="Lien permanent vers ce titre">¶</a></h3>
<p>Si votre application dépend d'un paquet qui inclut une extension C, ce paquet ne peut pas être exécuté à partir d'un fichier zip (c'est une limitation du système d'exploitation, car le code exécutable doit être présent dans le système de fichiers pour que le lanceur de l'OS puisse le charger). Dans ce cas, vous pouvez exclure cette dépendance du fichier zip et, soit demander à vos utilisateurs de l'installer, soit la fournir avec votre fichier zip et ajouter du code à votre fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> pour inclure le répertoire contenant le module décompressé dans <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>. Dans ce cas, vous devrez vous assurer d'envoyer les binaires appropriés pour votre ou vos architecture(s) cible(s) (et éventuellement choisir la bonne version à ajouter à <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> au moment de l'exécution, basée sur la machine de l'utilisateur).</p>
</section>
</section>
<section id="the-python-zip-application-archive-format">
<h2>Le format d'archive d'application Zip Python<a class="headerlink" href="#the-python-zip-application-archive-format" title="Lien permanent vers ce titre">¶</a></h2>
<p>Python est capable d'exécuter des fichiers zip qui contiennent un fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> depuis la version 2.6.  Pour être exécutée par Python, une archive d'application doit simplement être un fichier zip standard contenant un fichier <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> qui sera exécuté comme point d'entrée de l'application.  Comme d'habitude pour tout script Python, le parent du script (dans ce cas le fichier zip) sera placé sur <a class="reference internal" href="sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> et ainsi d'autres modules pourront être importés depuis le fichier zip.</p>
<p>Le format de fichier zip permet d'ajouter des données arbitraires à un fichier zip.  Le format de l'application zip utilise cette possibilité pour préfixer une ligne <em>shebang</em> POSIX standard dans le fichier (<code class="docutils literal notranslate"><span class="pre">#!/path/to/interpreter</span></code>).</p>
<p>Formellement, le format d'application zip de Python est donc :</p>
<ol class="arabic simple">
<li><p>Une ligne <em>shebang</em> facultative, contenant les caractères <code class="docutils literal notranslate"><span class="pre">b'#!</span></code> suivis d'un nom d’interpréteur, puis un caractère fin de ligne (<code class="docutils literal notranslate"><span class="pre">b'\n'</span></code>).  Le nom de l'interpréteur peut être n'importe quoi acceptable pour le traitement <em>shebang</em> de l'OS, ou le lanceur Python sous Windows.  L'interpréteur doit être encodé en UTF-8 sous Windows, et en <a class="reference internal" href="sys.html#sys.getfilesystemencoding" title="sys.getfilesystemencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.getfilesystemencoding()</span></code></a> sur POSIX.</p></li>
<li><p>Des données <em>zipfile</em> standards, telles que générées par le module <a class="reference internal" href="zipfile.html#module-zipfile" title="zipfile: Read and write ZIP-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a>.  Le contenu du fichier zip <em>doit</em> inclure un fichier appelé <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> (qui doit se trouver à la racine du fichier zip — c'est-à-dire qu'il ne peut se trouver dans un sous-répertoire).  Les données du fichier zip peuvent être compressées ou non.</p></li>
</ol>
<p>Si une archive d'application a une ligne <em>shebang</em>, elle peut avoir le bit exécutable activé sur les systèmes POSIX, pour lui permettre d'être exécutée directement.</p>
<p>Vous pouvez créer des archives d'applications sans utiliser les outils de ce module — le module existe pour faciliter les choses, mais les archives, créées par n'importe quel moyen tout en respectant le format ci-dessus, sont valides pour Python.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table des matières</a></h3>
    <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code> — Gestion des archives zip exécutables Python</a><ul>
<li><a class="reference internal" href="#basic-example">Exemple de base</a></li>
<li><a class="reference internal" href="#command-line-interface">Interface en ligne de commande</a></li>
<li><a class="reference internal" href="#python-api">API Python</a></li>
<li><a class="reference internal" href="#examples">Exemples</a></li>
<li><a class="reference internal" href="#specifying-the-interpreter">Spécification de l'interprète</a></li>
<li><a class="reference internal" href="#creating-standalone-applications-with-zipapp">Création d'applications autonomes avec <em>zipapp</em></a><ul>
<li><a class="reference internal" href="#caveats">Mises en garde</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-python-zip-application-archive-format">Le format d'archive d'application Zip Python</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Sujet précédent</h4>
    <p class="topless"><a href="venv.html"
                          title="Chapitre précédent"><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code> — Création d'environnements virtuels</a></p>
  </div>
  <div>
    <h4>Sujet suivant</h4>
    <p class="topless"><a href="python.html"
                          title="Chapitre suivant">Environnement d'exécution Python</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Signalement de bogue</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/library/zipapp.rst"
            rel="nofollow">Voir la source
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li class="right" >
          <a href="python.html" title="Environnement d&#39;exécution Python"
             >suivant</a> |</li>
        <li class="right" >
          <a href="venv.html" title="venv — Création d&#39;environnements virtuels"
             >précédent</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.12.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >La bibliothèque standard</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="distribution.html" >Paquets et distribution de paquets logiciels</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code> — Gestion des archives zip exécutables Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Recherche rapide" aria-label="Recherche rapide" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2001-2023, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="/license.html">History and License</a> for more information.<br />
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Mis à jour le oct. 26, 2023.
    <a href="/bugs.html">Found a bug</a>?
    <br />

    Créé en utilisant <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>

  </body>
</html>